<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <link rel="alternate icon" type="image/png" href="/img/favicon.png">
    <title>鷺雨のBlog | </title>
    
<link rel="stylesheet" href="/css/reset.css">

    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/markdown.css">

    
<link rel="stylesheet" href="/css/fonts.css">

<meta name="generator" content="Hexo 6.2.0"></head>
    <body>
        <div class="paper">
            <div class="paper-main">
                
                    <div class="header">
    <a class="logo" href="/">鷺雨のBlog</a>
    <ul class="nav">
        
        <li><a href="/">首页</a></li>
        
        <li><a href="/archives">归档</a></li>
        
        <li><a href="/about">关于</a></li>
        
        <li><a href="/links">友链</a></li>
        
    </ul>
</div>
                
                <div class="post-list">
    
    <div class="post">
        <a class="post-title" href="/2023/07/10/%E6%9F%90%E5%B8%82%E7%94%B5%E7%BD%91%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E5%B0%8F%E8%AE%B0/">某市电网漏洞挖掘小记</a>
        <div class="post-except">
            由于电网设施保护非常严格，整个网络拓扑也异常复杂，说实话前两天一直在梳理整个体系架构（后来发现完全没必要）。整整4天，找到两个栈溢出，但都没法利用，只好按DOS交了。据我了解，从外网进入内部网络的可能性几乎没有，实际漏挖也是需要线下网线接入交换机。

 说实话我也不知道这种内网漏洞的意义是什么，感觉像是审潜在代码BUG

接入设备首先就是接入交换机然后ssh上服务器，不过接入的时候是不能开启wifi，不能连接其他网络，不然监管系统会一直报警👮👮👮
ssh上去之后的第一件
            <a class="read-more" href="/2023/07/10/%E6%9F%90%E5%B8%82%E7%94%B5%E7%BD%91%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E5%B0%8F%E8%AE%B0/"> ... </a>
        </div>
        <div class="post-date">2023.07.10</div>
    </div>
    
    <div class="post">
        <a class="post-title" href="/2023/05/16/%E3%80%90kernel%E3%80%91AntCTFxD3%5ECTF%20d3op%20WP/">【WP】AntCTFxD3^CTF d3op</a>
        <div class="post-except">
            
本文采取根据官方wp的方式进行复现，需要官方WP的pdf文件也可以在评论区留言（侵删）

文件系统分析首先解压文件系统
mkdir rootfs
cd rootfs
unsquashfs ../unsquashfs ../squashfs-root.img  

在etc/os-release中我们能看到版本信息
NAME=&quot;OpenWrt&quot;
VERSION=&quot;22.03.3&quot;
ID=&quot;openwrt&quot;
ID_LI
            <a class="read-more" href="/2023/05/16/%E3%80%90kernel%E3%80%91AntCTFxD3%5ECTF%20d3op%20WP/"> ... </a>
        </div>
        <div class="post-date">2023.05.16</div>
    </div>
    
    <div class="post">
        <a class="post-title" href="/2023/04/25/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E6%A0%88CH8%E5%8F%8ACH23/">网络协议栈CH8及CH23</a>
        <div class="post-except">
            
昨晚搞到快两点，今天9.30才起床，希望11点半之前能搞完去吃饭😭

第八章 IP：网际协议IP分组
参照上图，有几个基本概念（本例中的传输层协议为UDP）：

报文：由传输层送至IP的数据报，本身包含传输层首部和数据
数据报：IP在报文的前面加上自己的IP首部，且根据长度考虑是否分片（上图1-2行）
帧：IP将分好片的数据报交给数据链路层，数据链路填上自己的首部后变为帧（上图3行）
分组：一个分片的数据报或者一个不需分片的数据报为分组


 需注意的是IP数据报结构存储
            <a class="read-more" href="/2023/04/25/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E6%A0%88CH8%E5%8F%8ACH23/"> ... </a>
        </div>
        <div class="post-date">2023.04.25</div>
    </div>
    
    <div class="post">
        <a class="post-title" href="/2023/04/25/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E6%A0%88CH4%E5%8F%8ACH6/">网络协议栈CH4及CH6</a>
        <div class="post-except">
            题外话
去年11月份做IO相关源码的时候就已经觉得有些宏定义纯纯恶心，没想到今日的网络协议栈再一次体会了这种感觉😅，感谢网络协议栈让我重温旧日的美好时光。
第四章 接口：以太网以太网接口
IP分组的以太网帧如上图所示，包含6字节的目的和源地址，2字节的类型，末尾4字节的CRC。前14个字节我们在上一篇文章讨论输入输出时已经见过。对于IP分组，其类型是固定的0x0800（十进制2048）
leintr函数
 感觉记住这几个函数干什么就行，也没啥特别说的。一个个源码都挺长的，放
            <a class="read-more" href="/2023/04/25/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E6%A0%88CH4%E5%8F%8ACH6/"> ... </a>
        </div>
        <div class="post-date">2023.04.25</div>
    </div>
    
    <div class="post">
        <a class="post-title" href="/2023/04/24/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E6%A0%88%E5%A4%8D%E4%B9%A0/">网络协议栈CH1-CH3</a>
        <div class="post-except">
            
参考教材《TCP&#x2F;IP详解 卷2：实现》，文内示意图大多取自该教材。本文为复习时自行总结，难免存在不全或者错误，求求大伙轻喷。如有问题可以留言在文末评论区，或者直接私聊，我会及时更改文章内容。

第一章 概述基本框架网络输入输出层间框架基本框架如下图所示，我们会在后面详细讨论输入输出

UDP示例socket程序框架
这段C代码也充当后续我们分析输入输出时的例子

/*
* Send a UDP datagram to the daytime server on 
            <a class="read-more" href="/2023/04/24/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E6%A0%88%E5%A4%8D%E4%B9%A0/"> ... </a>
        </div>
        <div class="post-date">2023.04.24</div>
    </div>
    
    <div class="post">
        <a class="post-title" href="/2023/03/31/%E3%80%90Linux%20kernel%E5%85%A5%E9%97%A8%E3%80%91%E5%86%85%E6%A0%B8%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95/">【kernel】内核本地调试入门</a>
        <div class="post-except">
            提取vmlinux使用extract-vmlinux脚本提取，脚本下载地址：linux&#x2F;extract-vmlinux at master · torvalds&#x2F;linux (github.com)
./extract-vmlinux ./bzImage &gt; vmlinux

开放调试端口在boot.sh中加入如下参数
-gdb tcp::[port]
#如下
-gdb tcp::1234

启动boot.sh
调试
root权限下运行

gdb .
            <a class="read-more" href="/2023/03/31/%E3%80%90Linux%20kernel%E5%85%A5%E9%97%A8%E3%80%91%E5%86%85%E6%A0%B8%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95/"> ... </a>
        </div>
        <div class="post-date">2023.03.31</div>
    </div>
    
    <div class="post">
        <a class="post-title" href="/2023/03/29/%E3%80%90kernel%E3%80%91%E6%8F%90%E6%9D%83%E5%85%A5%E9%97%A8-part2/">【kernel】提权入门-part2</a>
        <div class="post-except">
            如果我们可以改变特权进程的执行轨迹，也可以实现提权。这里我们从以下角度来考虑如何改变特权进程的执行轨迹。

改数据
改代码

改数据符号链接如果一个 root 权限的进程会执行一个符号链接的程序，并且该符号链接或者符号链接指向的程序可以由攻击者控制，攻击者就可以实现提权。
call_usermodehelpercall_usermodehelper 是一种内核线程执行用户态应用的方式，并且启动的进程具有 root 权限。因此，如果我们能够控制具体要执行的应用，那就可以实现提权
            <a class="read-more" href="/2023/03/29/%E3%80%90kernel%E3%80%91%E6%8F%90%E6%9D%83%E5%85%A5%E9%97%A8-part2/"> ... </a>
        </div>
        <div class="post-date">2023.03.29</div>
    </div>
    
    <div class="post">
        <a class="post-title" href="/2023/03/29/%E3%80%90kernel%E3%80%91%E6%8F%90%E6%9D%83%E5%85%A5%E9%97%A8-part1/">【kernel】提权入门-part1</a>
        <div class="post-except">
            
纠结了很久，决定还是开启这个模块的学习，在这个路口迷茫了很久了，一直没有决定好走向何处。虽然有可能会走错路，可能会学习很多看起来没用的东西，但希望Kernel的学习能够带我刚开始接触PWN时的乐趣。将会主要借助CTF wiki和《从0到1》

前置内核会通过进程的 task_struct 结构体中的 cred 指针来索引 cred 结构体，然后根据 cred 的内容来判断一个进程拥有的权限，如果 cred 结构体成员中的 uid-fsgid 都为 0，那一般就会认为进程具有
            <a class="read-more" href="/2023/03/29/%E3%80%90kernel%E3%80%91%E6%8F%90%E6%9D%83%E5%85%A5%E9%97%A8-part1/"> ... </a>
        </div>
        <div class="post-date">2023.03.29</div>
    </div>
    
    <div class="post">
        <a class="post-title" href="/2023/03/29/Linux%20Syscall%20Reference(64%20bit)/">Linux Syscall Reference(64 bit)</a>
        <div class="post-except">
            
列举了全部的64位syscall调用表，方便离线时进行查询




#
Name
Registers
Definition









rax
rdi
rsi
rdx
r10
r8
r9





0
sys_read
0x00
unsigned int fd
char __user *buf
size_t count
-
-
-
fs&#x2F;read_write.c:621


1
sys_write
0x01
unsigned int fd
const cha
            <a class="read-more" href="/2023/03/29/Linux%20Syscall%20Reference(64%20bit)/"> ... </a>
        </div>
        <div class="post-date">2023.03.29</div>
    </div>
    
    <div class="post">
        <a class="post-title" href="/2023/03/20/%E8%B7%B3%E8%BD%AC%E6%8C%87%E4%BB%A4%E6%B1%87%E6%80%BB/">跳转指令汇总</a>
        <div class="post-except">
            无条件跳转JMP ;无条件跳转

根据CX、ECX寄存器的值跳转JCXZ ;CX 为 0 则跳转
JECXZ;ECX 为 0 则跳转

根据标志位跳转的指令JE ;等于则跳转同JZJNE ;不等于则跳转同JNZ
JNE ;不等于则跳转
JA   ;无符号大于则跳转
JNA  ;无符号不大于则跳转
JAE  ;无符号大于等于则跳转		同JNB
JNAE ;无符号不大于等于则跳转	同JB
JB   ;无符号小于则跳转
JNB  ;无符号不小于则跳转
JBE  ;无符号小于等于则跳
            <a class="read-more" href="/2023/03/20/%E8%B7%B3%E8%BD%AC%E6%8C%87%E4%BB%A4%E6%B1%87%E6%80%BB/"> ... </a>
        </div>
        <div class="post-date">2023.03.20</div>
    </div>
    
</div>

<div class="paginator">
    <a class="extend prev" rel="prev" href="/">上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/3/">下一页</a>
</div>

                <div class="footer">
    <span>Copyright © 2022 鷺雨のBlog</span>
    <span>Theme Designed By <a target="_blank" href="https://zheli.design/one-paper">這李設計</a></span>
</div>


<link rel="stylesheet" href="/css/a11y-dark.min.css">


<script src="/js/highlight.min.js"></script>


<script src="/js/highlightjs-line-numbers.js"></script>


<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>

            </div>
        </div>
    <!-- hexo injector body_end start -->
  <script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://python-github-calendar-api.vercel.app/api?Loora1N";
            var git_color =['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f'];
            var git_user ="Loora1N";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/about/'){
                console.log('已挂载github calendar')
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --></body>
</html>